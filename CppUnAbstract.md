Abstract - –∫–æ–Ω—Å–ø–µ–∫—Ç. –≠—Ç–æ—Ç —Ñ–∞–π–ª –∫–æ—Å–ø–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è C++ –≤ unreal engine

alt + t hot key 

> ¬†¬†¬†- [[CppUnAbstract#–†–∞–∑–Ω–æ–µ|–†–∞–∑–Ω–æ–µ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ù–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω—É–∂–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∞–Ω—Ä–∏–ª—É|–ù–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω—É–∂–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∞–Ω—Ä–∏–ª—É]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ü–æ–∏—Å–∫ include –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–∞–ø–æ–∫ |–ü–æ–∏—Å–∫ include –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–∞–ø–æ–∫ ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ü—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –æ–Ω–∏ |–ü—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –æ–Ω–∏ ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Destroy Actor|Destroy Actor]]
> ¬†¬†¬†- [[CppUnAbstract#–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏|–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#f12 –ø—Ä–æ–≤–∞–ª–∏—Ç—Å—è –≤ –∫–ª–∞—Å—Å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥|f12 –ø—Ä–æ–≤–∞–ª–∏—Ç—Å—è –≤ –∫–ª–∞—Å—Å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–í—ã–ª–µ—Ç–µ—Ç—å –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã. Shift + F1|–í—ã–ª–µ—Ç–µ—Ç—å –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã. Shift + F1]]
> ¬†¬†¬†- [[CppUnAbstract#–°–æ–∑–¥–∞–Ω–∏–µ —Å++ –∞–∫—Ç–æ—Ä–∞ –≤ UE|–°–æ–∑–¥–∞–Ω–∏–µ —Å++ –∞–∫—Ç–æ—Ä–∞ –≤ UE]]
> ¬†¬†¬†- [[CppUnAbstract#–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–∞ |–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–∞ ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Super|Super]]
> ¬†¬†¬†- [[CppUnAbstract#–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ú–∞–∫—Ä–æ—Å –≤ UE|–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ú–∞–∫—Ä–æ—Å –≤ UE]]
> ¬†¬†¬†- [[CppUnAbstract#–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏|–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏]]
> ¬†¬†¬†- [[CppUnAbstract#–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è|–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è]]
> ¬†¬†¬†- [[CppUnAbstract#–¢–∏–ø FString. –í—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω —Å–æ–æ–±—â–µ–Ω–∏—è. FColor|–¢–∏–ø FString. –í—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω —Å–æ–æ–±—â–µ–Ω–∏—è. FColor]]
> ¬†¬†¬†- [[CppUnAbstract#–ú–∞–∫—Ä–æ—Å UPROPERTY|–ú–∞–∫—Ä–æ—Å UPROPERTY]]
> ¬†¬†¬†- [[CppUnAbstract#–°–æ–∑–¥–∞–Ω–∏–µ –±–ª—é–ø—Ä–∏–Ω—Ç–∞ –∏–∑ –∫–ª–∞—Å—Å–∞ –°++|–°–æ–∑–¥–∞–Ω–∏–µ –±–ª—é–ø—Ä–∏–Ω—Ç–∞ –∏–∑ –∫–ª–∞—Å—Å–∞ –°++]]
> ¬†¬†¬†- [[CppUnAbstract#–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã|–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Static Mesh Component –∏ Root|Static Mesh Component –∏ Root]]
> ¬†¬†¬†- [[CppUnAbstract#–¢–∏–ø FTransform|–¢–∏–ø FTransform]]
> ¬†¬†¬†- [[CppUnAbstract#–†–∞–±–æ—Ç–∞ —Å Tick|–†–∞–±–æ—Ç–∞ —Å Tick]]
> ¬†¬†¬†- [[CppUnAbstract#ENUM|ENUM]]
> ¬†¬†¬†- [[CppUnAbstract#USTRUCT|USTRUCT]]
> ¬†¬†¬†- [[CppUnAbstract#Material|Material]]
> ¬†¬†¬†- [[CppUnAbstract#Construction Script |Construction Script ]]
> ¬†¬†¬†- [[CppUnAbstract#Editor Event|Editor Event]]
> ¬†¬†¬†- [[CppUnAbstract#Timer|Timer]]
> ¬†¬†¬†- [[CppUnAbstract#Spawn|Spawn]]
> ¬†¬†¬†- [[CppUnAbstract#UFUNCTION, –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –±–ª—é–ø—Ä–∏–Ω—Ç –≥—Ä–∞—Ñ–µ |UFUNCTION, –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –±–ª—é–ø—Ä–∏–Ω—Ç –≥—Ä–∞—Ñ–µ ]]
> ¬†¬†¬†- [[CppUnAbstract#–î–µ–ª–µ–≥–∞—Ç—ã. –†–∞–∑—Ä—É—à–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞. Destroy|–î–µ–ª–µ–≥–∞—Ç—ã. –†–∞–∑—Ä—É—à–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞. Destroy]]
> ¬†¬†¬†- [[CppUnAbstract#GameModeBase|GameModeBase]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Gameplay Framework|Gameplay Framework]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Gamemode|Gamemode]]
> ¬†¬†¬†- [[CppUnAbstract#Mapping, Action Mapping, Axis Mapping|Mapping, Action Mapping, Axis Mapping]]
> ¬†¬†¬†- [[CppUnAbstract#Pawn|Pawn]]
> ¬†¬†¬†- [[CppUnAbstract#Player Controller|Player Controller]]
> ¬†¬†¬†- [[CppUnAbstract#GetAllActorsOfClass|GetAllActorsOfClass]]
> ¬†¬†¬†- [[CppUnAbstract#–û–±–∑–æ—Ä –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ Unreal |–û–±–∑–æ—Ä –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ Unreal ]]
> ¬†¬†¬†- [[CppUnAbstract#Modules, Targets, UnrealBuildTool|Modules, Targets, UnrealBuildTool]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#GameName.Target.cs. UnrealBuildTool|GameName.Target.cs. UnrealBuildTool]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Module|Module]]
> ¬†¬†¬†- [[CppUnAbstract#GameName.h  | GameName.cpp|GameName.h  | GameName.cpp]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#.uproject |.uproject ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Forward Declaration. Libraries. Precomiped headers. IWYU –ø–æ–¥—Ö–æ–¥|Forward Declaration. Libraries. Precomiped headers. IWYU –ø–æ–¥—Ö–æ–¥]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ü–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ |–ü–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#GameNameEditor.Target.cs.|GameNameEditor.Target.cs.]]
> ¬†¬†¬†- [[CppUnAbstract#–ú–∞–∫—Ä–æ—Å—ã. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ |–ú–∞–∫—Ä–æ—Å—ã. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞|–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–®–∞–±–ª–æ–Ω—ã, templates|–®–∞–±–ª–æ–Ω—ã, templates]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–∏–ª–¥ –ø—Ä–æ–µ–∫—Ç–∞ |–ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–∏–ª–¥ –ø—Ä–æ–µ–∫—Ç–∞ ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ú–∞–∫—Ä–æ—Å |–ú–∞–∫—Ä–æ—Å ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ú–∞–∫—Ä–æ—Å. NAMEGAME_API|–ú–∞–∫—Ä–æ—Å. NAMEGAME_API]]
> ¬†¬†¬†- [[CppUnAbstract#Garbage Collector|Garbage Collector]]
> ¬†¬†¬†- [[CppUnAbstract#Clang Format |Clang Format ]]
> ¬†¬†¬†- [[CppUnAbstract#Gitignore|Gitignore]]
> ¬†¬†¬†- [[CppUnAbstract#ACharacter|ACharacter]]
> ¬†¬†¬†- [[CppUnAbstract#Build|Build]]
> ¬†¬†¬†- [[CppUnAbstract#Movement Base|Movement Base]]
> ¬†¬†¬†- [[CppUnAbstract#Camera|Camera]]
> ¬†¬†¬†- [[CppUnAbstract#Jump|Jump]]
> ¬†¬†¬†- [[CppUnAbstract#Nitro. Character Movement Component|Nitro. Character Movement Component]]
> ¬†¬†¬†- [[CppUnAbstract#Health bar component|Health bar component]]
> ¬†¬†¬†- [[CppUnAbstract#Check|Check]]
> ¬†¬†¬†- [[CppUnAbstract#–£–∫–∞–∑–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã |–£–∫–∞–∑–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã ]]
> ¬†¬†¬†- [[CppUnAbstract#TakeDamage|TakeDamage]]
> ¬†¬†¬†- [[CppUnAbstract#Apply Damage, DebugSphere|Apply Damage, DebugSphere]]
> ¬†¬†¬†- [[CppUnAbstract#UDamageType|UDamageType]]
> ¬†¬†¬†- [[CppUnAbstract#Death, AnimMontage, Delegate in c++ only |Death, AnimMontage, Delegate in c++ only ]]
> ¬†¬†¬†- [[CppUnAbstract#Spectator Pawn. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è|Spectator Pawn. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è]]
> ¬†¬†¬†- [[CppUnAbstract#AutoHeal|AutoHeal]]
> ¬†¬†¬†- [[CppUnAbstract#LandedDelegate, –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è|LandedDelegate, –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è]]
> ¬†¬†¬†- [[CppUnAbstract#Class Weapon, Spawn Weapon in Hand |Class Weapon, Spawn Weapon in Hand ]]
> ¬†¬†¬†- [[CppUnAbstract#class AHUD, –ø—Ä–∏—Ü–µ–ª, crosshair|class AHUD, –ø—Ä–∏—Ü–µ–ª, crosshair]]
> ¬†¬†¬†- [[CppUnAbstract#UWeaponComponent. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ä—É–∂–∏—è |UWeaponComponent. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ä—É–∂–∏—è ]]
> ¬†¬†¬†- [[CppUnAbstract#Collision, Console Command |Collision, Console Command ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Console command collision|Console command collision]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Collsion settings|Collsion settings]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Camera collsion|Camera collsion]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –∞–∫—Ç–æ—Ä–æ–≤, –∏—Ö –ø–æ–∫–∞–∑ |–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –∞–∫—Ç–æ—Ä–æ–≤, –∏—Ö –ø–æ–∫–∞–∑ ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–°–æ–±—ã—Ç–∏—è –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–µ –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ |–°–æ–±—ã—Ç–∏—è –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–µ –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–∞ –∫–æ–ª–ª–∏–∑–∏–∏|–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–∞ –∫–æ–ª–ª–∏–∑–∏–∏]]
> ¬†¬†¬†- [[CppUnAbstract#Line trace |Line trace ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#Line trace |Line trace ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#—á—Ç–æ –±—ã —Ç—Ä–µ–π—Å –±–∏–ª —Ç–æ—á–Ω–æ –ø–æ –º–µ—à—É –æ–±—ä–µ–∫—Ç–∞, –∞ –Ω–µ –ø–æ –∫–∞–ø—Å—É–ª–µ|—á—Ç–æ –±—ã —Ç—Ä–µ–π—Å –±–∏–ª —Ç–æ—á–Ω–æ –ø–æ –º–µ—à—É –æ–±—ä–µ–∫—Ç–∞, –∞ –Ω–µ –ø–æ –∫–∞–ø—Å—É–ª–µ]]
> ¬†¬†¬† ¬†¬†¬†- [[CppUnAbstract#–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ |–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ ]]
> ¬†¬†¬†- [[CppUnAbstract#–ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –≤—Ä–∞–≥–æ–≤ |–ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –≤—Ä–∞–≥–æ–≤ ]]
> ¬†¬†¬†- [[CppUnAbstract#Animation offset, –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏–µ, –ø–æ–≤–æ—Ä–æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –ø—Ä–∏—Ü–µ–ª–æ–º|Animation offset, –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏–µ, –ø–æ–≤–æ—Ä–æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –ø—Ä–∏—Ü–µ–ª–æ–º]]
> ¬†¬†¬†- [[CppUnAbstract#F.A.B.R.I.K. –ó–∞–∫—Ä–µ–ø–∏—Ç—å –¥—Ä—É–≥—É—é –∫–æ—Å—Ç—å –≤ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫ –¥—Ä—É–≥–æ–π –∫–æ—Å—Ç–∏|F.A.B.R.I.K. –ó–∞–∫—Ä–µ–ø–∏—Ç—å –¥—Ä—É–≥—É—é –∫–æ—Å—Ç—å –≤ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫ –¥—Ä—É–≥–æ–π –∫–æ—Å—Ç–∏]]
> ¬†¬†¬†- [[CppUnAbstract#–°—Ç—Ä–µ–ª—å–±–∞ –ø–æ —Ç–∞–π–º–µ—Ä—É |–°—Ç—Ä–µ–ª—å–±–∞ –ø–æ —Ç–∞–π–º–µ—Ä—É ]]
> ¬†¬†¬†- [[CppUnAbstract#UProjectileMovementComponent|UProjectileMovementComponent]]
> ¬†¬†¬†- [[CppUnAbstract#Radial Apply Damage, –≥—Ä–∞–Ω–∞—Ç–æ–º–µ—Ç |Radial Apply Damage, –≥—Ä–∞–Ω–∞—Ç–æ–º–µ—Ç ]]
> ¬†¬†¬†- [[CppUnAbstract#–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Å–µ–Ω–∞–ª–∞ –æ—Ä—É–∂–∏—è |–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Å–µ–Ω–∞–ª–∞ –æ—Ä—É–∂–∏—è ]]
> ¬†¬†¬†- [[CppUnAbstract#Anim Notify|Anim Notify]]
> ¬†¬†¬†- [[CppUnAbstract#Equip Animation / Equip flag|Equip Animation / Equip flag]]
> ¬†¬†¬†- [[CppUnAbstract#Slot upper body |Slot upper body ]]
> ¬†¬†¬†- [[CppUnAbstract#Ammo data|Ammo data]]
> ¬†¬†¬†- [[CppUnAbstract#–†–∞–∑–ª–∏—á–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏, FindByPredicate|–†–∞–∑–ª–∏—á–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏, FindByPredicate]]
> ¬†¬†¬†- [[CppUnAbstract#–®–∞–±–ª–æ–Ω –∫–ª–∞—Å—Å–∞ –¥–ª—è anim notify |–®–∞–±–ª–æ–Ω –∫–ª–∞—Å—Å–∞ –¥–ª—è anim notify ]]
> ¬†¬†¬†- [[CppUnAbstract#–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞ |–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞ ]]
> ¬†¬†¬†- [[CppUnAbstract#–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ |–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ ]]
> ¬†¬†¬†- [[CppUnAbstract#Blueprint Widget |Blueprint Widget ]]
> ¬†¬†¬†- [[CppUnAbstract#Widget in C++|Widget in C++]]
> ¬†¬†¬†- [[CppUnAbstract#–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è –≤ HUD|–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è –≤ HUD]]
> ¬†¬†¬†- [[CppUnAbstract#–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥. —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç |–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥. —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ]]
> ¬†¬†¬†- [[CppUnAbstract#Pickups|Pickups]]
> ¬†¬†¬†- [[CppUnAbstract#Respawn PickUp, virtual pickup function, health pick up |Respawn PickUp, virtual pickup function, health pick up ]]


## –†–∞–∑–Ω–æ–µ
---

### –ù–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω—É–∂–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∞–Ω—Ä–∏–ª—É

```
 1. üß± **Desktop development with C++**

> –û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä MSVC, Windows SDK, –∏ –±–∞–∑–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã CMake/Ninja.

‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å!

---

 2. üß∞ **.NET Desktop Development**

> –ù—É–∂–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã Unreal Build Tool (UBT), –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã Visual Studio.

‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å!

 –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- ‚úÖ MSVC v143 - VS 2022 C++ x64/x86 build tools (latest)
    
- ‚úÖ Windows 10 SDK (10.0.19041.0 –∏–ª–∏ –Ω–æ–≤–µ–µ)
    
- ‚úÖ C++ CMake tools for Windows
    
- ‚úÖ C++/CLI support (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ CLI)
    
- ‚úÖ C++ ATL –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π Windows
    
- ‚úÖ C++ MFC –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π Windows
    

 üìÅ –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏ —Å—Ä–µ–¥–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- ‚úÖ .NET Framework 4.8 SDK
    
- ‚úÖ .NET Framework 4.8 Targeting Pack
    
- ‚úÖ .NET 6.0 Runtime (–∏–ª–∏ –≤—ã—à–µ) –ï–≥–æ –Ω–µ—Ç –≤ visual studio, –Ω—É–∂–Ω–æ –ø–æ–¥—Ä—É–±–∞—Ç—å —Ä—É–∫–∞–º–∏ 
    
- ‚úÖ MSBuild
    
- ‚úÖ Git for Windows (–µ—Å–ª–∏ –≤—ã –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ Git –æ—Ç–¥–µ–ª—å–Ω–æ)
    

 üß© –†–∞–∑–Ω–æ–µ

- ‚úÖ Unreal Engine Installer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    
- ‚úÖ Visual Studio core editor
    
- ‚úÖ Just-In-Time Debugger
    
- ‚úÖ NuGet package manager
    
- ‚úÖ Windows Universal CRT SDK

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ **–ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç**:  
–ü–ö–ú –ø–æ `.uproject` ‚Üí **Generate Visual Studio project files**.
```

### –ü–æ–∏—Å–∫ include –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–∞–ø–æ–∫ 

–≤ build.cs –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å 

```cpp
// Shoot Them Up Game, All Right Reserved.

using UnrealBuildTool;

public class STU : ModuleRules
{
	public STU(ReadOnlyTargetRules Target) : base(Target)
	{
		PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;
	
		PublicDependencyModuleNames.AddRange(new string[] { "Core", "CoreUObject", "Engine", "InputCore" });

		PrivateDependencyModuleNames.AddRange(new string[] {  });

		//–ø—Ä–∏ –±–∏–ª–¥–µ –ø–æ–∏—Å–∫ #include –≤ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–∞–ø–∫–∞—Ö
		PublicIncludePaths.AddRange(new string[] { "STU/Character", "STU/Player" });

		// Uncomment if you are using Slate UI
		// PrivateDependencyModuleNames.AddRange(new string[] { "Slate", "SlateCore" });
		
		// Uncomment if you are using online features
		// PrivateDependencyModuleNames.Add("OnlineSubsystem");

		// To include OnlineSubsystemSteam, add it to the plugins section in your uproject file with the Enabled attribute set to true
	}
}

```

```C++
include "CoreMinimal.h" //–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
include "GameFramework/Actor.h" //–Ω–∞—Å–ª–µ–¥—É–µ–º—Å—è –æ—Ç –∞–∫—Ç–æ—Ä–∞, —É–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –≥–¥–µ –æ–±—ä—è–≤–ª–µ–Ω –∞–∫—Ç–æ—Ä 
include "BaseGeometryActor.generated.h" //–∏–¥–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤—Å–µ–≥–¥–∞ 
```

–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è 1 —Ä–∞–∑
`#pragma once `

```
"##" - —Å–∫–ª–µ–π–∫–∞ –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ 
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –æ–Ω–∏ 

![[Pasted image 20241130032849.png]]

![[Pasted image 20241130032826.png]]

![[Pasted image 20241130033001.png]]

### Destroy Actor

```cpp

	Geometry->Destroy();
	//Geometry->SetLifeSpan(2.0f)

```

## –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏

![[Pasted image 20250513201302.png]]

https://www.unrealengine.com/en-US/tech-blog/designer-s-guide-to-unreal-engine-keyboard-shortcuts

### f12 –ø—Ä–æ–≤–∞–ª–∏—Ç—Å—è –≤ –∫–ª–∞—Å—Å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –º—ã –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –µ–≥–æ –µ—â–µ —Ä–∞–∑ 
![[Pasted image 20250510185320.png]]

–∑–∞–π–¥—è –¥–æ–π–¥–µ–º –¥–æ –µ—â–µ –æ–¥–Ω–æ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

![[Pasted image 20250510184706.png]]

![[Pasted image 20250510185354.png]]

### –í—ã–ª–µ—Ç–µ—Ç—å –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã. Shift + F1

![[Pasted image 20250513175029.png]]


## –°–æ–∑–¥–∞–Ω–∏–µ —Å++ –∞–∫—Ç–æ—Ä–∞ –≤ UE

![[Pasted image 20250510153256.png]]

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–∞ 

### Super

—ç—Ç–æ –∞–ª–∏–∞—Å –Ω–∞ –∏–º—è –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞, –∫–ª–∞—Å—Å–∞ —Ä–æ–¥–∏—Ç–µ–ª—è, –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–æ–º c++ —ç—Ç–æ –ø–∏—à–µ—Ç—Å—è. –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞, —á–µ—Ä–µ–∑ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ super 

```
Super::BeginPlay();
AActor::BeginPlay();
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ú–∞–∫—Ä–æ—Å –≤ UE
---

–ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —ç—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –¥–æ–ø —Å—Ç—Ä–æ—á–∫–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –º—ã –º–æ–∂–µ–º —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ 
–£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –º–æ–∂–µ–º –≤—ã–¥–∞–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ—à–∏–±–∫–∞. 

–ï—Å–ª–∏ –≥–¥–µ —Ç–æ –ø—Ä–∏ –ª–æ–≥–∏–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ error –∑–∞—Ç–µ–º –ø—Ä–∏ —Å–±–æ—Ä–∫–µ unit —Ç–µ—Å—Ç–æ–≤ —ç—Ç–æ –Ω–µ –ø—Ä–æ–π–¥–µ—Ç, —Ç–∞–∫ –∫–∞–∫ –æ–¥–∏–Ω –∏–∑ –ª–æ–≥–æ–≤ –≤—ã–≤–µ–ª –æ—à–∏–±–∫—É, —Ç–∞–∫ —á—Ç–æ –Ω–∞–¥–æ –±—ã—Ç—å —Å —ç—Ç–∏–º –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ 

```cpp
// Called when the game starts or when spawned
void ATestingNewActor::BeginPlay()
{
    Super::BeginPlay();

    //LogTemp —ç—Ç–æ –≥–æ—Ç–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è 
    UE_LOG(LogTemp, Display, TEXT("Hello Unreal!"));
    UE_LOG(LogTemp, Warning, TEXT("Hello Unreal!"));
    UE_LOG(LogTemp, Error, TEXT("Hello Unreal!"));

    int WeaponsNum = 4;
    int KillsNum = 7;
    float Health = 35.531;
    bool IsDead = false;
    bool HasWeapon = true;

    UE_LOG(LogTemp, Display, TEXT("WeaponsNum "), WeaponsNum);
    UE_LOG(LogTemp, Display, TEXT("KillsNum "), KillsNum);
    UE_LOG(LogTemp, Display, TEXT("Health "), Health);
    UE_LOG(LogTemp, Display, TEXT("Health "), Health);
    UE_LOG(LogTemp, Display, TEXT("IsDead "), IsDead);
    UE_LOG(LogTemp, Display, TEXT("HasWeapon "), static_cast<int>(HasWeapon));

    UE_LOG(LogTemp, Display, TEXT("------------------------------"));

    //–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–æ—Å—Ç—É–ø–∞, –±–µ–∑ –Ω–∏—Ö —á–∏—Å–ª–∞ –Ω–µ –≤—ã–≤–µ–¥—É—Ç—Å—è
    UE_LOG(LogTemp, Display, TEXT("WeaponsNum %d "), WeaponsNum);                //int
    UE_LOG(LogTemp, Display, TEXT("KillsNum %i"), KillsNum);                     //int
    UE_LOG(LogTemp, Display, TEXT("Health %f"), Health);                         //float
    UE_LOG(LogTemp, Display, TEXT("Health %.2f"), Health);                       //float —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ—Å–ª–µ .
    UE_LOG(LogTemp, Display, TEXT("IsDead %d"), IsDead);                         //bool
    UE_LOG(LogTemp, Display, TEXT("HasWeapon %d"), static_cast<int>(HasWeapon)); //bool –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ int
}
```

LogTemp: Repeating last play command: Selected Viewport
LogTemp: Display: Hello Unreal!
LogTemp: Warning: Hello Unreal!
LogTemp: Error: Hello Unreal!
LogTemp: Display: WeaponsNum 
LogTemp: Display: KillsNum 
LogTemp: Display: Health 
LogTemp: Display: Health 
LogTemp: Display: IsDead 
LogTemp: Display: HasWeapon 
LogTemp: Display: ------------------------------
LogTemp: Display: WeaponsNum 4 
LogTemp: Display: KillsNum 7
LogTemp: Display: Health 35.530998
LogTemp: Display: Health 35.53
LogTemp: Display: IsDead 0
LogTemp: Display: HasWeapon 1

![[Pasted image 20241112194755.png]]

–í—ã–≤–æ–¥ –ª–æ–≥–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ü–≤–µ—Ç–∞—Ö –∏ —Ç–∏–ø–∞—Ö
–ú–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –∏–ª–∏ –Ω–∞–∂–∞—Ç—å –Ω–∞ –º–∞–∫—Ä–æ—Å –∏ –µ–≥–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å 

–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫—Ç–∞—Ç–æ—Ä 
%d , %i - —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
%f - float

![[Pasted image 20250510161726.png]]

–ü–æ —ç—Ç–æ–º—É –ø—É—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª —Å –ª–æ–≥–æ–º 
Game\Saved\Logs

–õ–æ–≥ –≤–µ—Å—å –≥—Ä—É–∑–∏—Ç—Å—è –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞ –∏ –±–æ–ª–µ–µ —Å—Ç–∞—Ä—ã–π –ª–æ–≥ –ª–µ–∂–∏—Ç –≤ –Ω–∞—á–∞–ª–µ –∏ —Å–∞–º—ã–π –Ω–æ–≤—ã–π –±—É–¥–µ—Ç –≤ –∫–æ–Ω—Ü–µ 

–í—ã–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è –∞–∫—Ç–æ—Ä–∞ –≤ –ª–æ–≥

```
    //GetName - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —É Actor, –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã —è–≤–ª—è–µ–º—Å—è –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞–º–∏, –±–µ—Ä–µ–º –µ–µ –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é
    UE_LOG(LogForTestingNewActor, Warning, TEXT("Actor name %s"), *GetName());
```

## –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
---

–û–±—ä—è–≤–ª—è–µ—Ç—Å—è –≤ .h –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–º —Ñ–∞–π–ª–µ –∞–∫—Ç–æ—Ä–∞. –î–≤–µ —Ä–∞–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ 

```cpp
UCLASS()

private:
	void printTypes();
	void printStringTypes();
```

–§—É–Ω–∫—Ü–∏—è

```cpp
void ABaseGeometryActor::printTypes()
{
	int WeaponsNum = 4;
	int KillsNum = 7;
	float Health = 34.1535633;
	bool IsDead = false;
	bool HasWeapon = true;

	//–í—ã–≤–æ–¥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –ª–æ–≥
	UE_LOG(LogTemp, Display, TEXT("Weapon num: %d, kills num: %i"), WeaponsNum, KillsNum);
	UE_LOG(LogTemp, Display, TEXT("Health: %f"), Health);
	UE_LOG(LogTemp, Display, TEXT("Health: %.2f"), Health); //–≤—ã–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —á–∏—Å–µ–ª –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
	UE_LOG(LogTemp, Display, TEXT("IsDead: %d"), IsDead);
	UE_LOG(LogTemp, Display, TEXT("HasWeapon: %d"), static_cast<int>(HasWeapon)); //`static_cast<int>(HasWeapon)` **–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç `bool` –≤ `int` 
	//–≠—Ç–æ –Ω—É–∂–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ `%d` –≤ `UE_LOG` –æ–∂–∏–¥–∞–µ—Ç `int`, –∞ –Ω–µ `bool`.

}
```

–ü–∫–º, quick action and refactiring, create declataion and definition

–í—ã–≤–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ 

```cpp
void ABaseGeometryActor::BeginPlay()
{
	Super::BeginPlay();
	
	printStringTypes();
	//printTypes();
	DoActorSpawn1();
	Bbdbda();
}
```


![[Pasted image 20241112194955.png]]

## –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
---

![[Pasted image 20241112194555.png]]
—Ñ–∞–π–ª
ElogVerbosity - —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ç–æ—Ä—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç 

`DEFINE_LOG_CATEGORY_STATIC(LogBaseGeometry, All, All)` 

namespace ELogVerbosity

–í —Ñ–∞–π–ª–µ –ª–µ–∂–∞—Ç –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∏—Å–≤–æ–µ–Ω —Å—á–µ—Ç –æ—Ç 0 –¥–æ 7+ . –ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ all = 7 . –í—ã–≤–µ–¥—É—Ç—Å—è –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –¥–æ 7. –¢–∞–∫–∏–µ 

```cpp
//–ï—Å–ª–∏ —É–∫–∞–∑—ã–≤–∞–µ—à—å –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –≤—Å–µ, –º–æ–∂–µ—Ç –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è 
//DEFINE_LOG_CATEGORY_STATIC(LogForTestingNewActor, Error, Error);

DEFINE_LOG_CATEGORY_STATIC(LogForTestingNewActor, All, All);

// Called when the game starts or when spawned
void ATestingNewActor::BeginPlay()
{
    Super::BeginPlay();

    UE_LOG(LogForTestingNewActor, Display, TEXT("info"));
}
```

## –¢–∏–ø FString. –í—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω —Å–æ–æ–±—â–µ–Ω–∏—è. FColor
---

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Ñ–æ—Ä–º–∞—Ç–∞ 
printf, Print formatted data to stdout

https://cplusplus.com/reference/cstdio/printf/

–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ FString
https://dev.epicgames.com/documentation/en-us/unreal-engine/fstring-in-unreal-engine?application_version=5.4

```CPP
#include "Engine/Engine.h"

void ATestingNewActor::printStringTypes()
{
    FString Name = "JohnConnor";
    UE_LOG(LogForTestingNewActor, Warning, TEXT("Name: %s"), *Name);
    UE_LOG(LogTemp, Warning, TEXT("Hello Unreal!"));

    int WeaponsNum = 4;
    float Health = 34.1535633;
    bool IsDead = false;

    //–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫ —Ç–∏–ø—É FString –±—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    FString WeaponsNumStr = "Weapons num = " + FString::FromInt(WeaponsNum);
    FString HealthStr = "Health = " + FString::SanitizeFloat(Health);
    FString IsDeadStr = "Is dead = " + FString(IsDead ? "true" : "false");

    //%s - –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –≤—ã–≤–æ–¥–∞ —á–∏—Å–µ–ª
    //–≤—ã–≤–æ–¥ –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤ FString —á–∏—Å–ª–∞
    FString Stat = FString::Printf(TEXT(" \n == All Stat == \n %s \n %s \n %s"), *WeaponsNumStr, *HealthStr, *IsDeadStr);
    UE_LOG(LogForTestingNewActor, Warning, TEXT("%s"), *Stat);

    //–≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω
    //-1 —É —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ—Ç –∫–ª—é—á–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤—ã–≤–µ–¥–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω,
    //–∫–ª—é—á –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∫–ª—é—á–∞–º–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω
    //3.0f –≤—Ä–µ–º—è
    //—Ü–≤–µ—Ç –∏ –∏–º—è, —Å–ª–µ–¥—É—é—â–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –¢–∞–∫ –∂–µ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∏–º–µ–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—Å—Ç—å –ø–æ–º–µ–Ω—è—Ç—å —Ä–∞–∑–º–µ—Ä
    GEngine->AddOnScreenDebugMessage(-1, 3.0f, FColor::Red, Name);
    GEngine->AddOnScreenDebugMessage(-1, 5.0f, FColor::Green, Stat, true, FVector2D(1.5f, 1.5f));
}
```

//FromInt - –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥–µ –∏–Ω—Ç, –∞ –≤—ã—Ö–æ–¥–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç string
//SanitizeFloat - –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ —á–∏—Å–ª–∞ double, float –±—É–¥–µ—Ç –∞–≤—Ç–æ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –≤ double, –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏—Ç —Ç–æ–∂–µ string
//? - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ if else, –µ—Å–ª–∏ if = "true", —Ç—Ä–∏–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä

–í—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –≤—å—é–ø–æ—Ä—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π. –ù—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –±–∏–±–ª–æ—Ç–µ–∫—É, –∑–∞—Ç–µ–º –≤ —Ñ—É–Ω–∫—Ü–∏–∏ —É–∫–∞–∑–∞—Ç—å. 

```cpp
#include "Engine/Engine.h"
```

GEngine->AddOnScreenDebugMessage

![[Pasted image 20241112225525.png]]

Viewport:

![[Pasted image 20241112225518.png]]

Log:

LogForTestingNewActor: Warning: Name: JohnConnor
LogTemp: Warning: Hello Unreal!
LogForTestingNewActor: Warning:  
 == All Stat == 
 Weapons num = 4 
 Health = 34.153564 
 Is dead = false


## –ú–∞–∫—Ä–æ—Å UPROPERTY
---
https://dev.epicgames.com/documentation/en-us/unreal-engine/unreal-engine-uproperties?application_version=5.4

–í—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ .h –∑–∞–≥–æ–ª–æ–≤–æ–∫. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ –≤—å—é–ø–æ—Ä—Ç–µ 

–ù—É–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –¥–ª—è –≤—Å–µ—Ö UObject –≤ h —Ñ–∞–π–ª–µ, —Ä–µ–≥—É–ª–∏—Ä—É—é—Ç —Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞

```cpp

UCLASS()
class GAMEC_API ATestingNewActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ATestingNewActor();

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

    //—á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º –≤–∏–¥–µ—Ç—å —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —ç–¥–∏—Ç–æ—Ä–µ –∫–ª–∞—Å—Å–∞
    //–º—ã –º–æ–≥–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å –∏—Ö –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–∞–∫ –≥–ª–∞–∑–∏–∫ –¥–ª—è –ø–µ—Ä–º–µ–Ω–Ω–æ–π –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º
    //—Ç–∞–∫ –∂–µ —Ç–∏–ø int32 –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–æ–º–ø–ª–∏—è—Ü–∏–∏ –ø–æ–¥ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º

    //–º–æ–∂–µ–º —É–∫–∞–∑–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é

    //—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–æ—Å—Ç—É–ø–∞
    //–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –≤–µ–∑–¥–µ –∫–∞–∫ –≤–Ω—É—Ç—Ä–∏ —Ç–∞–∫ –∏ —Å–Ω–∞—Ä—É–∂–∏
    UPROPERTY(EditAnywhere, Category = "Weapon")
    int32 WeaponsNum = 4;

    //–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏
    UPROPERTY(EditDefaultsOnly, Category = "Stat")
    int32 KillsNum = 7;

    //–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–Ω–∞—Ä—É–∂–∏
    UPROPERTY(EditInstanceOnly, Category = "Health")
    float Health = 35.531;

    //–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –≤–µ–∑–¥–µ –∫–∞–∫ –≤–Ω—É—Ç—Ä–∏ —Ç–∞–∫ –∏ —Å–Ω–∞—Ä—É–∂–∏
    UPROPERTY(EditAnywhere, Category = "Health")
    bool IsDead = false;

    //–≤–∏–¥–µ–Ω –≤–µ–∑–¥–µ, –Ω–æ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    UPROPERTY(VisibleAnywhere, Category = "Health")
    bool HasWeapon = true;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;

private:
    void printTypes();
    void printStringTypes();
};

```


–ï—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

EditAnywhere - –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–¥–µ —É–≥–æ–¥–Ω–æ
EditDefaultsOnly - –≤–∏–¥–µ–Ω –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –±–ª—é–ø—Ä–∏–Ω—Ç–∞
EditInstanceOnly - –≤–∏–¥–µ–Ω –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –±–ª—é–ø—Ä–∏–Ω—Ç –≤ —Å—Ü–µ–Ω–µ 
VisibleAnywhere - –≤–∏–¥–µ–Ω –≤—Å–µ–≥–¥–∞, –Ω–µ –≤–æ–∑–º–æ–∂–µ–Ω –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é 

Category = "Weapon" - –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –≥—Ä—É–ø–ø—ã 

![[Pasted image 20241113075556.png]]

![[Pasted image 20241113080632.png]]

–° –≥—Ä—É–ø–ø–∞–º–∏ 

![[Pasted image 20241113082031.png]]

–í—ã–≤–æ–¥ –¥–≤—É—Ö —Ä–∞–∑–Ω—ã—Ö –∞–∫—Ç–æ—Ä–æ–≤ —Å –¥–≤—É–º—è —Ä–∞–∑–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –≤–≤–µ–¥–µ–Ω—ã–º–∏ –≤ –±–ª—é–ø—Ä–∏–Ω—Ç –≤ —Å—Ü–µ–Ω–µ. –ó–∞—Ç–µ–º –ø–ª–µ–π –∏ –≤—ã–≤–æ–¥. 

–í —Ñ—É–Ω–∫—Ü–∏—é —Ç–∞–∫ –∂–µ –≤–≤–µ–¥–µ–Ω –≤—ã–≤–æ–¥ –ª–æ–≥–∞, –∫–∞–∫–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞–∫—Ç–æ—Ä –≤—ã–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è

```cpp
void ABaseGeometryActor::printTypes()
{
	UE_LOG(LogBaseGeometry, Warning, TEXT("Actor name %s"), *GetName());
```

![[Pasted image 20241113082005.png]]
## –°–æ–∑–¥–∞–Ω–∏–µ –±–ª—é–ø—Ä–∏–Ω—Ç–∞ –∏–∑ –∫–ª–∞—Å—Å–∞ –°++
---

![[Pasted image 20241113075929.png]]


## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
---
https://dev.epicgames.com/documentation/en-us/unreal-engine/components-in-unreal-engine?application_version=5.4

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã - —ç—Ç–æ –æ–±—ä–µ–∫—Ç—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é, –º–æ–∂–µ–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫ –∞–∫—Ç–æ—Ä—É –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π 

–° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –û–û–ü –¥–∞–Ω–Ω—ã–π –ø—Ä–∏–µ–º –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–ø–æ–∑–∏—Ü–∏–µ–π 

–í –æ–æ–ø –µ—Å—Ç—å 
–∫–æ–º–ø–æ–∑–∏—Ü–∏—è, –¥–µ–ª–µ–Ω–∏—è –Ω–∞ —á–∞—Å—Ç–∏ –∑–∞–∫—Ä—ã—Ç—ã–µ –∏ –æ—Ç–∫—Ä—ã—Ç–µ 
–ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è –ø–æ —Ä–∞–∑–Ω–æ–º—É 
–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–∞—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∞—Å—Å—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–æ–¥–∏—Ç–µ–ª–µ–π 

### Static Mesh Component –∏ Root

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª

–ó–∞—Ç–µ–º –¥–æ–±–∞–≤–∏—Ç—å —á—Ç–æ –æ–Ω –±—ã–ª –≤–∏–¥–µ–Ω –≤–æ –≤—å—é–ø–æ—Ä—Ç–µ. –û–Ω –±—É–¥–µ—Ç –æ—Ç—Å—ã–ª–∞—Ç—å—Å—è –∫ –∫–æ–¥—É –≤ cpp —Ñ–∞–π–ª–µ

```cpp
#include "Components/StaticMeshComponent.h"

public:	
	// Sets default values for this actor's properties
	ABaseGeometryActor();

    //–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫ –∫–æ–º–ø–æ–Ω–µ—Ç–∞ —Å—Ç–∞—Ç–∏–∫ –º–µ—à–∞ –∫ –∞–∫—Ç–æ—Ä—É
    //–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ BaseMesh
    UPROPERTY(EditAnywhere)
    UStaticMeshComponent* BaseMesh;
```


–¢–∞–∫ –∂–µ –≤ cpp —Ñ–∞–π–ª–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –º–µ—à. –¢–∞–∫ –∂–µ –∑–¥–µ—Å—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≥–∏–∑–º–æ. –†—É—Ç –∞–∫—Ç–æ—Ä–∞ 

```cpp
// Sets default values
ATestingNewActor::ATestingNewActor()
{
    // Set this actor to call Tick() every frame.  You can turn this off to improve performance if you don't need it.
    PrimaryActorTick.bCanEverTick = true;

    //–ü—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π BaseMesh —Ç–∏–ø–∞ UStaticMeshComponent –∏–∑ —à–∞–±–ª–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–º—è (–ª–µ–≥–∫–æ–µ)
    BaseMesh = CreateDefaultSubobject<UStaticMeshComponent>("BaseMesh");

    //–°–æ–∑–¥–∞–µ—Ç root –¥–ª—è –∞–∫—Ç–æ—Ä–∞
    //–≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ —Å–µ–±—è –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –æ–±—ä–µ–∫—Ç –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑—å–º–µ—Ç –∑–∞ —Ü–µ–Ω—Ç—Ä 
    SetRootComponent(BaseMesh);
       
}
```

![[Pasted image 20241114064326.png]]

![[Pasted image 20241114064639.png]]

## –¢–∏–ø FTransform
---

```cpp
// Called when the game starts or when spawned
void ATestingNewActor::BeginPlay()
{
    Super::BeginPlay();

    //—Å–æ–∑–¥–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∏–ø–∞ FTransform –∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º —Ç—É–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ GetActorTransform()
    FTransform Transform = GetActorTransform();

    //–ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö XYZ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    FVector Location = Transform.GetLocation();
    FRotator Rotator = Transform.Rotator();
    FVector Scale = Transform.GetScale3D();

    //–Ω–∞–∑–≤–∞–Ω–∏–µ –∞–∫—Ç–æ—Ä–∞ 
    UE_LOG(LogForTestingNewActor, Warning, TEXT("Actor name is %s"), *GetName());

    //Transform
    UE_LOG(LogForTestingNewActor, Warning, TEXT("Transform %s"), *Transform.ToString());

    //XYZ
    UE_LOG(LogForTestingNewActor, Warning, TEXT("Location %s"), *Location.ToString());
    UE_LOG(LogForTestingNewActor, Warning, TEXT("Rotator %s"), *Rotator.ToString());
    UE_LOG(LogForTestingNewActor, Warning, TEXT("Scale %s"), *Scale.ToString());

    //–ë–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π –∏ –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø–æ–∫–∞–∑ Transform 
    UE_LOG(LogForTestingNewActor, Error, TEXT("Human transform %s"), *Transform.ToHumanReadableString());
}
```

![[Pasted image 20241114070425.png]]

LogForTestingNewActor: Warning: Actor name is TestingNewActor_1
LogForTestingNewActor: Warning: Transform 119.741516,-222.324280,77.975342|0.000000,0.000000,0.000000|1.000000,1.000000,1.000000
LogForTestingNewActor: Warning: Location X=119.742 Y=-222.324 Z=77.975
LogForTestingNewActor: Warning: Rotator P=0.000000 Y=0.000000 R=0.000000
LogForTestingNewActor: Warning: Scale X=1.000 Y=1.000 Z=1.000
LogForTestingNewActor: Error: Human transform Rotation: Pitch 0.000000 Yaw 0.000000 Roll 0.000000
Translation: 119.741516 -222.324280 77.975342
Scale3D: 1.000000 1.000000 1.000000

LogForTestingNewActor: Warning: Actor name is TestingNewActor_2
LogForTestingNewActor: Warning: Transform 91.476807,102.816849,171.065277|0.000000,0.000000,0.000000|1.000000,1.000000,1.000000
LogForTestingNewActor: Warning: Location X=91.477 Y=102.817 Z=171.065
LogForTestingNewActor: Warning: Rotator P=0.000000 Y=0.000000 R=0.000000
LogForTestingNewActor: Warning: Scale X=1.000 Y=1.000 Z=1.000
LogForTestingNewActor: Error: Human transform Rotation: Pitch 0.000000 Yaw 0.000000 Roll 0.000000
Translation: 91.476807 102.816849 171.065277
Scale3D: 1.000000 1.000000 1.000000

## –†–∞–±–æ—Ç–∞ —Å Tick
---
–û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –≤—Å–µ–≥–æ —Ç–∏–∫–∞ 

```cpp
// Sets default values
//–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
AGeometryHubActor::AGeometryHubActor()
{
 	// Set this actor to call Tick() every frame.  You can turn this off to improve performance if you don't need it.
	PrimaryActorTick.bCanEverTick = true;

}
```

–≠—Ç–∞ –ª–æ–≥–∏–∫–∞ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ —Å–∏–Ω—É—Å—É.

New git ignore file
rules of naming variables 
Work on libraries STL

Timer, Event Editor, Constructor Script, Matrerial, USTRUCT, ENUM, Tick, FTransform



.h

```cpp 
// Fill out your copyright notice in the Description page of Project Settings.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "Components/StaticMeshComponent.h"
#include "TestingNewActor.generated.h"

UCLASS()
class GAMEC_API ATestingNewActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ATestingNewActor();

    //–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫ –∫–æ–º–ø–æ–Ω–µ—Ç–∞ —Å—Ç–∞—Ç–∏–∫ –º–µ—à–∞ –∫ –∞–∫—Ç–æ—Ä—É
    //–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ BaseMesh
    UPROPERTY(EditAnywhere)
    UStaticMeshComponent* BaseMesh;

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

    //–î–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –æ—Ç–≤–µ—á–∞—é—â–∏–µ –∑–∞ –∞–º–ø–ª–∏—Ç—É–¥—É –∏ —á–∞—Å—Ç–æ—Ç—É –∫–æ–ª–µ–±–∞–Ω–∏–π –¥–ª—è –ª–æ–≥–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ 
    UPROPERTY(EditAnywhere, Category = "Movement")
    float Amplitude = 50.0f;

    UPROPERTY(EditAnywhere, Category = "Movement")
    float Frequency = 2.0f;

public:
    // Called every frame
    virtual void
    Tick(float DeltaTime) override;

private:
    //–ö–µ—à—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∞–∫—Ç–æ—Ä–∞
    FVector InitialLocation;
};
```

.cpp

```cpp
// Fill out your copyright notice in the Description page of Project Settings.

#include "TestingNewActor.h"
#include "Engine/Engine.h"

// Called when the game starts or when spawned
void ATestingNewActor::BeginPlay()
{
    Super::BeginPlay();

    //–¥–æ–ø —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–∫–∞—Ü–∏–∏ –∞–∫—Ç–æ—Ä–∞
    //—Ç–∞–∫ –∂–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ Transform.GetLocation()
    //–ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø—É—Å–∫–µ –∏–≥—Ä—ã 
    InitialLocation = GetActorLocation();

}

// Called every frame
void ATestingNewActor::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);

    //–†–∞–±–æ—Ç–∞ –≤ Tick
	//–í –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é CurrentLocation, —Ç–µ–∫—É—é—â–µ–π –ø–æ–∑–∏—Ü–∏–∏. —Ç–∏–ø–∞ FVector –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º
	FVector CurrentLocation = GetActorLocation();
	if (GetWorld())
	{
		float Time = GetWorld()->GetTimeSeconds();
		CurrentLocation.Z = InitialLocation.Z + GeometryData.Amplitude * FMath::Sin(GeometryData.Frequency * Time);
		SetActorLocation(CurrentLocation);
	}
}
```


![[Pasted image 20241114073000.png]]


## ENUM
---

–í –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–º —Ñ–∞–π–ª–µ —É–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è. –î–ª—è –Ω–∏—Ö –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è uint8 –∏ —Ç–∞–∫ –∂–µ –≤ –Ω–∞—á–∞–ª–µ –Ω–∞–∑–≤–∞–Ω–∏—è —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –±—É–∫–≤–∞ E... 

```cpp
//–ö–ª–∞—Å—Å ENUM –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —Ç–∏–ø –¥–≤–∏–∂–µ–Ω–∏—è
//UENUM —ç—Ç–æ –º–∞–∫—Ä–æ—Å –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å—à–∏—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ enum –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å –µ–≥–æ –≤ –µ–¥–∏—Ç–æ—Ä
//–í—Å–µ enum –¥–æ–ª–∂–Ω—ã –Ω–∞—á–∏–Ω–∞—Ç—å —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã E , EMovementType
UENUM(BlueprintType)
enum class EMovementTypeTestingActor : uint8
{
    SIN,
    STATIC
};
```

–û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏ –≤—ã–≤–æ–¥–∏–º –µ–µ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ –≤—å—é–ø–æ—Ä—Ç–µ 

```cpp
	UPROPERTY(EditAnywhere, Category = "Movement")
	EMovementType MoveType = EMovementType::Static;
```

–í —Å–ø–ø —Ñ–∞–π–ª–µ —Å–æ–∑–¥–∞–µ–º switch. –ò —É–∫–∞–∑—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è 

```cpp
void ABaseGeometryActor::Tick(float DeltaTime)
{
	Super::Tick(DeltaTime);

	switch (MoveType)
	{
		case EMovementType::Sin:
		{
			FVector CurrentLocation = GetActorLocation();
			float time = GetWorld()->GetTimeSeconds();
			CurrentLocation.Z = InitialLocation.Z + Amplitude * FMath::Sin(Frequency * time);

			SetActorLocation(CurrentLocation);
		}
		break;

		case EMovementType::Static:break;
		default:break;
	}
}
```

![[Pasted image 20241116100210.png]]

## USTRUCT
---
USTRUCT —Å–ª—É–∂–∏—Ç –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–∏—è –≤ –≥—Ä—É–ø–ø—ã. –£ —Å—Ç—Ä—É–∫—Ç—É—Ä –≤—Å–µ–≥–¥–∞ –≤–ø–µ—Ä–µ–¥–∏ –∏–¥–µ—Ç –±—É–∫–≤–∞ F.. –∏ –º–∞–∫—Ä–æ—Å GENERATED_USTRUCT_BODY()

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏, –∞ —Ü–µ–ª—ã–º –æ–±—ä–µ–∫—Ç–æ–º

```cpp
// Fill out your copyright notice in the Description page of Project Settings.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "Components/StaticMeshComponent.h"
#include "TestingNewActor.generated.h"

//–í—Å–µ —Ç–∏–ø—ã —Å—Ç—Ä—É–∫—Ç—É—Ä –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å F
//—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–æ—Ç –∂–µ –∫–ª–∞—Å—Å, –Ω–æ –≤—Å–µ –ø–æ–ª—è public
//—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–º–µ–µ—Ç –≤—Å–µ –ø–æ–ª—è –∫–∞–∫ public
//–º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∏—Ö —É–¥–æ–±–Ω–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
USTRUCT(BlueprintType)
struct FGeometrydataTestingActor
{
    GENERATED_USTRUCT_BODY()

    //–î–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –æ—Ç–≤–µ—á–∞—é—â–∏–µ –∑–∞ –∞–º–ø–ª–∏—Ç—É–¥—É –∏ —á–∞—Å—Ç–æ—Ç—É –∫–æ–ª–µ–±–∞–Ω–∏–π –¥–ª—è –ª–æ–≥–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
    UPROPERTY(EditAnywhere, Category = "Movement")
    float Amplitude = 50.0f;

    UPROPERTY(EditAnywhere, Category = "Movement")
    float Frequency = 2.0f;

    //–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π MoveType —Ç–∏–ø–∞ enum MovementType
    //–∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–∏—è STATIC, SIN
    UPROPERTY(EditAnywhere, Category = "Movement")
    EMovementTypeTestingActor MoveType = EMovementTypeTestingActor::STATIC;
};

UCLASS()
class GAMEC_API ATestingNewActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ATestingNewActor();

    //–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫ –∫–æ–º–ø–æ–Ω–µ—Ç–∞ —Å—Ç–∞—Ç–∏–∫ –º–µ—à–∞ –∫ –∞–∫—Ç–æ—Ä—É
    //–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ BaseMesh
    UPROPERTY(EditAnywhere)
    UStaticMeshComponent* BaseMesh;

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

    //–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ö—Ä–∞–Ω—è—â–∞—è –≤ —Å–µ–±–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    //–í –Ω–µ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ 
    UPROPERTY(EditAnywhere, Category = "GeometryData")
    FGeometrydataTestingActor GeometryData;

public:
    // Called every frame
    virtual void
    Tick(float DeltaTime) override;

private:

};

```

–¢–∞–∫ –∂–µ —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ –∏–∑ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–≥—É—Ç —Ç–µ—Ä—è—Ç—å—Å—è —Å–≤—è–∑–∏. –¢–∞–∫ —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø—É—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π 

GeometryData.Amplitude
GeometryData.Frequency
GeometryData.MoveType

```cpp
switch (GeometryData.MoveType)
	{
		case EMovementType::Sin:
		{
			FVector CurrentLocation = GetActorLocation();
			float time = GetWorld()->GetTimeSeconds();
			CurrentLocation.Z = InitialLocation.Z + GeometryData.Amplitude * FMath::Sin(GeometryData.Frequency * time);
```

![[Pasted image 20241116095629.png]]

## Material
---

https://dev.epicgames.com/documentation/en-us/unreal-engine/unreal-engine-materials?application_version=5.4

–°–æ–∑–¥–∞—é—Ç—Å—è –æ–±—ã—á–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º –º–∞—Ç–µ—Ä–∏–∞–ª—ã. –ó–∞—Ç–µ–º –≤ –Ω–∏—Ö —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –í –∫–æ–¥–µ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —ç—Ç–æ–º –º–∞—Ç–µ—Ä–∏–∞–ª–µ. –í–∞–∂–µ–Ω –Ω–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞, –∞ –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ –Ω–µ–º. 

–ï—Å–ª–∏ –±—É–¥—É—Ç –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–∞, –Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–Ω—É—Ç—Ä–∏, –∫–æ–¥ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

![[Pasted image 20241117012658.png]]

![[Pasted image 20241117013133.png]]

```cpp
#include "Materials/MaterialInstanceDynamic.h"
```

–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ –º–∞—Ç–µ—Ä–∏–∞–ª–µ, –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è.

```cpp
USTRUCT(BlueprintType)
struct FGeometrydataTestingActor
{
    GENERATED_USTRUCT_BODY()

	//–ï—â–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ 

    //–¶–≤–µ—Ç –º–µ—à–∞, –∑–∞–¥–∞–Ω–∏–µ –µ–º—É —Ü–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ —ç–¥–∏—Ç–æ—Ä –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 
    UPROPERTY(EditAnywhere, Category = "Design")
    FLinearColor Color = FLinearColor::Black;
};

UCLASS()
class GAMEC_API ATestingNewActor : public AActor
{
    GENERATED_BODY()
    //–∫–æ–¥
    
private:
    void SetColor(const FLinearColor& Color);
};
```

```cpp
// Called when the game starts or when spawned
void ATestingNewActor::BeginPlay()
{
    Super::BeginPlay();

    SetColor(GeometryData.Color = FLinearColor::Blue);
}

void ATestingNewActor::SetColor(const FLinearColor& Color)
{
    if (!BaseMesh)
    {
        //–°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
        //–í —É–∫–∞–∑–∞—Ç–µ–ª—å
        UMaterialInstanceDynamic* DynMaterial = BaseMesh->CreateAndSetMaterialInstanceDynamic(0);
        if (DynMaterial)
        {
            //–£ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤—ã—Å—Ç–∞–≤–ª—è–µ–º —Ü–≤–µ—Ç –≤ –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ Color
            //–ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Ü–≤–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –∂–µ–ª—Ç—ã–π, –µ—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–æ–≤–ø–∞–¥–∞–µ—Ç –æ–Ω —Å–∞–º –∏–∑–º–µ–Ω–∏—Ç –µ–º—É —Ü–≤–µ—Ç
            //–≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –Ω–µ –Ω—É–∂–Ω–æ, –æ–Ω —Ä–µ–∞–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            //FLinearColor - 32 –±–∏—Ç–Ω—ã–π —Ü–≤–µ—Ç, FColor - 8–±–∏—Ç
            DynMaterial->SetVectorParameterValue("Color", Color);
        }
    }
}
```

```cpp
DynMaterial->SetVectorParameterValue("Color",FLinearColor::Yellow);
```

–£–∫–∞–∑–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤–æ –≤—å—é–ø–æ—Ä—Ç–µ 

```cpp
	UPROPERTY(EditAnywhere, Category = "Design")
	FLinearColor Color = FLinearColor::Black;
```

## Construction Script 

```cpp
UCLASS()
class GAMEC_API ATestingNewActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ATestingNewActor();

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

    //—Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ 
    //–ê–Ω–∞–ª–æ–≥ Construction Script 
    virtual void OnConstruction(const FTransform& Transform) override;
```

```cpp
void ATestingNewActor::OnConstruction(const FTransform& Transform)
{
    Super::OnConstruction(Transform);

	//–≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π
    SetColor(GeometryData.Color = FLinearColor::Black);
}
```
## Editor Event

```cpp
UCLASS()
class GAMEC_API ATestingNewActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ATestingNewActor();

    //–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫ –∫–æ–º–ø–æ–Ω–µ—Ç–∞ —Å—Ç–∞—Ç–∏–∫ –º–µ—à–∞ –∫ –∞–∫—Ç–æ—Ä—É
    //–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ BaseMesh
    UPROPERTY(EditAnywhere)
    UStaticMeshComponent* BaseMesh;

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;


    //–ï–≤–µ–Ω—Ç, –µ—Å–ª–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —á—Ç–æ —Ç–æ –≤ –µ–¥–∏—Ç–æ—Ä–µ —Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —ç—Ç–æ—Ç –µ–≤–µ–Ω—Ç
    //–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∫ –º–æ–µ–º—É —Ü–≤–µ—Ç—É –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥—Ä—É–≥–æ–π —Ü–≤–µ—Ç
    virtual void PostEditChangeProperty(FPropertyChangedEvent& PropertyChangedEvent) override;
```

```cpp

void ATestingNewActor::PostEditChangeProperty(FPropertyChangedEvent& PropertyChangedEvent)
{
    Super::PostEditChangeProperty(PropertyChangedEvent);

    //// 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç –º–µ—à–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ.
    //UMaterialInstanceDynamic* DynamicMaterial = UMaterialInstanceDynamic::Create(BaseMesh->GetMaterial(0), this);
    //if (DynamicMaterial)
    //{
    //    DynamicMaterial->SetVectorParameterValue(TEXT("Color"), FLinearColor::Yellow); // "Color" - –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ material
    //    BaseMesh->SetMaterial(0, DynamicMaterial);
    //}

    UMaterialInstanceDynamic* DynMaterial = BaseMesh->CreateAndSetMaterialInstanceDynamic(0);
    if (DynMaterial)
    {
        //–£ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤—ã—Å—Ç–∞–≤–ª—è–µ–º —Ü–≤–µ—Ç –≤ –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ Color
        //–ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Ü–≤–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –∂–µ–ª—Ç—ã–π, –µ—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–æ–≤–ø–∞–¥–∞–µ—Ç –æ–Ω —Å–∞–º –∏–∑–º–µ–Ω–∏—Ç –µ–º—É —Ü–≤–µ—Ç
        //–≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –Ω–µ –Ω—É–∂–Ω–æ, –æ–Ω —Ä–µ–∞–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        //FLinearColor - 32 –±–∏—Ç–Ω—ã–π —Ü–≤–µ—Ç, FColor - 8–±–∏—Ç
        DynMaterial->SetVectorParameterValue("Color", FLinearColor::Yellow);
    }
}
```
## Timer
---

https://dev.epicgames.com/documentation/en-us/unreal-engine/gameplay-timers-in-unreal-engine?application_version=5.4

–¢–∞–π–º–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è –∏ –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–∏–∫ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ 

–û–±–æ–∑–Ω–∞—á–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—á–∞—é—â—É—é –∑–∞ —á–∞—Å—Ç–æ—Ç—É —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è 

–°–æ–∑–¥–∞–µ–º –¥–∏—Å–∫—Ä–∏–ø—Ç–æ—Ä Timer Handle, –±—É–¥–µ—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–º—É. –°–º–æ–∂–µ–º –ø–æ—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –Ω–∞ –ø–∞—É–∑—É –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å. –¢–∞–∫ –∂–µ —Å–æ–∑–¥–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Ç–æ–º –±—É–¥—É—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å—Å—è 

.h

```cpp
USTRUCT(BlueprintType)
struct FGeometrydataTestingActor
{
    GENERATED_USTRUCT_BODY()
    
    //–¢–∞–π–º–µ—Ä 
    UPROPERTY(EditAnywhere, Category = "Design")
    float TimerRate = 3.0f;
};

public:
    // Called every frame
    virtual void
    Tick(float DeltaTime) override;

private:
    //–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–º–µ–Ω–Ω–æ–π –∫–ª–∞—Å—Å–∞ —Ç–∞–π–º–µ—Ä–∞
    FTimerHandle TimerHandle;

    //–∫–æ–ª–∏—á–µ—Ç—Å–≤–æ —Ä–∞–∑ —Å–∫–æ–ª—å–∫–æ —Å—Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ –∫–æ–Ω—Ü–∞ 
    const int32 MaxTimerCount = 5;

    //—Å—á–µ—Ç—á–∏–∫ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è 
    int32 TimerCount = 0;

	//–§—É–Ω–∫—Ü–∏—è –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Ç–∞–π–º–µ—Ä–∞ –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–∏–∫ 
	void OnTimerFired();
};

```

.cpp

```cpp
#include "TimerManager.h"

// Called when the game starts or when spawned
void ATestingNewActor::BeginPlay()
{
    Super::BeginPlay();

    //–≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–∞–π–º–µ—Ä–∞ —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –∑–Ω–∞—á–µ–Ω–∏–π
    //–ø–µ—Ä–µ–¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è OnTimerFired —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è —Ç–∞–π–º–µ—Ä–∞ 
    //true - —Ç–∞–π–º–µ—Ä —Å—Ä–∞–±–∞—Ç–∞–µ—Ç –æ–¥–∏–Ω —Ä–∞–∑ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 
    GetWorldTimerManager().SetTimer(TimerHandle, this, &ATestingNewActor::OnTimerFired, GeometryData.TimerRate, true);

}

void ATestingNewActor::OnTimerFired()
{
    if (++TimerCount <= MaxTimerCount)
    {
        const FLinearColor NewColor = FLinearColor::MakeRandomColor();

        //TimerCount –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä %i —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∏–ø–∞ int.
        //*NewColor.ToString() –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ —É–∫–∞–∑–∞—Ç–µ–ª—å, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä % s —Ç—Ä–µ–±—É–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–æ–∫—É —Ç–∏–ø–∞ const TCHAR *.
        UE_LOG(LogForTestingNewActor, Display, TEXT("TimerCount: %i, Color to set  up: %s"), TimerCount, *NewColor.ToString());
        SetColor(NewColor);
    }
    else
    {
        UE_LOG(LogForTestingNewActor, Display, TEXT("Timer has been stopped!"));

        //–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞, –∫–∞–∫–æ–π —Ç–∞–π–º–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
        GetWorldTimerManager().ClearTimer(TimerHandle);
    }
}
```

```

–í—ã–∑—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä

TimerHandle - —É–∫–∞–∑—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç–∞–π–º–µ—Ä

this - —É–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞ –æ–±—ä–µ–∫—Ç –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—è 

&ABaseGeometryActor::OnTimerFired - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ç–∏–∫ 

GeometryData.TimerRate - —á–∞—Å—Ç–æ—Ç–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Ç–∏–∫–æ–≤ 

true - –∑–∞—Ü–∏–∫–ª–µ–Ω–Ω—ã–π —Ç–∞–π–º–µ—Ä –∏–ª–∏ –Ω–µ—Ç. –ï—Å–ª–∏ false, —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 1 —Ä–∞–∑ –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è 

---

–°–æ–∑–¥–∞–µ–º —á—Ç–æ –±—ã —Ñ—É–Ω–∫—Ü–∏—è —Å—Ç–∞–≤–∏–ª–∞ —Ä–∞–Ω–¥–æ–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–≤–µ—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É—è —É–∂–µ –∏–º–µ—â—É—é—Å—è —Ñ—É–Ω–∫—Ü–∏—é SetColor –∏ –ø–µ—Ä–µ–¥–∞–¥–∏–º —Ç—É–¥–∞ –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é NewColor. –¢–∞–∫ –∂–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–≤–æ–¥–∏–º –ª–æ–≥ —Å —Ü–≤–µ—Ç–æ–º 

–ó–∞—Ç–µ–º –∫ —Å—á–µ—Ç—á–∏–∫—É TimerCount –¥–æ–±–∞–≤–ª—è–µ–º +1, –ø–æ–∫–∞ –æ–Ω –Ω–µ –±—É–¥–µ—Ç –º–µ–Ω—å—à–µ —á–µ–º MaxTimerCount

–ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –∏ –≤—ã–≤–æ–¥–∏–º –ª–æ–≥ 

func
```cpp
void ABaseGeometryActor::OnTimerFired()
{
	if (++TimerCount <= MaxTimerCount)
	{
		const FLinearColor NewColor = FLinearColor::MakeRandomColor();
		
		UE_LOG(LogBaseGeometry, Display, TEXT("TimerCount: %i, Color to set up: %s"), TimerCount, *NewColor.ToString());
		
		SetColor(NewColor);
	}
	else
	{
		UE_LOG(LogBaseGeometry, Warning, TEXT("Timer has been stopped!"));
		GetWorldTimerManager().ClearTimer(TimerHandle);
	}
}
```

![[Pasted image 20241117044234.png]]

## Spawn
---

Spawn documention
https://dev.epicgames.com/documentation/en-us/unreal-engine/spawning-actors-in-unreal-engine?application_version=5.4

TArray documentation
file:///O:/UnrealProject/UE_C++_And_Base/UE_C++_And_Base/2.%20–û—Å–Ω–æ–≤—ã%20C++%20–≤%20Unreal%20Engine/10.2%20–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è%20–ø–æ%20TArray.html

TSubclassOf documentation
https://dev.epicgames.com/documentation/en-us/unreal-engine/typed-object-pointer-properties-in-unreal-engine?application_version=5.4

![[Pasted image 20241130015955.png]]

.h

```c++
// Fill out your copyright notice in the Description page of Project Settings.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "TestingNewActor.h"
#include "GeometryHubTestingActor.generated.h"

//–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ø–∞–≤–Ω —ç–ª–µ–º–µ–Ω—Ç–∞
USTRUCT(BlueprintType)
struct FGeometryPayloadTestingActor
{
    GENERATED_USTRUCT_BODY()

    UPROPERTY(EditAnywhere)
    TSubclassOf<ATestingNewActor> GeometryClass;

    UPROPERTY(EditAnywhere)
    FGeometrydataTestingActor Data;

    UPROPERTY(EditAnywhere)
    FTransform InitialTransform;
};

UCLASS() class GAMEC_API AGeometryHubTestingActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    AGeometryHubTestingActor();

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

    //TSubclassOf –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –≤—Å–µ –∫–ª–∞—Å—Å—ã –¥–≤–∏–∂–∫–∞ –∏ property –º–æ–∂–Ω–æ –±—É–¥–µ—Ç
    //—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å–∞–º –∫–ª–∞—Å—Å –∏–ª–∏ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç –Ω–µ–≥–æ –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è
    //–∏–º–µ–Ω–Ω–æ GeometryClass –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç—É—Ç –±—É–¥–µ—Ç —Å–ø–∞–≤–Ω–∏—Ç—å—Å—è
    UPROPERTY(EditAnywhere)
    TSubclassOf<ATestingNewActor> GeometryClass;

    UPROPERTY(EditAnywhere)
    UClass* Class;

    UPROPERTY(EditAnywhere)
    ATestingNewActor* GeometryObject;

    //–¢–∏–ø –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ 
    //–ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–∏–ø –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ 
    UPROPERTY(EditAnywhere)
    TArray<FGeometryPayloadTestingActor> GeometryPayloads;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;
};

```

.cpp

```cpp
// Fill out your copyright notice in the Description page of Project Settings.

#include "GeometryHubTestingActor.h"
#include "Engine/World.h"

// Sets default values
AGeometryHubTestingActor::AGeometryHubTestingActor()
{
    // Set this actor to call Tick() every frame.  You can turn this off to improve performance if you don't need it.
    PrimaryActorTick.bCanEverTick = true;
}

// Called when the game starts or when spawned
void AGeometryHubTestingActor::BeginPlay()
{
    Super::BeginPlay();

    //—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∏—Ä –∏–≥—Ä—ã, –≤ –Ω–µ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è —Å–ø–∞–≤–Ω–∞
    //GetWorld() - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –º–∏—Ä–∞ –∏–≥—Ä—ã
    UWorld* World = GetWorld();
    if (World)
    {
        for (int32 i = 0; i < 10; i++)
        {
            //—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∞–∫—Ç–æ—Ä–∞
            //–ø–æ–≤–æ—Ä–æ—Ç, –ø–æ–ª–æ–∂–µ–Ω–∏–µ, —Ä–∞–∑–º–µ—Ä
            const FTransform GeometryTransform = FTransform(FRotator::ZeroRotator, FVector(0.0f, 300.0f * i, 300.0f));

            //—Å–ø–∞–≤–Ω –æ–±—ä–µ–∫—Ç–∞
            //–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö —Å–ø–∞–≤–Ω–∞ –æ–Ω –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –æ–±—ä–µ–∫—Ç —Å–ø–∞–≤–Ω–∞
            //–ª–æ–∫–∞—Ü–∏—é, —Ä–æ—Ç–∞—Ü–∏—é –∏ –¥–æ–ø –¥–∞–Ω–Ω—ã–µ
            //World->SpawnActor(GeometryClass);

            //—Å–æ–∑–¥–∞–µ–º –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–∏ —Ç–∏–ø–æ–≤, —á—Ç–æ –º–æ–≥–ª–∏ —Å—Ä–∞–∑—É –∏–º–µ—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—ä–µ–∫—Ç –Ω–∞—à–µ–≥–æ —Ç–∏–ø–∞
            //—Ç–æ –µ—Å—Ç—å –Ω–µ –Ω–∞–¥–æ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫–∞—Å—Ç –æ—Ç AActor –∫ ATestingNewActor
            //—Ç–∞–∫ –∂–µ –ø–µ—Ä–µ–¥–∞–µ–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –∞–∫—Ç–æ—Ä–∞
            ATestingNewActor* Geometry = World->SpawnActor<ATestingNewActor>(GeometryClass, GeometryTransform);

            //–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å, –º–æ–∂–µ–º –ª–∏ –º—ã –≤–æ–æ–±—â–µ –≤–∑—è—Ç—å –æ–±—ä–µ–∫—Ç Geometry. –∏–Ω–∞—á–µ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞
            if (Geometry)
            {
                FGeometrydataTestingActor Data;
                Data.MoveType = FMath::RandBool() ? EMovementTypeTestingActor::STATIC : EMovementTypeTestingActor::SIN;
                Geometry->SetGeometryData(Data);
            }
        }

        //–¥–ª—è 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        for (int32 i = 0; i < 10; i++)
        {
            //–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            const FTransform GeometryTransform = FTransform(FRotator::ZeroRotator, FVector(0.0f, 300.0f * i, 700.0f));

            //SpawnActorDeferred
            //—ç—Ç–æ—Ç —Å–ø–∞–≤–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ç–µ–º —á—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–∫—Ç–æ—Ä–∞, –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Å—Ç—É—Ä–∫—Ç–æ—Ä,
            //–∞ –±–µ–≥–∏–Ω –ø–ª–µ–π –Ω–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω
            ATestingNewActor* Geometry = World->SpawnActorDeferred<ATestingNewActor>(GeometryClass, GeometryTransform);

            if (Geometry)
            {
                FGeometrydataTestingActor Data;
                Data.Color = FLinearColor::MakeRandomColor();
                Geometry->SetGeometryData(Data);

                //—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –±–µ–≥–∏–Ω –ø–ª–µ–π
                Geometry->FinishSpawning(GeometryTransform);
            }
        }

        //–¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –º–∞—Å—Å–∏–≤–µ GeometryPayloads
        //—Ä–∞–∑–¥–µ–ª—è–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (const FGeometryPayloadTestingActor Payload) —Ü–∏–∫–ª–∞
        //–æ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ GeometryPayloads (–¥–∏–∞–ø–∞–∑–æ–Ω–∞), –ø–æ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –∏—Ç–µ—Ä–∞—Ü–∏—è

        for (const FGeometryPayloadTestingActor Payload : GeometryPayloads)
        {
            //World->SpawnActorDeferred<ATestingNewActor>(...)
            //
            //World : –≠—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ç–µ–∫—É—â–∏–π –∏–≥—Ä–æ–≤–æ–π –º–∏—Ä(UWorld*).
            //–û–±—ã—á–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ GetWorld().
            //–ú–∏—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –∞–∫—Ç–æ—Ä–∞–º–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ.
            //
            //SpawnActorDeferred : –≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–ø–∞–≤–Ω–∞(—Å–æ–∑–¥–∞–Ω–∏—è) –∞–∫—Ç–æ—Ä–∞,
            //–∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–∞–ø—ã –µ–≥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
            //–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç SpawnActor, SpawnActorDeferred –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Å—Ä–∞–∑—É BeginPlay()
            //–∏ –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ–ª–Ω—ã–º –ø–æ—è–≤–ª–µ–Ω–∏–µ–º –∞–∫—Ç–æ—Ä–∞ –≤ –º–∏—Ä–µ.
            //
            //<ATestingNewActor> : –≠—Ç–æ —à–∞–±–ª–æ–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –æ–∂–∏–¥–∞–µ–º—ã–π —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
            //–¢–æ –µ—Å—Ç—å, –º—ã –≥–æ–≤–æ—Ä–∏–º, —á—Ç–æ —Ö–æ—Ç–∏–º –∑–∞—Å–ø–∞–≤–Ω–∏—Ç—å –∞–∫—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç(–∏–ª–∏ –±—É–¥–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º —Å)
            //—Ç–∏–ø–æ–º ATestingNewActor, –∏ –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –∏–º–µ–Ω–Ω–æ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞.
            //
            //Payload.GeometryClass : –≠—Ç–æ –∞—Ä–≥—É–º–µ–Ω—Ç, –ø–µ—Ä–µ–¥–∞—é—â–∏–π –∫–ª–∞—Å—Å –∞–∫—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å.
            //–û–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∏–ø–∞ TSubclassOf<AActor>(–∏–ª–∏ –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä TSubclassOf<ATestingNewActor>).
            //–≠—Ç–æ UClass * –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –≤—ã–±—Ä–∞–Ω –≤ Payload.–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–ø–∞–≤–Ω–∏—Ç—å –∞–∫—Ç–æ—Ä—ã —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤,
            //–µ—Å–ª–∏ Payload.GeometryClass –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∫–ª–∞—Å—Å—ã.
            //
            //Payload.InitialTransform : –≠—Ç–æ –∞—Ä–≥—É–º–µ–Ω—Ç, –ø–µ—Ä–µ–¥–∞—é—â–∏–π –Ω–∞—á–∞–ª—å–Ω—É—é —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é(–ø–æ–ª–æ–∂–µ–Ω–∏–µ, –ø–æ–≤–æ—Ä–æ—Ç, –º–∞—Å—à—Ç–∞–±)
            //–¥–ª—è —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ –∞–∫—Ç–æ—Ä–∞.–¢–∏–ø FTransform.ATestingNewActor* Geometry = ... :
            //–†–µ–∑—É–ª—å—Ç–∞—Ç SpawnActorDeferred –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—é Geometry —Ç–∏–ø–∞ ATestingNewActor*.

            //–ó–∞—á–µ–º –Ω—É–∂–µ–Ω SpawnActorDeferred ?
            //–û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è,–∫–æ–≥–¥–∞ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–∫—Ç–æ—Ä–∞(—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞,
            //–≤—ã–∑–≤–∞—Ç—å –∫–∞–∫–∏–µ - —Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏) –¥–æ —Ç–æ–≥–æ,
            //–∫–∞–∫ –æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—è–≤–∏—Ç—Å—è –≤ –º–∏—Ä–µ –∏ –Ω–∞—á–Ω–µ—Ç —Å–≤–æ—é ‚Äú–∂–∏–∑–Ω—å‚Äù (–¥–æ –≤—ã–∑–æ–≤–∞ BeginPlay()).
            //–ï—Å–ª–∏ –±—ã —Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –æ–±—ã—á–Ω—ã–π SpawnActor,
            //—Ç–æ BeginPlay() –±—ã–ª –±—ã –≤—ã–∑–≤–∞–Ω —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞,
            //–∏ —É —Ç–µ–±—è –Ω–µ –±—ã–ª–æ –±—ã –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —á—Ç–æ - —Ç–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–¥ —ç—Ç–∏–º.

            ATestingNewActor* Geometry = World->SpawnActorDeferred<ATestingNewActor>(Payload.GeometryClass, Payload.InitialTransform);

            if (Geometry)
            {
                //–ú—ã –ø–µ—Ä–µ–¥–∞–µ–º –≤ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –∫–∞–∫–∏–µ-—Ç–æ –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–∞—à–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Payload.
                Geometry->SetGeometryData(Payload.Data);

                //–ò–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å, –º–µ–∂–¥—É SpawnActorDeferred –∏ FinishSpawning,
                //—Ç—ã –º–æ–∂–µ—à—å –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Å–µ—Ç—Ç–µ—Ä—ã –∏ –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤–æ–µ–≥–æ –∞–∫—Ç–æ—Ä–∞.
                //–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ BeginPlay() –µ—â–µ –Ω–µ –±—ã–ª –≤—ã–∑–≤–∞–Ω.

                //–ß—Ç–æ –æ–Ω–∞ –¥–µ–ª–∞–µ—Ç:
                //–ó–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–∫—Ç–æ—Ä–∞.
                //–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–∫—Ç–æ—Ä–∞ –≤ –º–∏—Ä–µ.–í—ã–∑—ã–≤–∞–µ—Ç PostActorCreated()(–µ—Å–ª–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω).
                //–í—ã–∑—ã–≤–∞–µ—Ç ExecuteConstruction()(—á—Ç–æ –≤—ã–∑–æ–≤–µ—Ç OnConstruction() –≤ C++ –∏ Construction Script –≤ Blueprint).
                //–í—ã–∑—ã–≤–∞–µ—Ç PostInitializeComponents().
                //–í—ã–∑—ã–≤–∞–µ—Ç BeginPlay().
                //–ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–æ—Ä —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Äú–∂–∏–≤—ã–º‚Äù –∏ –∞–∫—Ç–∏–≤–Ω—ã–º –≤ –º–∏—Ä–µ.
                //
                //Payload.InitialTransform: –í FinishSpawning —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è.
                Geometry->FinishSpawning(Payload.InitialTransform);
            }
        }
    }
}

// Called every frame
void AGeometryHubTestingActor::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);
}
```

```cpp
#include "Engine/World.h"
```

```cpp
	UWorld* World = GetWorld();
```

–°–æ–∑–¥–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —á–∏—Å—Ç—ã–π –∞–∫—Ç–æ—Ä. –ö–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –∞–∫—Ç–æ—Ä—ã –º–∞–∫—Ä–æ—Å–æ–º SpawnActor

![[Pasted image 20241130020940.png]]
–ó–¥–µ—Å—å —Å–æ–∑–¥–∞–µ—Ç—Å—è 10 –∞–∫—Ç–æ—Ä–æ–≤ ABaseGeometryActor, –∏–º –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–∂–µ–Ω–∏–µ. –ê —Ç–∞–∫ –∂–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞—Å—Ç –¥–æ –Ω–∏—Ö 

–¢–∞–∫ –∂–µ –¥–∞–ª—å—à–µ —É–∫–∞–∑—ã–∞–µ—Ç—Å—è –∏—Ö –¥–≤–∏–∂–µ–Ω–∏–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω–æ–µ –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –ª–∏–±–æ –¥–≤–∏–≥–∞—é—Ç—Å—è, –ª–∏–±–æ —Å—Ç–æ—è—Ç

```cpp
		for (int32 i = 0; i < 10; ++i)
		{
			const FTransform GeometryTransform = FTransform(FRotator::ZeroRotator, FVector(0.0f, 300.0f * i, 300.0f));
			ABaseGeometryActor* Geometry = World->SpawnActor<ABaseGeometryActor>(GeometryClass, GeometryTransform);

			if (Geometry)
			{
				FGeometryData Data;
				Data.MoveType = FMath::RandBool() ? EMovementType::Static : EMovementType::Sin;
				Geometry->SetGeometryData(Data);
			}
		}
```

–¢–∞–∫ –∂–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è, –±—ã–ª —Å–¥–µ–ª–∞–Ω –¥–æ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ ABaseGeometryActor

```cpp
	void SetGeometryData(const FGeometryData& Data) { GeometryData = Data; }
```

![[Pasted image 20241130023230.png]]

–ú–æ–∂–Ω–æ –≤–æ –≤—å—é–ø–æ—Ä—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –∞–∫—Ç–æ—Ä –¥–ª—è –≤—ã–∑–æ–≤–∞. GeometryHubActor.h

```cpp
#include "BaseGeometryActor.h"

	UPROPERTY(EditAnywhere)
	TSubclassOf<ABaseGeometryActor> GeometryClass;
		
	UPROPERTY(EditAnywhere)
	UClass* Class;

	UPROPERTY(EditAnywhere)
	ABaseGeometryActor* GeometryObject;
```

![[Pasted image 20241130024534.png]]

![[Pasted image 20241130024635.png]]
![[Pasted image 20241130024643.png]]
![[Pasted image 20241130024651.png]]



–¢–∞–∫ –∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫—Ç–æ—Ä–∞, –∑–∞–ø—É—Å—Ç–∏–≤ —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫, –∞ –ø–æ—Ç–æ–º –±–µ–≥–∏–Ω –ø–ª–µ–π —Å–∞–º–æ–≥–æ –∞–∫—Ç–æ—Ä–∞. 

SpawnActorDeferred

```cpp
		for (int32 i = 0; i < 10; ++i)
		{
			const FTransform GeometryTransform = FTransform(FRotator::ZeroRotator, FVector(0.0f, 300.0f * i, 700.0f));
			ABaseGeometryActor* Geometry = World->SpawnActorDeferred<ABaseGeometryActor>(GeometryClass, GeometryTransform);

			if (Geometry)
			{
				FGeometryData Data;
				Data.Color = FLinearColor::MakeRandomColor();
				Geometry->SetGeometryData(Data);
				Geometry->FinishSpawning(GeometryTransform)
			}
		}
```

–í geometryHubActor.h

–ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å –∞—Ä—Ä–µ–π –∏–∑ –æ–±—ä–µ–∫—Ç–æ–≤ 

```cpp
USTRUCT(BlueprintType)
struct FGeometryPayload
{
	GENERATED_USTRUCT_BODY()

	UPROPERTY(EditAnywhere)
	TSubclassOf<ABaseGeometryActor> GeometryClass;

	UPROPERTY(EditAnywhere)
	FGeometryData Data;

	UPROPERTY(EditAnywhere)
	FTransform InitialTransform;
};
```

```cpp
	UPROPERTY(EditAnywhere)
	TArray<FGeometryPayload> GeometryPayloads;
```

.cpp

```Cpp

void AGeometryHubActor::DoActorSpawn1()
{
	UWorld* World = GetWorld();
	if (World)
	{
		for (int32 i = 0; i < 10; ++i)
		{
			const FTransform GeometryTransform = FTransform(FRotator::ZeroRotator, FVector(0.0f, 300.0f * i, 300.0f));
			ABaseGeometryActor* Geometry = World->SpawnActor<ABaseGeometryActor>(GeometryClass, GeometryTransform);

			if (Geometry)
			{
				FGeometryData Data;
				Data.MoveType = FMath::RandBool() ? EMovementType::Static : EMovementType::Sin;
				Geometry->SetGeometryData(Data);
			}
		}
	}
}

void AGeometryHubActor::DoActorSpawn2()
{
	UWorld* World = GetWorld();
	if (World)
	{
		for (int32 i = 0; i < 10; ++i)
		{
			const FTransform GeometryTransform = FTransform(FRotator::ZeroRotator, FVector(0.0f, 300.0f * i, 700.0f));
			ABaseGeometryActor* Geometry = World->SpawnActorDeferred<ABaseGeometryActor>(GeometryClass, GeometryTransform);

			if (Geometry)
			{
				FGeometryData Data;
				Data.Color = FLinearColor::MakeRandomColor();
				Geometry->SetGeometryData(Data);
				Geometry->FinishSpawning(GeometryTransform);
			}
		}
	}
}

void AGeometryHubActor::DoActorSpawn3()
{
	UWorld* World = GetWorld();
	if (World)
	{
		for (const FGeometryPayload Payload : GeometryPayloads)
		{
			ABaseGeometryActor* Geometry = World->SpawnActorDeferred<ABaseGeometryActor>(Payload.GeometryClass, Payload.InitialTransform);

			if (Geometry)
			{
				Geometry->SetGeometryData(Payload.Data);
				Geometry->FinishSpawning(Payload.InitialTransform);
			}
		}
	}
}
```

![[Pasted image 20241130031543.png]]

## UFUNCTION, –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –±–ª—é–ø—Ä–∏–Ω—Ç –≥—Ä–∞—Ñ–µ 
---
https://dev.epicgames.com/documentation/en-us/unreal-engine/ufunctions-in-unreal-engine?application_version=5.4

–ø—É—Ç–µ–º –≤—ã–∑–æ–≤–∞ break –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –ø–æ–ª—è–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∫—Ä–æ–º–µ –ø–æ–ª—è timer rate, —Ç–∞–∫ –∫–∞–∫ –¥–ª—è –Ω–µ–≥–æ –Ω–µ —É–∫–∞–∑–∞–ª–∏ BlueprintReadWrite

![[Pasted image 20241211123548.png]]

![[Pasted image 20250513055214.png]]

```cpp
USTRUCT(BlueprintType)
struct FGeometrydataTestingActor
{
    GENERATED_USTRUCT_BODY()

	//BlueprintReadWrite –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—Ç–∞—â–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ –±–ª—é–ø—Ä–∏–Ω—Ç –≥—Ä–∞—Ñ

    //–î–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –æ—Ç–≤–µ—á–∞—é—â–∏–µ –∑–∞ –∞–º–ø–ª–∏—Ç—É–¥—É –∏ —á–∞—Å—Ç–æ—Ç—É –∫–æ–ª–µ–±–∞–Ω–∏–π –¥–ª—è –ª–æ–≥–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
    UPROPERTY(EditAnywhere, BlueprintReadWrite,Category = "Movement")
    float Amplitude = 50.0f;

    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Movement")
    float Frequency = 2.0f;

    //–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π MoveType —Ç–∏–ø–∞ enum MovementType
    //–∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–∏—è STATIC, SIN
    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Movement")
    EMovementTypeTestingActor MoveType = EMovementTypeTestingActor::STATIC;

    //–¶–≤–µ—Ç –º–µ—à–∞
    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Design")
    FLinearColor Color = FLinearColor::Black;

    //–¢–∞–π–º–µ—Ä 
    UPROPERTY(EditAnywhere, Category = "Design")
    float TimerRate = 3.0f;
};

UCLASS()
class GAMEC_API ATestingNewActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ATestingNewActor();

    //–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫ –∫–æ–º–ø–æ–Ω–µ—Ç–∞ —Å—Ç–∞—Ç–∏–∫ –º–µ—à–∞ –∫ –∞–∫—Ç–æ—Ä—É
    //–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ BaseMesh
    UPROPERTY(EditAnywhere)
    UStaticMeshComponent* BaseMesh;

    //–ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ –±–ª—é–ø—Ä–∏–Ω—Ç –≥—Ä–∞—Ñ–∞ 
    UFUNCTION(BlueprintCallable)
    FGeometrydataTestingActor GetGeometryData() const {return GeometryData;}

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

    //–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ö—Ä–∞–Ω—è—â–∞—è –≤ —Å–µ–±–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    //–í –Ω–µ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    UPROPERTY(EditAnywhere,BlueprintReadWrite,  Category = "GeometryData")
    FGeometrydataTestingActor GeometryData;
    
public:
    // Called every frame
    virtual void
    Tick(float DeltaTime) override;

private:
};

```

–ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ GeometryData –≤—ã—Ç–∞—â–∏—Ç—å –≤ –±–ª—é–ø—Ä–∏–Ω—Ç 

```cpp

	UFUNCTION(BlueprintCallable)
	
	BlueprintReadWrite
	
```

```cpp
USTRUCT(BlueprintType)
struct FGeometryData
{
	GENERATED_USTRUCT_BODY()

	UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Movement")
	float Amplitude = 50.0f;

	UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Movement")
	float Frequency = 2.0f;

	UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Movement")
	EMovementType MoveType = EMovementType::Static;

	UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Design")
	FLinearColor Color = FLinearColor::Black;

	UPROPERTY(EditAnywhere, Category = "Design")
	float TimerRate = 1.0f;
};

public:	
	// Sets default values for this actor's properties
	ABaseGeometryActor();

	UPROPERTY(VisibleAnywhere)
		UStaticMeshComponent* BaseMesh;

	void SetGeometryData(const FGeometryData& Data) { GeometryData = Data; }

	UFUNCTION(BlueprintCallable)
	FGeometryData GetGeometryData() const {return GeometryData; }
```

## –î–µ–ª–µ–≥–∞—Ç—ã. –†–∞–∑—Ä—É—à–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞. Destroy
---

Delegate documentation
https://dev.epicgames.com/documentation/en-us/unreal-engine/delegates-and-lamba-functions-in-unreal-engine?application_version=5.4

–ü–æ–∑–≤–æ–ª—è—é—Ç —Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å–µ–±–µ –º–µ—Ç–æ–¥ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π, –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏ –≤—ã–∑—ã–≤–∞—Ç—å –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ 

–î–µ–ª–µ–≥–∞—Ç —ç—Ç–æ —Ç–æ—Ç –∂–µ –µ–≤–µ–Ω—Ç –¥–∏—Å–ø–∞—Ç—á–µ—Ä 

–î–µ–ª–µ–≥–∞—Ç—ã –≤ Unreal Engine (–∏ –≤ C++ –≤ —Ü–µ–ª–æ–º, —Ö–æ—Ç—è UE –∏–º–µ–µ—Ç —Å–≤–æ—é –º–æ—â–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é) ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç¬†**–±–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞, –Ω–µ –∑–Ω–∞—è —Ç–∏–ø —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.**

–ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, —ç—Ç–æ¬†**—Å–ø–æ—Å–æ–± –¥–ª—è –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —Å–∫–∞–∑–∞—Ç—å –¥—Ä—É–≥–æ–º—É: ‚Äú–ö–æ–≥–¥–∞ —É —Ç–µ–±—è –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–∑–æ–≤–∏ –≤–æ—Ç —ç—Ç—É –º–æ—é —Ñ—É–Ω–∫—Ü–∏—é‚Äù.**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —Å–µ–±–µ —ç—Ç–æ –∫–∞–∫ –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:**

1. **–£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –∏ –≥–∏–±—á–µ:**¬†–î–µ–ª–µ–≥–∞—Ç, –ø–æ —Å—É—Ç–∏, —Ö—Ä–∞–Ω–∏—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é-—á–ª–µ–Ω –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –æ–±—ä–µ–∫—Ç–∞ (–∏–ª–∏ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—É—é/—Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é). –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—ã—Ä—ã—Ö —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ C++, –¥–µ–ª–µ–≥–∞—Ç—ã –≤ UE:
    
    - **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã:**¬†–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ (—Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –¥–µ–ª–µ–≥–∞—Ç–∞.
    - **–ó–Ω–∞—é—Ç –æ–± –æ–±—ä–µ–∫—Ç–µ:**¬†–î–µ–ª–µ–≥–∞—Ç, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å —Ñ—É–Ω–∫—Ü–∏–µ–π-—á–ª–µ–Ω–æ–º, –∑–Ω–∞–µ—Ç, –Ω–∞ –∫–∞–∫–æ–º –æ–±—ä–µ–∫—Ç–µ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –≤—ã–∑—ã–≤–∞—Ç—å.
    - **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å:**¬†–ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–≤—è–∑–∞–Ω –ª–∏ –¥–µ–ª–µ–≥–∞—Ç —Å –∫–∞–∫–æ–π-–ª–∏–±–æ —Ñ—É–Ω–∫—Ü–∏–µ–π, –ø–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –µ–≥–æ –≤—ã–∑–≤–∞—Ç—å (`IsBound()`,¬†`ExecuteIfBound()`).
    - **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ/–æ—Ç–≤—è–∑—ã–≤–∞–Ω–∏–µ:**¬†–§—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å –∏ –æ—Ç–≤—è–∑—ã–≤–∞—Ç—å –æ—Ç –¥–µ–ª–µ–≥–∞—Ç–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
2. **–ú–µ—Ö–∞–Ω–∏–∑–º –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (Callback):**¬†–î–µ–ª–µ–≥–∞—Ç—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–ª–±—ç–∫–æ–≤. –û–¥–∏–Ω –æ–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å –¥–µ–ª–µ–≥–∞—Ç –¥—Ä—É–≥–æ–º—É, –∏ –≤—Ç–æ—Ä–æ–π –æ–±—ä–µ–∫—Ç –≤—ã–∑–æ–≤–µ—Ç —ç—Ç–æ—Ç –¥–µ–ª–µ–≥–∞—Ç, –∫–æ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç.
    
3. **–°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π:**¬†–î–µ–ª–µ–≥–∞—Ç—ã –ª–µ–∂–∞—Ç –≤ –æ—Å–Ω–æ–≤–µ —Å–∏—Å—Ç–µ–º—ã —Å–æ–±—ã—Ç–∏–π Unreal Engine.
    

**–ó–∞—á–µ–º –Ω—É–∂–Ω—ã –¥–µ–ª–µ–≥–∞—Ç—ã?**

- **–î–µ–∫–∞–ø–ª–∏–Ω–≥ (Decoupling) / –°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å:**¬†–û–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π ‚Äú–≤–µ—â–∞–µ—Ç‚Äù (broadcasts) —Å–æ–±—ã—Ç–∏–µ —á–µ—Ä–µ–∑ –¥–µ–ª–µ–≥–∞—Ç, –Ω–µ –¥–æ–ª–∂–µ–Ω –Ω–∏—á–µ–≥–æ –∑–Ω–∞—Ç—å –æ —Ç–æ–º, –∫—Ç–æ –Ω–∞ —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –ø–æ–¥–ø–∏—Å–∞–Ω –∏ –∫–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –≤—ã–∑–≤–∞–Ω—ã. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ –º–æ–¥—É–ª—å–Ω—ã–º –∏ –≥–∏–±–∫–∏–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–Ω–æ–ø–∫–∞ –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –ø—Ä–∏ –µ–µ –Ω–∞–∂–∞—Ç–∏–∏; –æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ —Å–æ–æ–±—â–∞–µ—Ç ‚Äú–ú–µ–Ω—è –Ω–∞–∂–∞–ª–∏!‚Äù, –∞ –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∞ —ç—Ç–æ—Ç –¥–µ–ª–µ–≥–∞—Ç, —Ä–µ–∞–≥–∏—Ä—É—é—Ç.
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö:**¬†–ö–æ–≥–¥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –º–µ–Ω—è–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–¥–æ—Ä–æ–≤—å–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞), –æ–Ω –º–æ–∂–µ—Ç —É–≤–µ–¥–æ–º–∏—Ç—å –æ–± —ç—Ç–æ–º –¥—Ä—É–≥–∏–µ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, UI –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–æ—Å–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è, –∑–≤—É–∫–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è –∑–≤—É–∫–∞) —á–µ—Ä–µ–∑ –¥–µ–ª–µ–≥–∞—Ç.
- **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è:**¬†–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, –ø—Ä–∏–≤—è–∑—ã–≤–∞—è —Ä–∞–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –µ–≥–æ –¥–µ–ª–µ–≥–∞—Ç–∞–º.

**–¢–∏–ø—ã –¥–µ–ª–µ–≥–∞—Ç–æ–≤ –≤ Unreal Engine:**

–í UE —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –¥–µ–ª–µ–≥–∞—Ç–æ–≤, –∫–∞–∂–¥—ã–π –¥–ª—è —Å–≤–æ–∏—Ö –Ω—É–∂–¥:

1. **–û–¥–Ω–æ–∞–¥—Ä–µ—Å–Ω—ã–µ (Single-cast) –¥–µ–ª–µ–≥–∞—Ç—ã:**
    
    - –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω–∞ —Ç–æ–ª—å–∫–æ¬†**–æ–¥–Ω–∞**¬†—Ñ—É–Ω–∫—Ü–∏—è.
    - –ï—Å–ª–∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é, —Å—Ç–∞—Ä–∞—è –æ—Ç–≤—è–∂–µ—Ç—Å—è.
    - –ú–æ–≥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ.
    - –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è:¬†`DECLARE_DELEGATE...`¬†(–Ω–∞–ø—Ä–∏–º–µ—Ä,¬†`DECLARE_DELEGATE(FMyDelegateName)`¬†–∏–ª–∏¬†`DECLARE_DELEGATE_RetVal_OneParam(float, FMyDelegateName, int32)`)
    - –î–ª—è –≤—ã–∑–æ–≤–∞:¬†`Execute()`,¬†`ExecuteIfBound()`.
    - 
2. **–ú–Ω–æ–≥–æ–∞–¥—Ä–µ—Å–Ω—ã–µ (Multicast) –¥–µ–ª–µ–≥–∞—Ç—ã:**
    
    - –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω–æ¬†**–Ω–µ—Å–∫–æ–ª—å–∫–æ**¬†—Ñ—É–Ω–∫—Ü–∏–π.
    - –ü—Ä–∏ –≤—ã–∑–æ–≤–µ –¥–µ–ª–µ–≥–∞—Ç–∞ –±—É–¥—É—Ç –≤—ã–∑–≤–∞–Ω—ã –≤—Å–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤ –ø–æ—Ä—è–¥–∫–µ –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏—è).
    - **–ù–µ –º–æ–≥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ**¬†(–ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫–æ–π –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å).
    - –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è:¬†`DECLARE_MULTICAST_DELEGATE...`¬†(–Ω–∞–ø—Ä–∏–º–µ—Ä,¬†`DECLARE_MULTICAST_DELEGATE(FMyMulticastDelegateName)`¬†–∏–ª–∏¬†`DECLARE_MULTICAST_DELEGATE_OneParam(FMyMulticastDelegateName, float)`)
    - –î–ª—è –≤—ã–∑–æ–≤–∞:¬†`Broadcast()`.
    - –î–ª—è –ø—Ä–∏–≤—è–∑–∫–∏/–æ—Ç–≤—è–∑–∫–∏:¬†`Add...()`,¬†`Remove...()`.
3. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ (Dynamic) –¥–µ–ª–µ–≥–∞—Ç—ã:**
    
    - –ú–æ–≥—É—Ç –±—ã—Ç—å¬†**—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω—ã**¬†(—Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã) –∏¬†**–±–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å Blueprints**.
    - –ü—Ä–∏–≤—è–∑–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –∏—Ö –∏–º–µ–Ω–∏ (FName), —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –º–µ–¥–ª–µ–Ω–Ω–µ–µ –æ–±—ã—á–Ω—ã—Ö –¥–µ–ª–µ–≥–∞—Ç–æ–≤.
    - –ú–æ–≥—É—Ç –±—ã—Ç—å –∫–∞–∫ –æ–¥–Ω–æ–∞–¥—Ä–µ—Å–Ω—ã–º–∏, —Ç–∞–∫ –∏ –º–Ω–æ–≥–æ–∞–¥—Ä–µ—Å–Ω—ã–º–∏.
    - –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è:¬†`DECLARE_DYNAMIC_DELEGATE...`,¬†`DECLARE_DYNAMIC_MULTICAST_DELEGATE...`
    - –§—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º—ã–µ –∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –¥–µ–ª–µ–≥–∞—Ç–∞–º, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫¬†`UFUNCTION()`.

![[Pasted image 20250513064502.png]]

![[Pasted image 20250513070804.png]]


![[Pasted image 20241211181650.png]]

LogForTestingNewActor: Display: TimerCount: 5, Color to set  up: (R=1.000000,G=0.164062,B=0.000000,A=1.000000)
LogHubActor: Warning: Actor name: BP_Cube_MyTestingNewActor_C_0 Color: (R=1.000000,G=0.164062,B=0.000000,A=1.000000)
LogBlueprintUserMessages: [BP_Cube_MyTestingNewActor_C_0] BP_Cube_MyTestingNewActor_C_0 = (R=1.000000,G=0.164062,B=0.000000,A=1.000000)
LogForTestingNewActor: Display: Timer has been stopped!
LogHubActor: Error: Timer finished: BP_Cube_MyTestingNewActor_C_0
LogHubActor: Error: Cast success, amplitude 50.000000
LogForTestingNewActor: Error: Actor has been destroyed

.h

```cpp

//–æ–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–µ–ª–µ–≥–∞—Ç–∞
//–í—Å–µ –¥–µ–ª–µ–≥–∞—Ç—ã –Ω–∞–∑–∞–≤–Ω–∏—è –æ–±—ä—è–≤–ª—è—é—Ç—Å—è —Å –±–æ–ª—å—à–æ–π –±—É–∫–≤—ã F
DECLARE_DYNAMIC_MULTICAST_DELEGATE_TwoParams(FOnColorChangedTestingNewActor, const FLinearColor&, Color, const FString&, Name);

//—Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ—Ç –¥–µ–ª–µ–≥–∞—Ç —Ç–æ–ª—å–∫–æ –≤ —Å++, –º—ã –º–æ–∂–µ–º –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å –∏–º—è –∞–∫—Ç–æ—Ä–∞ –≤ –±–ª—é–ø—Ä–∏–Ω—Ç–∞—Ö
DECLARE_MULTICAST_DELEGATE_OneParam(FOnTimerFinishedTestingNewActor, AActor*);

UCLASS()
class GAMEC_API ATestingNewActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ATestingNewActor();

    //—Å–æ–∑–¥–∞–Ω–∏–µ –¥–µ–ª–µ–≥–∞—Ç–æ–≤
    //—Ç–∞–∫ –∂–µ —á—Ç–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –Ω–µ–≥–æ –≤ –±–ª—é–ø—Ä–∏–Ω—Ç–∞—Ö
    UPROPERTY(BlueprintAssignable)
    FOnColorChangedTestingNewActor OnColorChanged;

    FOnTimerFinishedTestingNewActor OnTimerFinished;

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;


    //–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–Ω—Ü–∞ 
    virtual void EndPlay(const EEndPlayReason::Type EndPlayReason) override;

```

```CPP
UCLASS() class GAMEC_API AGeometryHubTestingActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    AGeometryHubTestingActor();

private:
	//–§—É–Ω–∫—Ü–∏—è –Ω–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –¥–µ–ª–µ–≥–∞—Ç–æ–≤
    //–§—É–Ω–∫—Ü–∏–∏ –∫–æ—Ç–æ—Ä—ã–µ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –¥–∏–ª–µ–≥–∞—Ç–∞–º, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–º–µ—á–µ–Ω—ã UFUNCTION
    UFUNCTION()
    void OnColorChanged(const FLinearColor& Color, const FString& Name);

    void OnTimerFinished(AActor* Actor);
};
```

```cpp

DEFINE_LOG_CATEGORY_STATIC(LogHubActor, All, All);


//—Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –¥–µ–ª–µ–≥–∞—Ç–æ–≤
void AGeometryHubTestingActor::OnColorChanged(const FLinearColor& Color, const FString& Name)
{
    UE_LOG(LogHubActor, Warning, TEXT("Actor name: %s Color: %s"), *Name, *Color.ToString());
}

void AGeometryHubTestingActor::OnTimerFinished(AActor* Actor)
{
    if (!Actor) return;
    UE_LOG(LogHubActor, Error, TEXT("Timer finished: %s"), *Actor->GetName());

    //–î–∞—É–Ω–∫–∞—Å—Ç–∏–Ω–≥, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –Ω–∞ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∫–ª–∞—Å—Å –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞
    ATestingNewActor* Geometry = Cast<ATestingNewActor>(Actor);
    if (!Geometry) return;

    UE_LOG(LogHubActor, Error, TEXT("Cast success, amplitude %f"), Geometry->GetGeometryData().Amplitude);

    //—É–¥–∞–ª–µ–Ω–∏–µ –∞–∫—Ç–æ—Ä–∞ —Å–æ —Å—Ü–µ–Ω—ã
    Geometry->Destroy();

    //—á–µ—Ä–µ–∑ 2 —Å–µ–∫ –≤—ã–∑–æ–≤–µ—Ç—Å—è destroy
    //Geometry->SetLifeSpan(2.0f);
}

```

```cpp
void ATestingNewActor::OnTimerFired()
{
    if (++TimerCount <= MaxTimerCount)
    {
        const FLinearColor NewColor = FLinearColor::MakeRandomColor();

        //TimerCount –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä %i —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∏–ø–∞ int.
        //*NewColor.ToString() –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ —É–∫–∞–∑–∞—Ç–µ–ª—å, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä % s —Ç—Ä–µ–±—É–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–æ–∫—É —Ç–∏–ø–∞ const TCHAR *.
        UE_LOG(LogForTestingNewActor, Display, TEXT("TimerCount: %i, Color to set  up: %s"), TimerCount, *NewColor.ToString());
        SetColor(NewColor);
        
        //–í—ã–∑–æ–≤ –¥–µ–ª–µ–≥–∞—Ç–∞, –≥–æ–≤–æ—Ä–∏—Ç "–Ø –°—Ä–∞–±–æ—Ç–∞–ª!"
        //–ö–æ–≥–¥–∞ –≥–¥–µ –ª–∏–±–æ –∫—Ç–æ —Ç–æ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —á—Ç–æ —Ç—É—Ç —Å—Ä–∞–±–æ—Ç–∞–ª –¥–µ–ª–µ–≥–∞—Ç 
        //–Ω–∞—á–∏–Ω–∞–µ—Ç –ª–æ–≥–∏–∫–∞ –∏–∑ –Ω–µ–≥–æ 
        OnColorChanged.Broadcast(NewColor, GetName());
    }
    else
    {
        UE_LOG(LogForTestingNewActor, Display, TEXT("Timer has been stopped!"));

        //–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞, –∫–∞–∫–æ–π —Ç–∞–π–º–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
        GetWorldTimerManager().ClearTimer(TimerHandle);

        //–í—ã–∑–æ–≤ –≤—Ç–æ—Ä–æ–≥–æ –¥–µ–ª–µ–≥–∞—Ç–∞, –∫–æ–≥–¥–∞ —Ç–∞–π–º–µ—Ä –∑–∞–∫–æ–Ω—á–∏–ª —Ä–∞–±–æ—Ç—É
        OnTimerFinished.Broadcast(this);
    }
}

void ATestingNewActor::EndPlay(const EEndPlayReason::Type EndPlayReason)
{
    UE_LOG(LogForTestingNewActor, Error, TEXT("Actor has been destroyed"));
    Super::EndPlay(EndPlayReason);
}

```

baseGeometryActor.h

```cpp
DECLARE_DYNAMIC_MULTICAST_DELEGATE_TwoParams(FOnColorChanged, const FLinearColor&, Color, const FString&, Name);
DECLARE_MULTICAST_DELEGATE_OneParam(FOnTimerFinished, AActor*);

public:	
	// Sets default values for this actor's properties
	ABaseGeometryActor();
	
	UPROPERTY(BlueprintAssignable)
	FOnColorChanged OnColorChanged;

	FOnTimerFinished OnTimerFinished;

```

GeometryHubActor.h

```cpp
private:

	UFUNCTION()
	void OnColorChanged(const FLinearColor& Color, const FString& Name);

	void OnTimerFinished(AActor* Actor);
```

BaseGeometryActor.cpp

```cpp

void ABaseGeometryActor::OnTimerFired()
{
	if (++TimerCount <= MaxTimerCount)
	{
		const FLinearColor NewColor = FLinearColor::MakeRandomColor();
		UE_LOG(LogBaseGeometry, Display, TEXT("TimerCount: %i, Color to set up: %s"), TimerCount, *NewColor.ToString());
		SetColor(NewColor);
		OnColorChanged.Broadcast(NewColor, GetName());
	}
	else
	{
		UE_LOG(LogBaseGeometry, Warning, TEXT("Timer has been stopped!"));
		GetWorldTimerManager().ClearTimer(TimerHandle);
		OnTimerFinished.Broadcast(this);
	}
}


```

GeometryHubActor.cpp

```cpp
void AGeometryHubActor::BeginPlay()
{
	Super::BeginPlay();

	//DoActorSpawn1();
	//DoActorSpawn2();
	DoActorSpawn3();

}


void AGeometryHubActor::DoActorSpawn3()
{
	UWorld* World = GetWorld();
	if (World)
	{
		for (const FGeometryPayload Payload : GeometryPayloads)
		{
			ABaseGeometryActor* Geometry = World->SpawnActorDeferred<ABaseGeometryActor>(Payload.GeometryClass, Payload.InitialTransform);

			if (Geometry)
			{
				Geometry->SetGeometryData(Payload.Data);
				Geometry->OnColorChanged.AddDynamic(this, &AGeometryHubActor::OnColorChanged);
				Geometry->OnTimerFinished.AddUObject(this, &AGeometryHubActor::OnTimerFinished);
				Geometry->FinishSpawning(Payload.InitialTransform);
			}
		}
	}
}

void AGeometryHubActor::OnColorChanged(const FLinearColor& Color, const FString& Name)
{
	UE_LOG(LogGeometryHub, Warning, TEXT("Actor name: %s Color %s"), *Name, *Color.ToString());
}

void AGeometryHubActor::OnTimerFinished(AActor* Actor)
{
	if (!Actor) return;
	UE_LOG(LogGeometryHub, Error, TEXT("Timer finished: %s"), *Actor->GetName());

	ABaseGeometryActor* Geometry = Cast<ABaseGeometryActor>(Actor);
	if (!Geometry) return;

	UE_LOG(LogGeometryHub, Display, TEXT("Cast is success: amplitude %f"), Geometry->GetGeometryData().Amplitude);

	Geometry->Destroy();
	//Geometry->SetLifeSpan(2.0f)
}
```

## GameModeBase
---
### Gameplay Framework

https://dev.epicgames.com/documentation/en-us/unreal-engine/gameplay-framework-in-unreal-engine?application_version=5.4

![[Pasted image 20250513202121.png]]
### Gamemode

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ GameModeBase –∏ –∑–∞–º–µ–Ω–∞ —Ç–∞–º Pawn. –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã

gameCGameModeBase.cpp

```cpp
// Copyright Epic Games, Inc. All Rights Reserved.


#include "gameCGameModeBase.h"
//–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ pawn 
#include "SandboxPawn.h"
#include "SandboxPlayerController.h"

AgameCGameModeBase::AgameCGameModeBase()
{
	//–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç –∫–ª–∞—Å—Å—ã 
	DefaultPawnClass = ASandboxPawn::StaticClass();
	PlayerControllerClass = ASandboxPlayerController::StaticClass();
}
```

gameCGameModeBase.h

```cpp
// Copyright Epic Games, Inc. All Rights Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/GameModeBase.h"
#include "gameCGameModeBase.generated.h"

/**
 * 
 */
UCLASS()
class GAMEC_API AgameCGameModeBase : public AGameModeBase
{
	GENERATED_BODY()
	
	public:
		//–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –¥–ª—è –≥–µ–π–º–º–æ–¥–∞ 
		AgameCGameModeBase();
};

```

–ï—Å–ª–∏ –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ .h —Ñ–∞–π–ª –≤ gamemode, –≤ –∑–∞—Ç–µ–º –≤ –ª—é–±—É—é —Ñ—É–Ω–∫—Ü–∏—é —Ç–æ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∫–∞–∫ –∑–∞—Å–µ—Ç–∞–ø–ª–µ–Ω—ã –≤—Å–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 


```cpp
AGameModeBase::AGameModeBase(const FObjectInitializer& ObjectInitializer)
	: Super(ObjectInitializer.DoNotCreateDefaultSubobject(TEXT("Sprite")))
{
	bNetLoadOnClient = false;
	bPauseable = true;
	bStartPlayersAsSpectators = false;

	DefaultPawnClass = ADefaultPawn::StaticClass();
	PlayerControllerClass = APlayerController::StaticClass();
	PlayerStateClass = APlayerState::StaticClass();
	GameStateClass = AGameStateBase::StaticClass();
	HUDClass = AHUD::StaticClass();
	GameSessionClass = AGameSession::StaticClass();
	SpectatorClass = ASpectatorPawn::StaticClass();
	ReplaySpectatorPlayerControllerClass = APlayerController::StaticClass();
	ServerStatReplicatorClass = AServerStatReplicator::StaticClass();
}
```

![[Pasted image 20241212162503.png]]

## Mapping, Action Mapping, Axis Mapping

![[Pasted image 20241212163003.png]]

–ü—Ä–∏ action mapping - –µ–¥–∏–Ω–∏—á–Ω—ã–π —Ç–∏–∫ 
–ø—Ä–∏ axis mapping - —Ç–∏–∫ –ø–æ–∫–∞ –∫–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞ 

scale –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à–∏ 

## Pawn

pawn documentation
https://dev.epicgames.com/documentation/en-us/unreal-engine/pawn-in-unreal-engine?application_version=5.4

Bind documentation 
https://www.geeksforgeeks.org/bind-function-placeholders-c/

"This" documentation
https://en.cppreference.com/w/cpp/language/this

Input documentation
https://dev.epicgames.com/documentation/en-us/unreal-engine/input-in-unreal-engine?application_version=5.4

SandboxPawn.h
```cpp
// Fill out your copyright notice in the Description page of Project Settings.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Pawn.h"
#include "SandboxPawn.generated.h"

class UCameraComponent;

UCLASS()
class GAMEC_API ASandboxPawn : public APawn
{
	GENERATED_BODY()

public:
	// Sets default values for this pawn's properties
	ASandboxPawn();

	//—Å–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∫–æ—Ä–Ω–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
	//–°–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –º–∏—Ä–µ, –∫ –Ω–µ–º—É –º–æ–∂–Ω–æ –ø—Ä–∏ –∞—Ç–∞—á–∏—Ç—å –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã 
	UPROPERTY(VisibleAnywhere)
	USceneComponent* SceneComponent;

	//–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫ –º–µ—à–∞
	UPROPERTY(VisibleAnywhere)
	UStaticMeshComponent* StaticMeshComponent;

	UPROPERTY(VisibleAnywhere)
	UCameraComponent* CameraComponent;

	//–°–∫–æ—Ä–æ—Å—Ç—å
	UPROPERTY(EditAnywhere)
	float Velocity = 300.0f;

	//–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ pawn
	virtual void PossessedBy(AController* NewController) override;
	virtual void UnPossessed() override;

protected:
	// Called when the game starts or when spawned
	virtual void BeginPlay() override;

public:	
	// Called every frame
	virtual void Tick(float DeltaTime) override;

	// Called to bind functionality to input
	virtual void SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent) override;

private:
	//–í–µ–∫—Ç–æ—Ä —Å–∫–æ—Ä–æ—Å—Ç–∏ pawn 
	//–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω –Ω—É–ª–µ–≤–æ–π
	FVector VelocityVector = FVector::ZeroVector;

	//–§—É–Ω–∫—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è –≤–ø–µ—Ä–µ–¥ –Ω–∞–∑–∞–¥, –ø—Ä–∏–Ω–∏–º–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä
	void MoveForward(float Amount);
	void MoveRight(float Amount);
};

```

SandboxPawn.cpp

```cpp
// Fill out your copyright notice in the Description page of Project Settings.


#include "SandboxPawn.h"
//–æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è 
#include "Components/InputComponent.h"
#include "Components/StaticMeshComponent.h"
#include "Camera/CameraComponent.h"

//—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è pawn 
DEFINE_LOG_CATEGORY_STATIC(LogSandboxPawn, All, All)

// Sets default values
ASandboxPawn::ASandboxPawn()
{
	// Set this pawn to call Tick() every frame.  You can turn this off to improve performance if you don't need it.
	PrimaryActorTick.bCanEverTick = true;

	//–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞, –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –Ω–µ–º—É –ª–æ–≥–∏–∫–∏
	SceneComponent = CreateDefaultSubobject<USceneComponent>("SceneComponent");
	SetRootComponent(SceneComponent);

	//–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫ –º–µ—à –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞  –∫–ª–∞—Å—Å 
	//–∞—Ç–∞—á–∏–º –∫ —Å—Ü–µ–Ω–µ, –±–∞–∑–æ–≤–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å—Ü–µ–Ω—ã
	StaticMeshComponent = CreateDefaultSubobject<UStaticMeshComponent>("StaticMeshComponent");
	StaticMeshComponent->SetupAttachment(GetRootComponent());
	
	//–ø–æ–º–µ–Ω—è—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ 
	//StaticMeshComponent->SetRelativeLocation();

	//–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
	//–∞—Ç–∞—á–∏–º –∫ —Å—Ü–µ–Ω–µ, –±–∞–∑–æ–≤–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å—Ü–µ–Ω—ã
	CameraComponent = CreateDefaultSubobject<UCameraComponent>("CameraComponent");
	CameraComponent->SetupAttachment(GetRootComponent());
}

// Called when the game starts or when spawned
void ASandboxPawn::BeginPlay()
{
	Super::BeginPlay();
	
}

// Called every frame
void ASandboxPawn::Tick(float DeltaTime)
{
	Super::Tick(DeltaTime);

	//–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é tick –º—ã –∏–∑–º–µ–Ω—è–µ–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞—à–µ–≥–æ pawn –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–µ–∫—Ç–æ—Ä–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
	//–µ—Å–ª–∏ –≤–µ–∫—Ç–æ—Ä 0, —Ç–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ –Ω–µ –¥–µ–ª–∞—Ç—å
	//if (!VelocityVector.IsZero() &&IsControlled) –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Ç–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–µ–º —Ç–æ –∏–ª–∏ –Ω–µ—Ç 
	if (!VelocityVector.IsZero())
	{
		//–ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–æ–≤–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –¥–ª—è pawn
		//–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –æ–Ω–∞ –ø–æ —Ñ–æ—Ä–º—É–ª–µ–Ω —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è 
		//r = r0 + vt
		const FVector NewLocation = GetActorLocation() + Velocity * DeltaTime * VelocityVector;
		SetActorLocation(NewLocation);

		//–≤—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–± –≤–º–µ—Å—Ç–æ &&IsControlled, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç. 
		//–æ–±–Ω—É–ª—è—Ç—å –≤–µ–∫—Ç–æ—Ä —Å–∫–æ—Ä–æ—Å—Ç–∏
		VelocityVector = FVector::ZeroVector;
	}
}

// Called to bind functionality to input
//–±–∏–Ω–¥ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
void ASandboxPawn::SetupPlayerInputComponent(UInputComponent* PlayerInputComponent)
{
	Super::SetupPlayerInputComponent(PlayerInputComponent);

	//–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω—É–ª–µ–≤–æ–π —É–∫–∞–∑–∞—Ç–µ–ª—å
	if (PlayerInputComponent)
	{
		//"–±–∏–Ω–¥ –º–∞–ø–ø–∏–Ω–≥–∞" "—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—ä–µ–∫—Ç" "—Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –≤—ã–∑—ã–≤–∞–µ–º –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã"
		PlayerInputComponent->BindAxis("MoveForward", this, &ASandboxPawn::MoveForward);
		PlayerInputComponent->BindAxis("MoveRight", this, &ASandboxPawn::MoveRight);
	}
}

void ASandboxPawn::MoveForward(float Amount)
{
	//UE_LOG(LogSandboxPawn, Display, TEXT("Move forward: %f"), Amount)
	//–∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è
	//–∑–Ω–∞—á–µ–Ω–∏—è –±—É–¥—É—Ç -1, 0, 1
	VelocityVector.X = Amount;
}

void ASandboxPawn::MoveRight(float Amount)
{
	//UE_LOG(LogSandboxPawn, Display, TEXT("Move right: %f"), Amount)
	VelocityVector.Y = Amount;
}

//–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ pawn
void ASandboxPawn::PossessedBy(AController* NewController)
{
	Super::PossessedBy(NewController);

	//–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω—É–ª–µ–≤–æ–π —É–∫–∞–∑–∞—Ç–µ–ª—å
	if (!NewController) return;
	UE_LOG(LogSandboxPawn, Error, TEXT("%s possessed %s"), *GetName(), *NewController->GetName());
}

void ASandboxPawn::UnPossessed()
{
	Super::UnPossessed();

	UE_LOG(LogSandboxPawn, Warning, TEXT("%s unpossessed"), *GetName());
}

```

## Player Controller
---

https://dev.epicgames.com/documentation/en-us/unreal-engine/player-controllers-in-unreal-engine?application_version=5.4

![[Pasted image 20241212233801.png]]

SandboxPlayerController.h

```cpp
// Fill out your copyright notice in the Description page of Project Settings.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/PlayerController.h"
#include "SandboxPlayerController.generated.h"

/**
 * 
 */
UCLASS()
class GAMEC_API ASandboxPlayerController : public APlayerController
{
	GENERATED_BODY()
	

protected:
	//–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
	virtual void SetupInputComponent() override;
	virtual void BeginPlay() override;

private:
	//–ú–∞—Å—Å–∏–≤ —Å–æ –≤—Å–µ–º–∏ pawn –ø–æ –∫–æ—Ç–æ—Ä—ã–º –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è
	UPROPERTY()
	TArray<AActor*> Pawns;

	//–∏–Ω–¥–Ω–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ pawn 
	int32 CurrentPawnIndex = 0;

	void ChangePawn();
};

```

SandboxPlayerController.cpp
```cpp
// Fill out your copyright notice in the Description page of Project Settings.


#include "SandboxPlayerController.h"
#include "Components/InputComponent.h"
//–¥–æ–ø –∫–ª–∞—Å—Å –¥–ª—è UGameplaySatics
#include "Kismet/GameplayStatics.h"
#include "SandboxPawn.h"

DEFINE_LOG_CATEGORY_STATIC(LogSandboxPlayerController, All, All)

//–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏
void ASandboxPlayerController::SetupInputComponent()
{
	Super::SetupInputComponent();

	//–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω—É–ª–µ–≤–æ–π —É–∫–∞–∑–∞—Ç–µ–ª—å
	if (InputComponent)
	{
		//–∑–∞–ø—É—Å–∫ –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏ 
		InputComponent->BindAction("ChangePawn", IE_Pressed, this, &ASandboxPlayerController::ChangePawn);
	}
}

void ASandboxPlayerController::BeginPlay()
{
	Super::BeginPlay();

	//–ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–∫—Ç–æ—Ä–æ–≤ —Å–æ —Å—Ü–µ–Ω—ã ASandboxPawn
	//–º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –∞–∫—Ç–æ—Ä–æ–≤ –≤ –º–∏—Ä–µ ASandboxPawn 
	//–∏–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞–∫—Ç–æ—Ä–∞–º —É SandboxPlayerController –ø–µ—Ä–µ–¥–∞–≤ —Ç—É–¥–∞ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ this
	UGameplayStatics::GetAllActorsOfClass(GetWorld(), ASandboxPawn::StaticClass(), Pawns);
}

//—Ñ—É–Ω–∫—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è pawn
void ASandboxPlayerController::ChangePawn()
{
	//–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ –±–æ–ª—å—à–µ 1 
	if (Pawns.Num() <= 1) return;

	//–∏–∑–º–µ–Ω–µ–Ω–∏–µ pawn –Ω–∞ –æ–¥–Ω–æ–≥–æ –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å—Ü–µ–Ω–µ
	//—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ pawn –∏–∑ –º–∞—Å—Å–∏–≤–∞
	//–∫–∞–∂–¥—ã–π —Ä–∞–∑ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤—ã–π pawn, –º–µ–Ω—è—è –∏–Ω–¥–µ–∫—Å –º–∞—Å—Å–∏–≤–∞
	ASandboxPawn* CurrentPawn = Cast<ASandboxPawn>(Pawns[CurrentPawnIndex]);
	
	//–ø—Ä–∏–±–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å–ª–µ–¥ pawn
	CurrentPawnIndex = (CurrentPawnIndex + 1) % Pawns.Num();
	if (!CurrentPawn) return;

	UE_LOG(LogSandboxPlayerController, Error, TEXT("Change player pawn"));
	Possess(CurrentPawn);
}

```

SandboxPawn.h

```cpp
	virtual void PossessedBy(AController* NewController) override;
	virtual void UnPossessed() override;
```

SandboxPawn.cpp
```cpp
void ASandboxPawn::PossessedBy(AController* NewController)
{
	Super::PossessedBy(NewController);

	if (!NewController) return;
	UE_LOG(LogSandboxPawn, Error, TEXT("%s possessed %s"), *GetName(), *NewController->GetName());
}

void ASandboxPawn::UnPossessed()
{
	Super::UnPossessed();

	UE_LOG(LogSandboxPawn, Warning, TEXT("%s unpossessed"), *GetName());
}
```

```
//
//	EInputEvent
//
UENUM( BlueprintType, meta=(ScriptName="InputEventType"))
enum EInputEvent
{
	IE_Pressed              =0,
	IE_Released             =1,
	IE_Repeat               =2,
	IE_DoubleClick          =3,
	IE_Axis                 =4,
	IE_MAX                  =5,
};
```

–æ—Ç–∫–ª—é—á–∞–µ—Ç —Å–ø–∞–≤–Ω AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è –Ω–µ—É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö pawn

![[Pasted image 20250513193403.png]]

## GetAllActorsOfClass

```cpp
//–¥–æ–ø –∫–ª–∞—Å—Å –¥–ª—è UGameplaySatics
#include "Kismet/GameplayStatics.h"

void ASandboxPlayerController::BeginPlay()
{
	Super::BeginPlay();

	//–ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–∫—Ç–æ—Ä–æ–≤ —Å–æ —Å—Ü–µ–Ω—ã
	UGameplayStatics::GetAllActorsOfClass(GetWorld(), ASandboxPawn::StaticClass(), Pawns);
}
```

## –û–±–∑–æ—Ä –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ Unreal 

![[Pasted image 20250513173222.png]]

![[Pasted image 20250513174305.png]]

```
					UObject 
					/      \ 
				   /        \
			AActor         UActorComponent 
			   |                 | 
			APawn           USceneComponent
				|         UStaticMeshComponent 
		   ACharacter	   UCameraComponent 
								 ...
```

–û—Ç¬†`UObject`¬†–Ω–∞–ø—Ä—è–º—É—é –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è¬†**–æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ**¬†–∫–ª–∞—Å—Å–æ–≤, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏—Ö —Å–∞–º—ã–µ —Ä–∞–∑–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –≤ –¥–≤–∏–∂–∫–µ. –í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ø—Ä–∏–º–µ—Ä–æ–≤:

1. **–ê—Å—Å–µ—Ç—ã (Assets):**¬†–ö–ª–∞—Å—Å—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–µ —Ä–µ—Å—É—Ä—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –≤–∏–¥–∏—à—å –≤ Content Browser. –ò–º –Ω—É–∂–Ω—ã —Å–≤–æ–π—Å—Ç–≤–∞¬†`UObject`¬†–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ.
    
    - `UStaticMesh`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é –º–æ–¥–µ–ª—å (—Å–∞–º –∞—Å—Å–µ—Ç, –Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞ —Å—Ü–µ–Ω–µ).
    - `USkeletalMesh`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–∫–µ–ª–µ—Ç–Ω—É—é –º–æ–¥–µ–ª—å.
    - `UMaterialInterface`,¬†`UMaterial`,¬†`UMaterialInstance`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –∏—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä—ã.
    - `UTexture`,¬†`UTexture2D`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Ç–µ–∫—Å—Ç—É—Ä—ã.
    - `UAnimSequence`,¬†`UAnimMontage`,¬†`UBlendSpace`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∞—Å—Å–µ—Ç—ã.
    - `USoundBase`,¬†`USoundWave`,¬†`USoundCue`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∑–≤—É–∫–æ–≤—ã–µ –∞—Å—Å–µ—Ç—ã.
    - `UBlueprint`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–∞–º –∞—Å—Å–µ—Ç –±–ª—é–ø—Ä–∏–Ω—Ç–∞.
    - `UDataTable`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö.
    - `ULevel`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∞—Å—Å–µ—Ç —É—Ä–æ–≤–Ω—è.
    - `UWorld`: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –º–∏—Ä/—É—Ä–æ–≤–µ–Ω—å (—Ö–æ—Ç—è —á–∞—Å—Ç–æ —Å –Ω–∏–º —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑¬†`GetWorld()`, –µ–≥–æ –∫–ª–∞—Å—Å –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç¬†`UObject`).
2. **–û–±—ä–µ–∫—Ç—ã –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (UMG):**
    
    - `UWidget`: –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ UMG.
    - `UUserWidget`: –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –≤–∏–¥–∂–µ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã —Å–æ–∑–¥–∞–µ—à—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ UMG.
3. **–ü–æ–¥—Å–∏—Å—Ç–µ–º—ã –î–≤–∏–∂–∫–∞ (Engine Subsystems):**¬†–ú–æ–¥—É–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ —Ä–∞–∑–ª–∏—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–≤–∏–∂–∫–∞.
    
    - `UEngineSubsystem`
    - `UGameInstanceSubsystem`
    - `UWorldSubsystem`
    - `ULocalPlayerSubsystem`
4. **–û—Å–Ω–æ–≤–Ω—ã–µ –û–±—ä–µ–∫—Ç—ã –ò–≥—Ä—ã –∏ –î–≤–∏–∂–∫–∞:**
    
    - `UGameInstance`: –û–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–π —Å–µ—Å—Å–∏–∏ –∏–≥—Ä—ã (–¥–∞–∂–µ –ø—Ä–∏ —Å–º–µ–Ω–µ —É—Ä–æ–≤–Ω–µ–π).
    - `UEngine`: –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–≤–∏–∂–∫–∞.
5. **–î–∞–Ω–Ω—ã–µ –∏ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
    
    - `UDataAsset`: –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—Å—Å–µ—Ç–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ.
    - `UDeveloperSettings`: –î–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ Project Settings.
    - `UInputMappingContext`,¬†`UInputAction`: –ö–ª–∞—Å—Å—ã —Å–∏—Å—Ç–µ–º—ã Enhanced Input.
6. **–ò –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ‚Ä¶**¬†–í–∫–ª—é—á–∞—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã, —Ö–µ–ª–ø–µ—Ä—ã, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –¥–≤–∏–∂–∫–∞ –∏ –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω—ã –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏¬†`UObject`.
    

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:**

–õ—é–±–æ–º—É –∫–ª–∞—Å—Å—É –≤ Unreal Engine, –∫–æ—Ç–æ—Ä–æ–º—É —Ç—Ä–µ–±—É–µ—Ç—Å—è:

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é —á–µ—Ä–µ–∑ —Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞ (GC).
- –û—Ç—Ä–∞–∂–µ–Ω–∏–µ (reflection) –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º –∏ —Ñ—É–Ω–∫—Ü–∏—è–º –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–Ω—É–∂–Ω–æ –¥–ª—è Blueprints, —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞, —Å–µ—Ç–∏).
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞).
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –≤ Details –ø–∞–Ω–µ–ª–∏).
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞–∫—Ä–æ—Å–æ–≤¬†`UPROPERTY()`,¬†`UFUNCTION()`,¬†`UCLASS()`,¬†`USTRUCT()`, etc.

–¢–∞–∫ –∂–µ pawn –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å AI 

HUD - –∫–ª–∞—Å—Å manages –¥–ª—è widget 

Spectator class - —ç—Ç–æ –¥–æ–ø –∫–ª–∞—Å—Å –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è, –Ω—É–∂–µ–Ω –∫–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ –±–æ–ª—å—à–µ –Ω–µ –∏–≥—Ä–∞–µ—Ç

Player state class - –∫–ª–∞—Å—Å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞ 

Game state class - –¥–ª—è –º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∏–≥—Ä—ã, —á–µ—Ä–µ–∑ –Ω–µ–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–µ, –æ –∏–≥—Ä–æ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ 

Game Instance Class - –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–π –∏–≥—Ä—ã 

![[Pasted image 20250513174711.png]]

![[Pasted image 20250513174751.png]]

## Modules, Targets, UnrealBuildTool
---
### GameName.Target.cs. UnrealBuildTool

–ü—Ä–∞–≤–∏–ª–∞ –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –±—É–¥–µ—Ç —Å–æ–±—Ä–∞–Ω –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏–≥—Ä—ã. 

```cpp
// Copyright Epic Games, Inc. All Rights Reserved.

using UnrealBuildTool;
using System.Collections.Generic;

public class gameCTarget : TargetRules
{
	public gameCTarget( TargetInfo Target) : base(Target)
	{
		Type = TargetType.Game;
		DefaultBuildSettings = BuildSettingsVersion.V2;
		ExtraModuleNames.AddRange( new string[] { "gameC" } );
	}
}
```

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞. –ó–∞–ø—É—Å–∫–∞–µ—Ç –¥–∞–Ω–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è. –¢–æ –µ—Å—Ç—å –º—ã –º–æ–∂–µ–º —Å–æ–±—Ä–∞—Ç—å –∫–∞–∫–æ–π —Ç–æ —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —ç—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—É

![[Pasted image 20250513194217.png]]

### Module

https://dev.epicgames.com/documentation/en-us/unreal-engine/module-properties-in-unreal-engine?application_version=5.4

–í–µ—Å—å –∫–æ–¥ –¥–≤–∏–∂–∫–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –º–æ–¥—É–ª–µ–π. –ö–∞–∫ –∫–∏—Ä–ø–∏—á–∏–∫–∏. –í –Ω–µ–º –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫–∞—è —Ç–æ –ª–æ–≥–∏–∫–∞ –¥–≤–∏–∂–∫–∞. –ò–ò, —Å–ø–µ—Ü–∏—Ñ–µ–∫—Ç—ã, –∏–Ω—Ç–µ—Ä–µ—Ñ–µ–π—Å

–ù–∞—à –ø—Ä–æ–µ–∫—Ç —Å –∏–≥—Ä–æ–π —Ç–∞–∫ –∂–µ —è–≤–ª—è–µ—Ç—Å—è –º–æ–¥—É–ª–µ–º, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç ModuleRules

–í —Å–ø–∏—Å–∫–µ PublicDependencyModuleNames –≤ –Ω–µ–º —É–∫–∞–∑–∞–Ω—ã –æ—Ç –∫–∞–∫–∏–µ –º–æ–¥—É–ª–µ–π –±—É–¥–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –∑–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–æ–±–∞–≤–ª–µ–Ω—ã 4 –º–æ–¥—É–ª—è –¥–≤–∏–∂–∫–∞


![[Pasted image 20241214200746.png]]

–í –ø–∞–ø–∫–µ runtime –ª–µ–∂–∞—Ç –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –¥–≤–∏–∂–∫–∞ –∏ –∫–∞–∂–¥–∞—è –ø–∞–ø–∫–∞ —è–≤–ª—è–µ—Ç—Å—è –º–æ–¥—É–ª–µ–º 

![[Pasted image 20250513194635.png]]

–í –ø–∞–ø–∫–µ build –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–±–æ—Ä–∫–∞ –º–æ–¥—É–ª—è. –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

![[Pasted image 20250513194729.png]]

## GameName.h  | GameName.cpp


![[Pasted image 20250513194931.png]]

–í —ç—Ç–∏—Ö —Ñ–∞–π–ª–∞—Ö —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π –º–æ–¥—É–ª—å. –¢–æ –µ—Å—Ç—å —Å–∞–º–∞ –∏–≥—Ä–∞ –º–æ–∂–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –º–æ–¥—É–ª–µ–π

.h

```cpp
// Copyright Epic Games, Inc. All Rights Reserved.

#pragma once

#include "CoreMinimal.h"

```

.cpp

```cpp
// Copyright Epic Games, Inc. All Rights Reserved.

#include "gameC.h"
#include "Modules/ModuleManager.h"

IMPLEMENT_PRIMARY_GAME_MODULE( FDefaultGameModuleImpl, gameC, "gameC" );

```

### .uproject 

js file

–î–æ–ø –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π, –≤–µ—Ä—Å–∏–∏ –¥–≤–∏–∂–∫–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏—è

```cpp
{
	"FileVersion": 3,
	"EngineAssociation": "4.26",
	"Category": "",
	"Description": "",
	"Modules": [
		{
			"Name": "gameC",
			"Type": "Runtime",
			"LoadingPhase": "Default",
			"AdditionalDependencies": [
				"Engine"
			]
		}
	]
}
```

### Forward Declaration. Libraries. Precomiped headers. IWYU –ø–æ–¥—Ö–æ–¥

https://dev.epicgames.com/documentation/en-us/unreal-engine/include-what-you-use-iwyu-for-unreal-engine-programming?application_version=5.4

–ó–∞—Ä–∞–Ω–µ–µ –ø—Ä–æ—Ü–µ—Å—Å–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—É —Ñ–∞–π–ª–æ–≤ –∏ –ø–æ—Ç–æ–º –≤—Å—Ç–∞–≤–ª—è—Ç—å –≥–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç 

```cpp
// Copyright Epic Games, Inc. All Rights Reserved.

using UnrealBuildTool;

public class gameC : ModuleRules
{
	public gameC(ReadOnlyTargetRules Target) : base(Target)
	{
		//Precomiped headers usage 
		//–∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è sharedpch —Ñ–∞–π–ª—ã
		//–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 
		//PCHUsage = PCHUsageMode.NoPCHs; 
		PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;
	
		PublicDependencyModuleNames.AddRange(new string[] { "Core", "CoreUObject", "Engine", "InputCore" });

		PrivateDependencyModuleNames.AddRange(new string[] {  });

		// Uncomment if you are using Slate UI
		// PrivateDependencyModuleNames.AddRange(new string[] { "Slate", "SlateCore" });
		
		// Uncomment if you are using online features
		// PrivateDependencyModuleNames.Add("OnlineSubsystem");

		// To include OnlineSubsystemSteam, add it to the plugins section in your uproject file with the Enabled attribute set to true
	}
}
```

–î–∞–Ω–Ω—ã–π —Ñ–∞–π–ª SharedPCHHeaderFile = "Public/EngineSharedPCH.h"; –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∏ –∫–æ–º–ø–∏–ª–∏—Ü–∏–∏ –º–æ–¥—É–ª—è

![[Pasted image 20250513195752.png]]

–í –¥–∞–Ω–Ω–æ–º —Ñ–∞–π–ª–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–∏ –ø—Ä–æ—Ü–µ—Å—Å–∏—Ä–æ–≤–∞–Ω–∏–∏, —ç—Ç–æ —Ñ–∞–π–ª—ã, –∫–æ–¥ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º–µ–Ω—è–µ—Ç—Å—è –æ—á–µ–Ω—å —Ä–µ–¥–∫–æ

![[Pasted image 20250513195848.png]]

### –ü–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ 

https://dev.epicgames.com/documentation/en-us/unreal-engine/API/Runtime/Engine/Components/UStaticMeshComponent?application_version=5.5

![[Pasted image 20250513200600.png]]

![[Pasted image 20250513200617.png]]

### GameNameEditor.Target.cs.

https://dev.epicgames.com/documentation/en-us/unreal-engine/unreal-engine-build-tool-target-reference?application_version=5.4

–ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É –ø–æ–¥ editor —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è editor —Ç–∞—Ä–≥–µ—Ç, –µ—Å–ª–∏ —Ö–æ—Ç–∏–º —Å–æ–∑–¥–∞—Ç—å stand alone —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—ã—á–Ω—ã–π 

–ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —Å–æ–±—Ä–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é –∏–≥—Ä—É, —Ç–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–∏—Ç—å Server.Target.cs

–ü—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –Ω–∞—à –∫–æ–¥ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ dll —Ñ–∞–π–ª—ã

![[Pasted image 20250513202548.png]]

–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è —Ç–æ–∂–µ —Å–æ–∑–¥–∞–Ω—ã dll —Ñ–∞–π–ª—ã –≤  –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–≤–∏–∂–∫–∞. –ö–æ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–Ω—Ä–∏–ª, –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ dll —Ñ–∞–π–ª—ã –≤ –≤–∏–¥–µ –±–∏–Ω–∞—Ä–Ω—ã—Ö –º–æ–¥—É–ª–µ–π. 

–ö–æ–≥–¥–∞ –º—ã —Ö–æ—Ç–∏–º —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –∞–Ω—Ä–∏–ª –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤, —Ç–æ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–¥—É–ª–µ–π –∏ —Å–æ–∑–¥–∞–Ω–∏–µ dll –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –Ω–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ 
 
![[Pasted image 20250513202616.png]]

## –ú–∞–∫—Ä–æ—Å—ã. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ 

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞

–í –∞–Ω—Ä–∏–ª–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è reflection system –∏–ª–∏ —Å–∏—Å—Ç–µ–º–∞ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è 

–° –ø–æ–º–æ—â—å—é –µ–µ –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–ø–∞—Ö, –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ –∏–º–µ–Ω–∏, –ø–æ–ª—É—á–∞—Ç—å –∏–º–µ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –µ–Ω–∞–º–æ–≤, –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –∏—Ç–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–±—Ö–æ–¥–∏—Ç—å –≤—Å–µ –∏–º–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –ø–æ–ª—É—á–∞—Ç—å –∫–∞–∫—É—é —Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∫–ª–∞—Å—Å, –æ–±—ä–µ–∫—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã —Ö–æ—Ç–∏–º —Å–æ–∑–¥–∞—Ç—å

–≠–¥–∏—Ç–æ—Ä 
–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ - –∫–æ–≥–¥–∞ –º—ã —Å–æ–∑–¥–∞–µ–º –∫–∞–∫–∏–µ —Ç–æ –æ–±—ä–µ–∫—Ç–µ –≤–æ –≤—å—é–ø–æ—Ä—Ç–µ –∏–∑–º–µ—è–µ–º –∏—Ö, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —ç–¥–∏—Ç–æ—Ä, –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è. –¢–∞–∫ –∂–µ –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞ —Å —Å–µ—Ç—å—é 

### –®–∞–±–ª–æ–Ω—ã, templates

–í –¥–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ –ª–µ–∂–∞—Ç –≤—Å–µ —à–∞–±–ª–æ–Ω—ã templates 

![[Pasted image 20250513203353.png]]

–µ—Å–ª–∏ –º—ã –æ—Ç–∫—Ä–æ–µ–º —à–∞–±–ª–æ–Ω, —Ç–æ —É–≤–∏–¥–∏—Ç —Ñ–∞–π–ª –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–ª—è –ø–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ –Ω—É–∂–Ω—ã–µ –∏–º–µ–Ω–∞ –∫–ª–∞—Å—Å–æ–≤. –ò –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏—Ç–æ–≥–æ–≤—ã–π —Ñ–∞–π–ª –∫–ª–∞—Å—Å–∞ 

![[Pasted image 20250513203444.png]]

### –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–∏–ª–¥ –ø—Ä–æ–µ–∫—Ç–∞ 

–ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞, UnrealHeaderTool
—ç—Ç–æ —Å–ø–µ—Ü–∏–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –º–∞–∫—Ä–æ—Å—ã –≤ –Ω–∞—à–µ–º –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ 

![[Pasted image 20250513203614.png]]

–ü–µ—Ä–≤–æ–µ —á—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç –æ–Ω –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã .h –∏ –∏—â–µ—Ç –≤ –Ω–∏—Ö .generated.h
–≠—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Ä–∫–µ—Ä–æ–º –¥–ª—è unrealHeaderTool, –æ–Ω –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ –¥–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å. —Ç–µ –≤ –Ω–µ–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π –∞–Ω—Ä–∏–ª —Ç–∏–ø
 
–ó–∞—Ç–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º enum. ustruct, class, upropetry, ufuction –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è reflection system. 

–ß–∞—Å—Ç—å –∫–æ–¥–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ generated.h –û–Ω–∞ –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫–æ–º. –ù–æ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —á—Ç–æ —Å–æ–∑–¥–∞–ª–∏—Å—å –æ–±–µ—Ä—Ç–∫–∏ –≤–æ–∫—Ä—É–≥ property. –ê –µ—Å–ª–∏ –ø–æ–∏—Å–∫–∞—Ç—å —á–ª–µ–Ω –∫–ª–∞—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —è–≤–ª—è–µ—Ç—Å—è propetry (–ø–æ–º–µ—á–µ–Ω–Ω—ã–π UPROPERTY) –º—ã –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–º, –Ω–∏–∫–∞–∫–æ–π –¥–æ–ø –∫–æ–¥ –Ω–µ –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è –Ω–µ–≥–æ

![[Pasted image 20250513204052.png]]

–ü–æ —ç—Ç–æ–º—É –ø—É—Ç–∏ –ª–µ–∂–∞—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, –ø–æ–º–∏–º–æ –Ω–∏—Ö –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Ç–∞–∫ –∂–µ .cpp —Ñ–∞–π–ª—ã. –¢–∞–∫ –∂–µ –¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —á—Ç–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫–æ–º. –ó–Ω–∞—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ 

–¢–∞–∫ –∂–µ –∏—Ö –º–æ–∂–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ —É–¥–∞–ª–∏—Ç—å, –æ–Ω–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å—Å—è —Å –ø–æ–º–æ—â—å—é unreal.headertool


![[Pasted image 20250513204242.png]]

### –ú–∞–∫—Ä–æ—Å 

–ú–∞–∫—Ä–æ—Å –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ (–∏ –≤ C++ –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏) ‚Äî —ç—Ç–æ, –ø–æ —Å—É—Ç–∏,¬†**–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–∏–º—è –º–∞–∫—Ä–æ—Å–∞) –Ω–∞ –∑–∞–¥–∞–Ω–Ω—ã–π –∫–æ–¥ –∏–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ¬†_–¥–æ_¬†–Ω–∞—á–∞–ª–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã.**

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞–∫—Ä–æ—Å–∞:**¬†–¢—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—à—å –º–∞–∫—Ä–æ—Å —Å –ø–æ–º–æ—â—å—é –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞¬†`#define`.
    
    - **–ü—Ä–æ—Å—Ç–æ–π –º–∞–∫—Ä–æ—Å (–æ–±—ä–µ–∫—Ç–Ω—ã–π):**¬†–ó–∞–º–µ–Ω—è–µ—Ç –∏–º—è –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ.
        
        ```c++
        #define PI 3.14159
        #define GREETING "Hello, World!"
        ```
        
    - **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∞–∫—Ä–æ—Å:**¬†–ú–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è, –Ω–æ —ç—Ç–æ –≤—Å–µ –µ—â–µ —Ç–µ–∫—Å—Ç–æ–≤–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞.
        
        ```c++
        #define SQUARE(x) (x * x)
        #define MAX(a, b) ((a) > (b) ? (a) : (b))
        ```
        
2. **–ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥:**¬†–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–∞—á–Ω–µ—Ç —Ä–∞–∑–±–∏—Ä–∞—Ç—å —Ç–≤–æ–π C++ –∫–æ–¥ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ ‚Äì¬†**–ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä**¬†‚Äì –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º—É —Ç–≤–æ–µ–º—É –∫–æ–¥—É.
    
3. **–ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞:**¬†–ö–æ–≥–¥–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –≤—Å—Ç—Ä–µ—á–∞–µ—Ç –∏–º—è –º–∞–∫—Ä–æ—Å–∞, –æ–Ω –∑–∞–º–µ–Ω—è–µ—Ç —ç—Ç–æ –∏–º—è –Ω–∞ —Ç–æ—Ç —Ç–µ–∫—Å—Ç (–∫–æ–¥), –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —É–∫–∞–∑–∞–Ω –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –º–∞–∫—Ä–æ—Å–∞.
    
    - –ï—Å–ª–∏ —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∞–∫—Ä–æ—Å, –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ç–∞–∫–∂–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ —Ç–µ–ª–æ –º–∞–∫—Ä–æ—Å–∞.
4. **–ö–æ–º–ø–∏–ª—è—Ü–∏—è:**¬†–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –≤—ã–ø–æ–ª–Ω–∏–ª –≤—Å–µ –∑–∞–º–µ–Ω—ã, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–π –∫–æ–¥ (—É–∂–µ –±–µ–∑ –º–∞–∫—Ä–æ—Å–æ–≤, –∞ —Å –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º) –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É –¥–ª—è –æ–±—ã—á–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

- **`UCLASS()`,¬†`USTRUCT()`,¬†`UENUM()`:**¬†–≠—Ç–∏ –º–∞–∫—Ä–æ—Å—ã —Å–æ–æ–±—â–∞—é—Ç Unreal Header Tool (UHT), —á—Ç–æ –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –æ—Ç—Ä–∞–∂–µ–Ω–∏—è, —Å–±–æ—Ä–∫–∏ –º—É—Å–æ—Ä–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Blueprints –∏ —Ç.–¥. –¥–ª—è —ç—Ç–∏—Ö –∫–ª–∞—Å—Å–æ–≤, —Å—Ç—Ä—É–∫—Ç—É—Ä –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–π.
- **`UPROPERTY(...)`:**¬†–°–æ–æ–±—â–∞–µ—Ç UHT, —á—Ç–æ —ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–∏–º–æ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –æ—Ç—Ä–∞–∂–µ–Ω–∏—è, —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞, Blueprints, —Å–µ—Ç–∏ –∏ —Ç.–¥., –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
- **`UFUNCTION(...)`:**¬†–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π.
- **`GENERATED_BODY()`,¬†`GENERATED_UCLASS_BODY()`,¬†`GENERATED_USTRUCT_BODY()`:**¬†–≠—Ç–∏ –º–∞–∫—Ä–æ—Å—ã –≤—Å—Ç–∞–≤–ª—è—é—Ç –∫–æ–¥, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UHT, –≤ —Ç–≤–æ–∏ –∫–ª–∞—Å—Å—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
- **`UE_LOG(...)`:**¬†–ú–∞–∫—Ä–æ—Å –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.
- **`check(...)`,¬†`ensure(...)`:**¬†–ú–∞–∫—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ –∞—Å—Å–µ—Ä—Ç–æ–≤.
- **`TEXT(...)`:**¬†–ú–∞–∫—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –ª–∏—Ç–µ—Ä–∞–ª–æ–≤, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö —Å —Ä–∞–∑–Ω—ã–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∞–º–∏ —Å–∏–º–≤–æ–ª–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –≤ UE.
- **`_API`¬†–º–∞–∫—Ä–æ—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä,¬†`MYPROJECT_API`):**¬†–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–∏–º–≤–æ–ª–æ–≤ –∏–∑ DLL, —á—Ç–æ–±—ã –∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö.

### –ú–∞–∫—Ä–æ—Å. NAMEGAME_API

–µ—Å–ª–∏ –ø—Ä–æ–π—Ç–∏ –ø–æ –Ω–µ–º—É, –≤ –Ω–µ–º –µ—Å—Ç—å –¥—Ä—É–≥–æ–π –º–∞–∫—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

![[Pasted image 20250513204514.png]]

—ç–∫—Å–ø–æ—Ä—Ç –ø–æ–¥ windows
—á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –Ω–∞—à –∫–ª–∞—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ dll —Ñ–∞–π–ª 

![[Pasted image 20250513204608.png]]

–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–≥–µ–Ω–∏—Ä–æ–≤–∞—Ç—å stl —Ñ–∞–π–ª 

—Ç–∞–∫ –∂–µ –µ—Å–ª–∏ –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –≤–∏–∑–∞—É–ª –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –∫–∞–∫–æ–π –ø—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è main 

![[Pasted image 20250513204912.png]]


## Garbage Collector
---
Unreal Object Handling

https://dev.epicgames.com/documentation/en-us/unreal-engine/unreal-object-handling-in-unreal-engine?application_version=5.4

–≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –æ—á–∏—â–∞–µ—Ç –ø–∞–º—è—Ç—å. –ö–æ–≥–¥–∞ –∞–∫—Ç–æ—Ä –∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –≤—Å–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ –∫–æ—Ç–æ—Ä—ã–µ –≤–∏–¥–Ω—ã –≤ reflection system –∞–Ω—Ä–∏–ª–∞, —Ç–µ UPROPERTY –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–Ω—É–ª—è—Ç—å—Å—è 


![[Pasted image 20250513222456.png]]

Start

![[Pasted image 20241214221122.png]]

Pressed Enter

![[Pasted image 20241214221133.png]]

Pressed Tab

![[Pasted image 20241214221149.png]]

GeometryHubActor.h

```cpp

private:
	//—ç—Ç–æ—Ç –ª–æ–≥ –Ω–µ –±—É–¥–µ—Ç —Å–æ–±—Ä–∞–Ω —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –º–∞–∫—Ä–æ—Å—É 
	//uproperty –Ω–µ –ø–æ–º–µ—á–µ–Ω –∏–º. –ö–∞–∫ —É–º–Ω—ã–º —É–∫–∞–∑–∞—Ç–µ–ª–µ–º 
	ABaseGeometryActor* NonePropertyActor;
	
	UPROPERTY()
	ABaseGeometryActor* PropertyActor;
	
	void DoActorSpawn4();
};
```

GeometryHubActor.cpp

```cpp
// Called when the game starts or when spawned
void AGeometryHubActor::BeginPlay()
{
	Super::BeginPlay();
	
	DoActorSpawn4();
}

void AGeometryHubActor::DoActorSpawn4()
{
	if (!GetWorld()) return;

	FTransform GeometryTransform = FTransform(FRotator::ZeroRotator, FVector(700.0f, 300.0f, 300.0f));
	NonePropertyActor = GetWorld()->SpawnActorDeferred<ABaseGeometryActor>(GeometryClass, GeometryTransform);

	GeometryTransform = FTransform(FRotator::ZeroRotator, FVector(700.0f, 300.0f, 300.0f));
	PropertyActor = GetWorld()->SpawnActorDeferred<ABaseGeometryActor>(GeometryClass, GeometryTransform);
}

// Called every frame
void AGeometryHubActor::Tick(float DeltaTime)
{
	Super::Tick(DeltaTime);

	UE_LOG(LogGeometryHub, Warning, TEXT("property pointer %i, is valid %i"), PropertyActor !=nullptr, IsValid(PropertyActor));
	UE_LOG(LogGeometryHub, Error, TEXT("none property pointer %i, is valid %i"), NonePropertyActor !=nullptr, IsValid(NonePropertyActor));
}
```

—è —Å–µ–π—á–∞—Å —Å–º–æ—Ç—Ä—é –ª–æ–≥–∏–∫—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–∞–ø–æ–∫ –≤ lyra starter game –æ—Ç —ç–ø–∏–∫–æ–≤ –∏ —Ç–∞–º –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö public private –ø–∞–ø–æ–∫ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. –¢–∞–º —Å—Ä–∞–∑—É –∏–¥—É—Ç –ø–∞–ø–∫–∏ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏, –∏ –≤ —Å–∏—Å—Ç–µ–º–µ —Å—Ä–∞–∑—É –ª–µ–∂–∏—Ç —Ä—è–¥–æ–º –∫–∞–∫ .h —Ç–∞–∫ –∏ .cpp —Ñ–∞–π–ª. –í —Ü–µ–ª–æ–º —ç—Ç–æ —á–∏—Ç–∞–±–µ–ª—å–Ω–µ–µ –∏ —É–¥–æ–±–Ω–µ–µ. –ù–æ –º–µ–Ω—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –ø–æ—á–µ–º—É –∏—Ö –Ω–µ—Ç, –∫–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–∏—Å—Ç–µ–º—É, –∑–∞—á–µ–º –Ω—É–∂–Ω—ã —ç—Ç–∏ —Ç–æ–≥–¥–∞ –≤–æ–æ–±—â–µ –ø–∞–ø–∫–∏, –∏–ª–∏ –≤ –Ω–æ–≤—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞—Ö –∏—Ö –≤–æ–æ–±—â–µ –ø—Ä–æ—Å—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç

## Clang Format 
---

https://dev.epicgames.com/documentation/en-us/unreal-engine/epic-cplusplus-coding-standard-for-unreal-engine?application_version=5.4

ctr+r , ctrl + w

—Ç–æ—á–∫–∏ –∫–∞–∫ –ø—Ä–æ–±–µ–ª—ã 

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–µ—Ä—Å–∏–∏ visual studio –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É clang format –∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ç–æ–∂–µ –≤–∫–ª—é—á–∏—Ç—å –≥–∞–ª–∫—É enable clang format supp

![[Pasted image 20241217135052.png]]

![[Pasted image 20241217135018.png]]

https://clang.llvm.org/docs/ClangFormatStyleOptions.html

```
Language: Cpp
BasedOnStyle: Microsoft
IndentWidth: '4'
UseTab: Never
TabWidth: '6'
BreakBeforeBraces: Allman
ColumnLimit: '140'
AccessModifierOffset: '-4'
SortIncludes: false
AllowShortBlocksOnASingleLine: false
AlignAfterOpenBracket: DontAlign
AllowShortFunctionsOnASingleLine: Inline
PointerAlignment: Left
AllowShortIfStatementsOnASingleLine: true
```

## Gitignore
---
[[Gitignore]]

## ACharacter
---

–ü–µ—Ä—Å–æ–Ω–∞–∂—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±—ã –æ–Ω –±—ã–ª –ø–æ–¥–∫–ª—é—á–µ–Ω –≤ include 

–°–æ–±—Ä–∞—Ç—å —ç—Ç–æ –≤—Å–µ –≤ game mode . –í –≥–µ–π–º –º–æ–¥–µ –Ω–∞–¥–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫–ª–∞—Å—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è player controller –∏ —Å–∞–º –ø–µ—Ä—Å–æ–Ω–∞–∂ character 

–≤ —Å–∞–º–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞—Ö –¥–æ—Å—Ç—É–ø–∞ protected. –ß—Ç–æ –±—ã –¥–æ—á–µ—Ä–Ω–∏–∏ —Ñ–∞–π–ª—ã –º–æ–≥–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É 

.h
```cpp
class UCameraComponent;

protected:
	UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UCameraComponent* CameraComponent;
```
## Build
---

–ì–æ–≤–æ—Ä–∏—Ç –ø—Ä–∏ –±–∏–ª–¥–µ –∏—Å–∫–∞—Ç—å —Ñ–∞–π–ª—ã –≤ —Ç–∞–∫–æ–º –ø—É—Ç–∏ 

```cs
		PublicIncludePaths.AddRange(new string[] { "ShootThemUp/Public/Player" });
```

## Movement Base
---

STUBaseCharacter.h

```cpp
public:	
	private:
      void MoveForward(float Amount);
      void MoveRight(float Amount);
};

```

STUBaseCharacter.cpp

```cpp
void ASTUBaseCharacter::SetupPlayerInputComponent(UInputComponent* PlayerInputComponent)
{
	Super::SetupPlayerInputComponent(PlayerInputComponent);

	PlayerInputComponent->BindAxis("MoveForward", this, &ASTUBaseCharacter::MoveForward);
	PlayerInputComponent->BindAxis("MoveRight", this, &ASTUBaseCharacter::MoveRight);
}

void ASTUBaseCharacter::MoveForward(float Amount) 
{
    AddMovementInput(GetActorForwardVector(), Amount);
}

void ASTUBaseCharacter::MoveRight(float Amount) 
{
    AddMovementInput(GetActorRightVector(), Amount);
}

```

## Camera
---
–ë–∏–Ω–¥ –¥–ª—è –∏–Ω–ø—É—Ç–æ–≤ 


![[Pasted image 20241217150123.png]]
![[Pasted image 20241217161702.png]]

![[Pasted image 20241217161717.png]]

–£–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω–ø—É—Ç, –±–∏–Ω–¥ axis, –∑–∞—Ç–µ–º –∫–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –±–∏–Ω–¥, –Ω–∞ —á—Ç–æ –≤–ª—è–µ—Ç –∏ –∫–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è. 

```cpp
	PlayerInputComponent->BindAxis("MoveForward", this, &ASTUBaseCharacter::MoveForward);
```

Spring arm

.h
```cpp
protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USpringArmComponent* SpringArmComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UCameraComponent* CameraComponent;
```

cpp

```cpp
#include "Camera/CameraComponent.h"
#include "GameFramework/SpringArmComponent.h"

ASTUBaseCharacter::ASTUBaseCharacter()
{
    PrimaryActorTick.bCanEverTick = true;

    SpringArmComponent = CreateDefaultSubobject<USpringArmComponent>("SpringArmComponent");
    SpringArmComponent->SetupAttachment(GetRootComponent());
    SpringArmComponent->bUsePawnControlRotation = true;

    CameraComponent = CreateDefaultSubobject<UCameraComponent>("CameraComponent");
    CameraComponent->SetupAttachment(SpringArmComponent);
}

```

## Jump
---

```cpp
    PlayerInputComponent->BindAction("Jump", IE_Pressed, this, &ASTUBaseCharacter::Jump);
```

![[Pasted image 20241217181452.png]]
![[Pasted image 20241217181502.png]]

![[Pasted image 20241217181512.png]]

## Nitro. Character Movement Component
---

![[Pasted image 20241220171417.png]]

![[Pasted image 20241218220530.png]]

STUBaseCharacter.cpp

–ó–∞–º–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ character movement –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–π. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏ –±–µ–≥–µ 

```cpp
#include "Components/STU_CharacterMovementComponent.h"

// Sets default values
ASTUBaseCharacter::ASTUBaseCharacter(const FObjectInitializer& ObjInit)
	:Super(ObjInit.SetDefaultSubobjectClass<USTU_CharacterMovementComponent>(ACharacter::CharacterMovementComponentName))
{
 //code
}

//–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π 

void ASTUBaseCharacter::MoveForward(float Amount)
{
    IsMovingForward = Amount > 0.0f;
    AddMovementInput(GetActorForwardVector(), Amount);
}

void ASTUBaseCharacter::MoveRight(float Amount)
{
    AddMovementInput(GetActorRightVector(), Amount);
}

void ASTUBaseCharacter::OnStartRunning()
{
    WantsToRun = true;
}
void ASTUBaseCharacter::OnStopRunning()
{
    WantsToRun = false;
}

bool ASTUBaseCharacter::IsRunning() const
{
    return WantsToRun && IsMovingForward && !GetVelocity().IsZero();
}
```

STUBaseCharacter.h

```cpp
public:
    UFUNCTION(BlueprintCallable, Category = "Movement")
    bool IsRunning() const;

private:
    bool WantsToRun = false;
    bool IsMovingForward = false;

    void MoveForward(float Amount);
    void MoveRight(float Amount);

    void OnStartRunning();
    void OnStopRunning();
};
```

.h

—Ñ—É–Ω–∫—Ü–∏—è GetMaxSpeed —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—ã–∑–æ–≤–∞ 

```cpp

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/CharacterMovementComponent.h"
#include "STU_CharacterMovementComponent.generated.h"

UCLASS()
class SHOOTTHEMUP_API USTU_CharacterMovementComponent : public UCharacterMovementComponent
{
    GENERATED_BODY()

public:
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Movement", meta = (ClampMin = "1.5", ClampMax = "10.0"))
    float RunModifier = 2.0f;

    virtual float GetMaxSpeed() const override;
};
```

.cpp

```cpp
#include "Components/STU_CharacterMovementComponent.h"
#include "Player/STUBaseCharacter.h"

float USTU_CharacterMovementComponent::GetMaxSpeed() const 
{
    const float MaxSpeed = Super::GetMaxSpeed();
    const ASTUBaseCharacter* Player = Cast<ASTUBaseCharacter>(GetPawnOwner());
    return Player && Player->IsRunning() ? MaxSpeed * RunModifier: MaxSpeed;
}
```

## Health bar component
---

![[Pasted image 20241220171333.png]]

![[Pasted image 20241220200826.png]]

![[Pasted image 20241220200852.png]]

![[Pasted image 20241220200905.png]]
delete all event tick

STUHealthComponent.h

```cpp
#include "STUHealthComponent.generated.h"

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class SHOOTTHEMUP_API USTUHealthComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    USTUHealthComponent();

    float GetHealth() const { return Health; }

protected:
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Health", meta = (ClampMin = "0", ClampMax = "1000.0"))
    float MaxHealth = 100.0f;

    virtual void BeginPlay() override;

private:
    float Health = 0.0f;
};
```

STUHealthComponent.cpp

```cpp
#include "Components/STUHealthComponent.h"

USTUHealthComponent::USTUHealthComponent()
{
	PrimaryComponentTick.bCanEverTick = false;
}


// Called when the game starts
void USTUHealthComponent::BeginPlay()
{
	Super::BeginPlay();

	Health = MaxHealth;
}
```

STUBaseCharacter.h

```cpp
class USTUHealthComponent;
class UTextRenderComponent;

protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USTUHealthComponent* HealthComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UTextRenderComponent* HealthTextComponent;
```

STUBaseCharacter.cpp

```cpp
#include "Components/STUHealthComponent.h"
#include "Components/TextRenderComponent.h"

// Sets default values
ASTUBaseCharacter::ASTUBaseCharacter(const FObjectInitializer& ObjInit)
    : Super(ObjInit.SetDefaultSubobjectClass<USTU_CharacterMovementComponent>(ACharacter::CharacterMovementComponentName))
{
    HealthComponent = CreateDefaultSubobject<USTUHealthComponent>("HealthComponent");

    HealthTextComponent = CreateDefaultSubobject<UTextRenderComponent>("HealthTextComponent");
    HealthTextComponent->SetupAttachment(GetRootComponent());
}

// Called when the game starts or when spawned
void ASTUBaseCharacter::BeginPlay()
{
    Super::BeginPlay();

    check(HealthComponent);
    check(HealthTextComponent);
}

// Called every frame
void ASTUBaseCharacter::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);

    const auto Health = HealthComponent->GetHealth();
    HealthTextComponent->SetText(FText::FromString(FString::Printf(TEXT("%.0f"), Health)));
}
```

## Check
---

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω –ª–∏ –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –±–∏–ª–¥–µ, –Ω—É–∂–µ–Ω –ª–∏—à—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```cpp
// Called when the game starts or when spawned
void ASTUBaseCharacter::BeginPlay()
{
    Super::BeginPlay();

    check(HealthComponent);
    check(HealthTextComponent);
}
```

https://dev.epicgames.com/documentation/en-us/unreal-engine/asserts-in-unreal-engine?application_version=5.4
## –£–∫–∞–∑–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã 
---

–†–∞–±–æ—Ç–∞–µ—Ç –≤ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –æ—Ç 1,5 - 10.0 

```cpp
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Movement", meta = (ClampMin = "1.5", ClampMax = "10.0"))
    float RunModifier = 2.0f;
```

## TakeDamage
---

character.cpp

```cpp
// Called every frame
void ASTUBaseCharacter::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);

    const auto Health = HealthComponent->GetHealth();
    //–ø–æ–∫–∞–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∞–¥ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º —Ç–µ–∫—Å—Ç–æ–º 
    HealthTextComponent->SetText(FText::FromString(FString::Printf(TEXT("%.0f"), Health)));

    //–Ω–∞–Ω–µ—Å–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ 
    //–∫–æ–ª –≤–æ—Ç —É—Ä–æ–Ω–∞, —É FDamageEvent –µ—Å—Ç—å <class UDamageType>, —Å –Ω–∏–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∏–ø —É—Ä–æ–Ω–∞ 
    //–æ—Ç –Ω–µ–≥–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å –∏ —Å–≤–æ—é –ø—Ä–æ–∏–≥—Ä–æ–≤–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è —É—Ä–æ–Ω–∞ 
    //FRadialDamageParams –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É 
    //–∑–∞—Ç–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ Controller, –∫—Ç–æ –Ω–∞–Ω–µ—Å —É—â–µ—Ä–±, –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å –∏–∑ –∫–∞–∫–æ–π –∫–æ–º–∞–Ω–¥—ã
    //–∫–æ–º—É –Ω–∞–Ω–µ—Å–µ–Ω —É—Ä–æ–Ω, —Å–µ–±–µ this
    TakeDamage(0.1f, FDamageEvent{}, Controller, this);
}
```

–ë–µ—Ä–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é OnTakeDamage

STUHealthComponent.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUHealthComponent.generated.h"

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUHealthComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    USTUHealthComponent();

    //—Ñ—É–∫–Ω—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ health
    float GetHealth() const { return Health; }

protected:
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Health", meta = (ClampMin = "0", ClampMax = "1000.0"))
    float MaxHealth = 100.0f;

    virtual void BeginPlay() override;

private:
    float Health = 0.0f;

    //–±–µ—Ä–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –¥–µ–ª–µ–≥–∞—Ç–∞ OnTakeAnyDamage, –∏—Ö –±–µ—Ä–µ–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    //–∞–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω
    //—É—Ä–æ–Ω
    //—Ç–∏–ø —É—Ä–æ–Ω–∞
    //–∫–∞–∫–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–∞–Ω–µ—Å —É—Ä–æ–Ω
    //–∞–∫—Ç–æ—Ä –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–Ω–µ—Å —É—Ä–æ–Ω
    UFUNCTION()
    void OnTakeAnyDamage(AActor* DamagedActor, float Damage, const class UDamageType* DamageType, class AController* InstigatedBy, AActor* DamageCauser);
};

```

STUHealthComponent.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUHealthComponent.h"
#include "GameFramework/Actor.h"

USTUHealthComponent::USTUHealthComponent()
{
    //tick –Ω–µ –Ω—É–∂–µ–Ω
    PrimaryComponentTick.bCanEverTick = false;
}

// Called when the game starts
void USTUHealthComponent::BeginPlay()
{
    Super::BeginPlay();

    Health = MaxHealth;

    //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç OnTakeAnyDamage
    //–∏ –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ OnTakeAnyDamage
    //ComponentOwner –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
    //–µ—Å–ª–∏ –æ–Ω –Ω–µ –Ω—É–ª–µ–≤–æ–π, –º–æ–∂–µ–º –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç –¥–∞–Ω–Ω–æ–≥–æ –∞–∫—Ç–æ—Ä–∞
    AActor* ComponentOwner = GetOwner();
    if (ComponentOwner)
    {
        ComponentOwner->OnTakeAnyDamage.AddDynamic(this, &USTUHealthComponent::OnTakeAnyDamage);
    }
}

//—ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º –ª—é–±–æ–π —É—Ä–æ–Ω, —Ç–∞–∫ –∫–∞–∫ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç OnTakeAnyDamage
//–∞ –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∞–Ω—Ä–∏–ª–æ–≤—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ TakeDamage
void USTUHealthComponent::OnTakeAnyDamage(AActor* DamagedActor, float Damage, const UDamageType* DamageType, AController* InstigatedBy, AActor* DamageCauser)
{
    //UE_LOG(BaseCharacterLog, Display, TEXT("Damage: %f"), Damage);
    //—É–º–µ–Ω—å—à–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∞ –¥–∞–º–∞–≥
    Health -= Damage;
}
```

## Apply Damage, DebugSphere

.h

```cpp

// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUDevDamageActor.generated.h"

UCLASS()
class STU_API ASTUDevDamageActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ASTUDevDamageActor();

    //–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è xyz
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite)
    USceneComponent* SceneComponent;


    //–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –¥–µ–±–∞–≥
    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    float Radius = 300.0f;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    FColor SphereColor = FColor::Red;

    //–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –¥–∞–º–∞–≥–∞
    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    float Damage = 10.0f;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    bool DoFullDamage = false;

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;

};

```

.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUDevDamageActor.h"
//—Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –º–æ–∂–Ω–æ —Ä–∏—Å–æ–≤–∞—Ç—å –¥–µ–±–∞–≥
#include "DrawDebugHelpers.h"
#include "Kismet/GameplayStatics.h"

DEFINE_LOG_CATEGORY_STATIC(LogDevDamageActor, All, All);


// Sets default values
ASTUDevDamageActor::ASTUDevDamageActor()
{
    // Set this actor to call Tick() every frame.  You can turn this off to improve performance if you don't need it.
    PrimaryActorTick.bCanEverTick = true;

    //–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ xyz —Å—Ü–µ–Ω—ã
    SceneComponent = CreateDefaultSubobject<USceneComponent>("SceneComponent");
    SetRootComponent(SceneComponent);

    //—Å–º–µ—â–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏ –≤–≤–µ—Ä—Ö –Ω–∞ 100
    SceneComponent->SetRelativeLocation(FVector(0.0f, 0.0f, 100.0f));
}

// Called when the game starts or when spawned
void ASTUDevDamageActor::BeginPlay()
{
    Super::BeginPlay();
}

// Called every frame
void ASTUDevDamageActor::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);

    DrawDebugSphere(GetWorld(), GetActorLocation(), Radius, 24, SphereColor);

    //–ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ 
    UGameplayStatics::ApplyRadialDamage(GetWorld(), Damage, GetActorLocation(), Radius, nullptr, {}, this, nullptr, DoFullDamage);

    //UE_LOG(LogDevDamageActor, Display, TEXT("I hit damage: %f"), Damage);

}

```

![[Pasted image 20250515094427.png]]

## UDamageType

.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUDevDamageActor.generated.h"

UCLASS()
class STU_API ASTUDevDamageActor : public AActor
{
    GENERATED_BODY()

public:
    // Sets default values for this actor's properties
    ASTUDevDamageActor();

    //–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è xyz
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite)
    USceneComponent* SceneComponent;


    //–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –¥–µ–±–∞–≥
    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    float Radius = 300.0f;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    FColor SphereColor = FColor::Red;

    //–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –¥–∞–º–∞–≥–∞
    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    float Damage = 10.0f;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    bool DoFullDamage = false;

    //—à–∞–±–ª–æ–Ω–Ω—ã–π –∫–ª–∞—Å—Å DamageType
    //–ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã —É—Ä–æ–Ω–∞
    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    TSubclassOf<UDamageType> DamageType;

protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;

};

```

.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUHealthComponent.h"
#include "GameFramework/Actor.h"
#include "STU/Dev/STUFireDamageType.h"
#include "STU/Dev/STUIceDamageType.h"

DEFINE_LOG_CATEGORY_STATIC(LogHealthComponent, All, All);

USTUHealthComponent::USTUHealthComponent()
{
    //tick –Ω–µ –Ω—É–∂–µ–Ω
    PrimaryComponentTick.bCanEverTick = false;
}

// Called when the game starts
void USTUHealthComponent::BeginPlay()
{
    Super::BeginPlay();

    Health = MaxHealth;

    //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç OnTakeAnyDamage
    //–∏ –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ OnTakeAnyDamage
    //ComponentOwner –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
    //–µ—Å–ª–∏ –æ–Ω –Ω–µ –Ω—É–ª–µ–≤–æ–π, –º–æ–∂–µ–º –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç –¥–∞–Ω–Ω–æ–≥–æ –∞–∫—Ç–æ—Ä–∞
    AActor* ComponentOwner = GetOwner();
    if (ComponentOwner)
    {
        ComponentOwner->OnTakeAnyDamage.AddDynamic(this, &USTUHealthComponent::OnTakeAnyDamage);
    }
}

//—ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º –ª—é–±–æ–π —É—Ä–æ–Ω, —Ç–∞–∫ –∫–∞–∫ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç OnTakeAnyDamage
//–∞ –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∞–Ω—Ä–∏–ª–æ–≤—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ TakeDamage
void USTUHealthComponent::OnTakeAnyDamage(AActor* DamagedActor, float Damage, const UDamageType* DamageType, AController* InstigatedBy, AActor* DamageCauser)
{
    //UE_LOG(LogHealthComponent, Display, TEXT("Damage: %f"), Damage);

    if (DamageType)
    {
        float CurrentDamage = Damage;

        //–ø—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è –ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π DamageType –∫ STUFireDamageType
        //—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å soft class
        if (DamageType->IsA<USTUFireDamageType>())
        {
            //—É–º–µ–Ω—å—à–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∞ –¥–∞–º–∞–≥
            CurrentDamage = Damage + 50.0f;
            Health -= CurrentDamage;
            UE_LOG(LogHealthComponent, Display, TEXT("Fire damage! %f"), CurrentDamage);
        }
        else if (DamageType->IsA<USTUIceDamageType>())
        {
            CurrentDamage = Damage + 50.0f;
            Health -= CurrentDamage;
            UE_LOG(LogHealthComponent, Display, TEXT("Ice damage! %f"), CurrentDamage);
        }
        else
        {
            //–≤–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö, –Ω–æ –ª—É—á—à–µ –≤–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ –¥—Ä—É–≥–æ–π –ª—é–±–æ–π —É—Ä–æ–Ω
            //—Ç–∞–∫ –∫–∞–∫ DamageType –Ω–∞ –≤—Ö–æ–¥–µ –Ω–µ nullptr –≤—Å–µ–≥–¥–∞
            Health -= Damage;
            UE_LOG(LogHealthComponent, Display, TEXT("Damage!!! %f"), Damage);
        }
    }
}
```

## Death, AnimMontage, Delegate in c++ only 

healthcomponent.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUHealthComponent.generated.h"

//–¥–µ–ª–µ–≥–∞—Ç –Ω–∞ —Å–º–µ—Ä—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
DECLARE_MULTICAST_DELEGATE(FOnDeath)
//–¥–µ–ª–µ–≥–∞—Ç, –∫–æ–≥–¥–∞ –º–µ–Ω—è—é—Ç—Å—è –∂–∏–∑–Ω–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
//—Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –ª–æ–≥–∏–∫—É —Å —Ç–∏–∫–∞, –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–æ—Ä–æ–≤—å—è 
DECLARE_MULTICAST_DELEGATE_OneParam(FOnHealthChanged, float)

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUHealthComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    USTUHealthComponent();

    //—Ñ—É–∫–Ω—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ health
    float GetHealth() const { return Health; }

    UFUNCTION(BlueprintCallable)
    bool IsDead() const { return Health <= 0.0f; }

    FOnDeath OnDeath;
    FOnHealthChanged OnHealthChanged;

protected:
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Health", meta = (ClampMin = "0", ClampMax = "1000.0"))
    float MaxHealth = 100.0f;

    virtual void BeginPlay() override;

private:
    float Health = 0.0f;

    //–±–µ—Ä–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –¥–µ–ª–µ–≥–∞—Ç–∞ OnTakeAnyDamage, –∏—Ö –±–µ—Ä–µ–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    //–∞–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω
    //—É—Ä–æ–Ω
    //—Ç–∏–ø —É—Ä–æ–Ω–∞
    //–∫–∞–∫–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–∞–Ω–µ—Å —É—Ä–æ–Ω
    //–∞–∫—Ç–æ—Ä –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–Ω–µ—Å —É—Ä–æ–Ω
    UFUNCTION()
    void OnTakeAnyDamage(AActor* DamagedActor, float Damage, const class UDamageType* DamageType, class AController* InstigatedBy, AActor* DamageCauser);
    };

```

healthcomponent.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUHealthComponent.h"
#include "GameFramework/Actor.h"
//#include "STU/Dev/STUFireDamageType.h"
//#include "STU/Dev/STUIceDamageType.h"

DEFINE_LOG_CATEGORY_STATIC(LogHealthComponent, All, All);

USTUHealthComponent::USTUHealthComponent()
{
    //tick –Ω–µ –Ω—É–∂–µ–Ω
    PrimaryComponentTick.bCanEverTick = false;
}

// Called when the game starts
void USTUHealthComponent::BeginPlay()
{
    Super::BeginPlay();

    Health = MaxHealth;
    //–ø–µ—Ä–≤—ã–π —Ä–∞–∑ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∂–∏–∑–Ω–∏, –ø–æ—ç—Ç–æ–º—É –≤—ã–≤–æ–¥–∏—Ç —ç—Ç–æ—Ç –¥–µ–ª–µ–≥–∞—Ç
    //—á—Ç–æ —É –Ω–∞—Å –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö–ø 
    OnHealthChanged.Broadcast(Health);

    //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç OnTakeAnyDamage
    //–∏ –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ OnTakeAnyDamage
    //ComponentOwner –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
    //–µ—Å–ª–∏ –æ–Ω –Ω–µ –Ω—É–ª–µ–≤–æ–π, –º–æ–∂–µ–º –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç –¥–∞–Ω–Ω–æ–≥–æ –∞–∫—Ç–æ—Ä–∞
    AActor* ComponentOwner = GetOwner();
    if (ComponentOwner)
    {
        ComponentOwner->OnTakeAnyDamage.AddDynamic(this, &USTUHealthComponent::OnTakeAnyDamage);
    }
}

//—ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º –ª—é–±–æ–π —É—Ä–æ–Ω, —Ç–∞–∫ –∫–∞–∫ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç OnTakeAnyDamage
//–∞ –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∞–Ω—Ä–∏–ª–æ–≤—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ TakeDamage
void USTUHealthComponent::OnTakeAnyDamage(AActor* DamagedActor, float Damage, const UDamageType* DamageType, AController* InstigatedBy, AActor* DamageCauser)
{
    //UE_LOG(LogHealthComponent, Display, TEXT("Damage: %f"), Damage);

    //–ï—Å–ª–∏ —É—Ä–æ–Ω –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω –Ω—É–ª—é –ò–õ–ò –ø–µ—Ä—Å–æ–Ω–∞–∂ —É–∂–µ –º–µ—Ä—Ç–≤, —Ç–æ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è
    //–ø–æ–∫–∞ —É—Ä–æ–Ω –µ—Å—Ç—å –∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂ –∂–∏–≤, –Ω–∞–Ω–æ—Å–∏—Ç—å –µ–º—É —É—Ä–æ–Ω –≤ —Ä–∞–∑–º–µ—Ä–µ  
    //—Å–æ–æ–±—â–∏—Ç—å —á—Ç–æ –ø–æ–ª—É—á–µ–Ω —É—Ä–æ–Ω
    if (Damage <= 0.0f || IsDead()) return;

    Health = FMath::Clamp(Health - Damage, 0.0f, MaxHealth);
    OnHealthChanged.Broadcast(Health);
}
```

character.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Character.h"
#include "STUBaseCharacter.generated.h"

//—É–∫–∞–∑—ã–≤–∞–µ–º –∑–∞—Ä–∞–Ω–µ–µ –∫–ª–∞—Å—Å—ã
class UCameraComponent;
class USpringArmComponent;
class USTUHealthComponent;
class UTextRenderComponent;

UCLASS()
class STU_API ASTUBaseCharacter : public ACharacter
{
    GENERATED_BODY()

public:
    // Sets default values for this character's properties
    ASTUBaseCharacter(const FObjectInitializer& ObjInit);

protected:
    //—Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USpringArmComponent* SpringArmComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UCameraComponent* CameraComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USTUHealthComponent* HealthComponent;

    //–ø–æ–∫–∞–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ö–ø —É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UTextRenderComponent* HealthTextComponent;

    UPROPERTY(EditDefaultsOnly, Category = "Animation")
    UAnimMontage* DeathAnimMontage;

    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;

    // Called to bind functionality to input
    virtual void SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent) override;

    UFUNCTION(BlueprintCallable, Category = "Movement")
    bool IsRunning() const;

    UFUNCTION(BlueprintCallable, Category = "Movement")
    float GetMovementDirection() const;

private:
    //–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    bool WantsToRun = false;
    bool IsMovingForward = false;

    //—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã
    void MoveForward(float Amount);
    void MoveRight(float Amount);

    //—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnStartRunning();
    void OnStopRunning();

    //—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ —Å–º–µ—Ä—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnDeath();
     
    //—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ö–ø –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnHealthChanged(float Health);
};

```

character.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUBaseCharacter.h"
#include "Camera/CameraComponent.h"
#include "Components/InputComponent.h"
#include "GameFramework/SpringArmComponent.h"
#include "STU_CharacterMovementComponent.h"
#include "STUHealthComponent.h"
#include "Components/TextRenderComponent.h"

DEFINE_LOG_CATEGORY_STATIC(BaseCharacterLog, All, All);

// Sets default values
ASTUBaseCharacter::ASTUBaseCharacter(const FObjectInitializer& ObjInit)
    : Super(ObjInit.SetDefaultSubobjectClass<USTU_CharacterMovementComponent>(ACharacter::CharacterMovementComponentName))
{
    PrimaryActorTick.bCanEverTick = true;

    SpringArmComponent = CreateDefaultSubobject<USpringArmComponent>("SpringArmComponent");
    SpringArmComponent->SetupAttachment(GetRootComponent());
    SpringArmComponent->bUsePawnControlRotation = true;

    //attach –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É
    CameraComponent = CreateDefaultSubobject<UCameraComponent>("CameraComponent");
    CameraComponent->SetupAttachment(SpringArmComponent);

    HealthComponent = CreateDefaultSubobject<USTUHealthComponent>("HealthComponent");

    HealthTextComponent = CreateDefaultSubobject<UTextRenderComponent>("HealthTextComponent");
    HealthTextComponent->SetupAttachment(GetRootComponent());
}

// Called when the game starts or when spawned
void ASTUBaseCharacter::BeginPlay()
{
    Super::BeginPlay();

    //–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ 0 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ –¥–µ–≤–µ–ª–æ–ø –±–∏–ª–¥–∞–∫
    //–Ω–µ —Å–±–∏–ª–¥–∏—Ç—å—Å—è, –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
    check(HealthComponent);
    check(HealthTextComponent);
    check(GetCharacterMovement());

    OnHealthChanged(HealthComponent->GetHealth());

    //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –≤ –Ω–∞—á–∞–ª–µ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –¥–µ–ª–µ–≥–∞—Ç–æ–≤ 
    //–≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–º–µ—Ç—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –¥–µ–ª–µ–≥–∞—Ç–∞, –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ OnDeath
    //AddUObject —Ç–∞–∫–æ–π –≤—ã–∑–æ–≤ –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –¥–µ–ª–µ–≥–∞—Ç—É, —Ç–æ–ª—å–∫–æ –≤ C++
    HealthComponent->OnDeath.AddUObject(this, &ASTUBaseCharacter::OnDeath);

    //–¥–µ–ª–∞–≥–∞—Ç –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞
    HealthComponent->OnHealthChanged.AddUObject(this, &ASTUBaseCharacter::OnHealthChanged);
}

// Called every frame
void ASTUBaseCharacter::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);
}

void ASTUBaseCharacter::OnDeath()
{
    UE_LOG(BaseCharacterLog, Display, TEXT("Player %s is dead"), *GetName());

    //–ø—Ä–æ–∏–≥—Ä–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
    PlayAnimMontage(DeathAnimMontage);

    //–æ—Å—Ç–∞–Ω–∞–≤–∫–∞ –≤—Å–µ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    GetCharacterMovement()->DisableMovement();

    //—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, —á–µ—Ä–µ–∑ 5 —Å–µ–∫
    SetLifeSpan(5.0f);
}

void ASTUBaseCharacter::OnHealthChanged(float Health)
{
    //–ø–æ–∫–∞–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∞–¥ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º —Ç–µ–∫—Å—Ç–æ–º
    HealthTextComponent->SetText(FText::FromString(FString::Printf(TEXT("%.0f"), Health)));
}

```


![[Pasted image 20250515120830.png]]

![[Pasted image 20250515120821.png]]

–æ—á–µ–Ω—å –≤–∞–∂–Ω–æ —á—Ç–æ –±—ã –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–ª–æ—Ç–∞ –±—ã–ª–æ —Ç–∞–∫–∂–µ –∫–∞–∫ –∏ –º–æ–Ω—Ç–∞–∂–∞ 

![[Pasted image 20250515120856.png]]

![[Pasted image 20250515120923.png]]

–ê–Ω–∏–º –º–æ–Ω—Ç–∞–∂ –≤ –∫–æ–Ω—Ü–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏ –ø–æ–∑–∞ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è 

![[Pasted image 20250515121012.png]]

## Spectator Pawn. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è


```cpp
#include "GameFramework/Controller.h"

void ASTUBaseCharacter::OnDeath()
{
    UE_LOG(BaseCharacterLog, Display, TEXT("Player %s is dead"), *GetName());

    //–ø—Ä–æ–∏–≥—Ä–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
    PlayAnimMontage(DeathAnimMontage);

    //–æ—Å—Ç–∞–Ω–∞–≤–∫–∞ –≤—Å–µ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    GetCharacterMovement()->DisableMovement();

    //—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, —á–µ—Ä–µ–∑ 5 —Å–µ–∫
    SetLifeSpan(5.0f);

    //–ø—Ä–∏ —Å–º–µ—Ä—Ç–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è 
    //–µ—Å–ª–∏ –∑–∞–π—Ç–∏ –ø–æ –ø—É—Ç–∏ controller - ctrl +f ChangeState - f12 -BeginSpectatingState
    //–º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Ç–æ –∫–∞–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è UnPosses() –∏ —É–¥–∞–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π pawn
    if (Controller)
    {
        Controller->ChangeState(NAME_Spectating);
    }
}
```

![[Pasted image 20250515125058.png]]

## AutoHeal

healthComponent.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUHealthComponent.generated.h"

//–¥–µ–ª–µ–≥–∞—Ç –Ω–∞ —Å–º–µ—Ä—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
DECLARE_MULTICAST_DELEGATE(FOnDeath);
//–¥–µ–ª–µ–≥–∞—Ç, –∫–æ–≥–¥–∞ –º–µ–Ω—è—é—Ç—Å—è –∂–∏–∑–Ω–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
//—Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –ª–æ–≥–∏–∫—É —Å —Ç–∏–∫–∞, –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–æ—Ä–æ–≤—å—è
DECLARE_MULTICAST_DELEGATE_OneParam(FOnHealthChanged, float);

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUHealthComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    USTUHealthComponent();

    //—Ñ—É–∫–Ω—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ health
    float GetHealth() const { return Health; }

    UFUNCTION(BlueprintCallable)
    bool IsDead() const { return FMath::IsNearlyZero(Health); }

    FOnDeath OnDeath;
    FOnHealthChanged OnHealthChanged;

protected:
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Health", meta = (ClampMin = "0", ClampMax = "1000.0"))
    float MaxHealth = 100.0f;

    //–≤–∫–ª—é—á–∞—Ç—å –ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Heal")
    bool AutoHeal = true;

    //—á–∞—Å—Ç–æ—Ç–∞ –ø—Ä–∏–±–∞–≤–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Heal", meta = (EditCondition = "AutoHeal"))
    float HealUpdateTime = 0.3f;

    //–∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∑–¥–æ—Ä–æ–≤—å—è
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Heal", meta = (EditCondition = "AutoHeal"))
    float HealDelay = 3.0f;

    //—Å–∫–æ–ª—å–∫–æ –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤—å—è
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Heal", meta = (EditCondition = "AutoHeal"))
    float HealModifier = 1.0f;

    virtual void BeginPlay() override;

private:
    float Health = 0.0f;

    //—Ç–∞–π–º–µ—Ä Heal
    FTimerHandle TimerHeal;

    //–±–µ—Ä–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –¥–µ–ª–µ–≥–∞—Ç–∞ OnTakeAnyDamage, –∏—Ö –±–µ—Ä–µ–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    //–∞–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω
    //—É—Ä–æ–Ω
    //—Ç–∏–ø —É—Ä–æ–Ω–∞
    //–∫–∞–∫–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–∞–Ω–µ—Å —É—Ä–æ–Ω
    //–∞–∫—Ç–æ—Ä –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–Ω–µ—Å —É—Ä–æ–Ω
    UFUNCTION()
    void OnTakeAnyDamage(AActor* DamagedActor, float Damage, const class UDamageType* DamageType, class AController* InstigatedBy, AActor* DamageCauser);

    void OnTimerHeal();
    void SetHealth(float NewHealth);
};

```

healthComponent.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUHealthComponent.h"
#include "GameFramework/Actor.h"

#include "Engine/World.h"
#include "TimerManager.h"
//#include "STU/Dev/STUFireDamageType.h"
//#include "STU/Dev/STUIceDamageType.h"

DEFINE_LOG_CATEGORY_STATIC(LogHealthComponent, All, All);

USTUHealthComponent::USTUHealthComponent()
{
    //tick –Ω–µ –Ω—É–∂–µ–Ω
    PrimaryComponentTick.bCanEverTick = false;
}

// Called when the game starts
void USTUHealthComponent::BeginPlay()
{
    Super::BeginPlay();

    SetHealth(MaxHealth);

    //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç OnTakeAnyDamage
    //–∏ –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ OnTakeAnyDamage
    //ComponentOwner –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
    //–µ—Å–ª–∏ –æ–Ω –Ω–µ –Ω—É–ª–µ–≤–æ–π, –º–æ–∂–µ–º –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç –¥–∞–Ω–Ω–æ–≥–æ –∞–∫—Ç–æ—Ä–∞
    //
    //–†–µ—Ñ–µ—Ä–µ–Ω—Å—ã –Ω–∞ –º–∏—Ä –∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    AActor* ComponentOwner = GetOwner();
    if (ComponentOwner)
    {
        ComponentOwner->OnTakeAnyDamage.AddDynamic(this, &USTUHealthComponent::OnTakeAnyDamage);
    }
}

//—ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º –ª—é–±–æ–π —É—Ä–æ–Ω, —Ç–∞–∫ –∫–∞–∫ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç OnTakeAnyDamage
//–∞ –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∞–Ω—Ä–∏–ª–æ–≤—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ TakeDamage
void USTUHealthComponent::OnTakeAnyDamage(AActor* DamagedActor, float Damage, const UDamageType* DamageType, AController* InstigatedBy, AActor* DamageCauser)
{
    //UE_LOG(LogHealthComponent, Display, TEXT("Damage: %f"), Damage);

    //–ï—Å–ª–∏ —É—Ä–æ–Ω –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω –Ω—É–ª—é –ò–õ–ò –ø–µ—Ä—Å–æ–Ω–∞–∂ —É–∂–µ –º–µ—Ä—Ç–≤, —Ç–æ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è
    //–ø–æ–∫–∞ —É—Ä–æ–Ω –µ—Å—Ç—å –∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂ –∂–∏–≤, –Ω–∞–Ω–æ—Å–∏—Ç—å –µ–º—É —É—Ä–æ–Ω –≤ —Ä–∞–∑–º–µ—Ä–µ
    //—Å–æ–æ–±—â–∏—Ç—å —á—Ç–æ –ø–æ–ª—É—á–µ–Ω —É—Ä–æ–Ω

    if (Damage <= 0.0f || IsDead() || !GetWorld()) return;
    SetHealth(Health - Damage);
    GetWorld()->GetTimerManager().ClearTimer(TimerHeal);

    //–æ–ø–æ–≤–µ—â–∞–µ–º –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ –ø–µ—Ä—Å–æ–Ω–∞–∂ –ø–æ–≥–∏–±
    if (IsDead())
    {
        OnDeath.Broadcast();
    }
    else if (AutoHeal)
    {
        GetWorld()->GetTimerManager().SetTimer(TimerHeal, this, &USTUHealthComponent::OnTimerHeal, HealUpdateTime, true, HealDelay);
    }
}

void USTUHealthComponent::OnTimerHeal()
{
    SetHealth(Health + HealModifier);

    if (FMath::IsNearlyEqual(Health, MaxHealth) && GetWorld())
    {
        GetWorld()->GetTimerManager().ClearTimer(TimerHeal);
    }
}

void USTUHealthComponent::SetHealth(float NewHealth)
{
    Health = FMath::Clamp(NewHealth, 0.0f, MaxHealth);
    OnHealthChanged.Broadcast(Health);
}

```

character.h 

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Character.h"
#include "STUBaseCharacter.generated.h"

//—É–∫–∞–∑—ã–≤–∞–µ–º –∑–∞—Ä–∞–Ω–µ–µ –∫–ª–∞—Å—Å—ã
class UCameraComponent;
class USpringArmComponent;
class USTUHealthComponent;
class UTextRenderComponent;

UCLASS()
class STU_API ASTUBaseCharacter : public ACharacter
{
    GENERATED_BODY()

public:
    // Sets default values for this character's properties
    ASTUBaseCharacter(const FObjectInitializer& ObjInit);

protected:
    //—Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USpringArmComponent* SpringArmComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UCameraComponent* CameraComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USTUHealthComponent* HealthComponent;

    //–ø–æ–∫–∞–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ö–ø —É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UTextRenderComponent* HealthTextComponent;

    UPROPERTY(EditDefaultsOnly, Category = "Animation")
    UAnimMontage* DeathAnimMontage;

    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;

    // Called to bind functionality to input
    virtual void SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent) override;

    UFUNCTION(BlueprintCallable, Category = "Movement")
    bool IsRunning() const;

    UFUNCTION(BlueprintCallable, Category = "Movement")
    float GetMovementDirection() const;

private:
    //–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    bool WantsToRun = false;
    bool IsMovingForward = false;

    //—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã
    void MoveForward(float Amount);
    void MoveRight(float Amount);

    //—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnStartRunning();
    void OnStopRunning();

    //—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ —Å–º–µ—Ä—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnDeath();
     
    //—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ö–ø –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnHealthChanged(float Health);
};

```

character.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUBaseCharacter.h"
#include "Camera/CameraComponent.h"
#include "Components/InputComponent.h"
#include "GameFramework/SpringArmComponent.h"
#include "STU_CharacterMovementComponent.h"
#include "STUHealthComponent.h"
#include "Components/TextRenderComponent.h"
#include "GameFramework/Controller.h"

DEFINE_LOG_CATEGORY_STATIC(BaseCharacterLog, All, All);

// Sets default values
ASTUBaseCharacter::ASTUBaseCharacter(const FObjectInitializer& ObjInit)
    : Super(ObjInit.SetDefaultSubobjectClass<USTU_CharacterMovementComponent>(ACharacter::CharacterMovementComponentName))
{
    PrimaryActorTick.bCanEverTick = true;

    SpringArmComponent = CreateDefaultSubobject<USpringArmComponent>("SpringArmComponent");
    SpringArmComponent->SetupAttachment(GetRootComponent());
    SpringArmComponent->bUsePawnControlRotation = true;

    //attach –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É
    CameraComponent = CreateDefaultSubobject<UCameraComponent>("CameraComponent");
    CameraComponent->SetupAttachment(SpringArmComponent);

    HealthComponent = CreateDefaultSubobject<USTUHealthComponent>("HealthComponent");

    HealthTextComponent = CreateDefaultSubobject<UTextRenderComponent>("HealthTextComponent");
    HealthTextComponent->SetupAttachment(GetRootComponent());
}

// Called when the game starts or when spawned
void ASTUBaseCharacter::BeginPlay()
{
    Super::BeginPlay();

    //–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ 0 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ –¥–µ–≤–µ–ª–æ–ø –±–∏–ª–¥–∞–∫
    //–Ω–µ —Å–±–∏–ª–¥–∏—Ç—å—Å—è, –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
    check(HealthComponent);
    check(HealthTextComponent);
    check(GetCharacterMovement());

    OnHealthChanged(HealthComponent->GetHealth());

    //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –≤ –Ω–∞—á–∞–ª–µ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –¥–µ–ª–µ–≥–∞—Ç–æ–≤
    //–≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–º–µ—Ç—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –¥–µ–ª–µ–≥–∞—Ç–∞, –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ OnDeath
    //AddUObject —Ç–∞–∫–æ–π –≤—ã–∑–æ–≤ –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –¥–µ–ª–µ–≥–∞—Ç—É, —Ç–æ–ª—å–∫–æ –≤ C++
    HealthComponent->OnDeath.AddUObject(this, &ASTUBaseCharacter::OnDeath);

    //–¥–µ–ª–∞–≥–∞—Ç –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞
    HealthComponent->OnHealthChanged.AddUObject(this, &ASTUBaseCharacter::OnHealthChanged);
}


void ASTUBaseCharacter::OnHealthChanged(float Health)
{
    //–ø–æ–∫–∞–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∞–¥ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º —Ç–µ–∫—Å—Ç–æ–º
    HealthTextComponent->SetText(FText::FromString(FString::Printf(TEXT("%.0f"), Health)));
}

// Called every frame
void ASTUBaseCharacter::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);

    //–Ω–∞–Ω–µ—Å–µ–Ω–∏–µ —É—Ä–æ–Ω–∞
    //–∫–æ–ª –≤–æ—Ç —É—Ä–æ–Ω–∞, —É FDamageEvent –µ—Å—Ç—å <class UDamageType>, —Å –Ω–∏–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∏–ø —É—Ä–æ–Ω–∞
    //–æ—Ç –Ω–µ–≥–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å –∏ —Å–≤–æ—é –ø—Ä–æ–∏–≥—Ä–æ–≤–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è —É—Ä–æ–Ω–∞
    //FRadialDamageParams –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É
    //–∑–∞—Ç–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ Controller, –∫—Ç–æ –Ω–∞–Ω–µ—Å —É—â–µ—Ä–±, –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å –∏–∑ –∫–∞–∫–æ–π –∫–æ–º–∞–Ω–¥—ã
    //–∫–æ–º—É –Ω–∞–Ω–µ—Å–µ–Ω —É—Ä–æ–Ω, —Å–µ–±–µ this
    //TakeDamage(0.1f, FDamageEvent{}, Controller, this);
}

// Called to bind functionality to input
void ASTUBaseCharacter::SetupPlayerInputComponent(UInputComponent* PlayerInputComponent)
{
    Super::SetupPlayerInputComponent(PlayerInputComponent);

    if (PlayerInputComponent)
    {
        //–≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏ –∏ –≥–¥–µ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è this
        PlayerInputComponent->BindAxis("MoveForward", this, &ASTUBaseCharacter::MoveForward);
        PlayerInputComponent->BindAxis("MoveRight", this, &ASTUBaseCharacter::MoveRight);
        PlayerInputComponent->BindAxis("LookUp", this, &ASTUBaseCharacter::AddControllerPitchInput);
        PlayerInputComponent->BindAxis("TurnAround", this, &ASTUBaseCharacter::AddControllerYawInput);
        PlayerInputComponent->BindAction("Jump", IE_Pressed, this, &ASTUBaseCharacter::Jump);
        PlayerInputComponent->BindAction("Run", IE_Pressed, this, &ASTUBaseCharacter::OnStartRunning);
        PlayerInputComponent->BindAction("Run", IE_Released, this, &ASTUBaseCharacter::OnStopRunning);
    }
}

void ASTUBaseCharacter::MoveForward(float Amount)
{
    IsMovingForward = Amount > 0.0f;
    AddMovementInput(GetActorForwardVector(), Amount);
}

void ASTUBaseCharacter::MoveRight(float Amount)
{
    if (Amount == 0.0f) return;
    AddMovementInput(GetActorRightVector(), Amount);
}

void ASTUBaseCharacter::OnStartRunning()
{
    WantsToRun = true;
}
void ASTUBaseCharacter::OnStopRunning()
{
    WantsToRun = false;
}

bool ASTUBaseCharacter::IsRunning() const
{
    return WantsToRun && IsMovingForward && !GetVelocity().IsZero();
}

float ASTUBaseCharacter::GetMovementDirection() const
{
    if (GetVelocity().IsZero()) return 0.0f;
    const auto VelocityNormal = GetVelocity().GetSafeNormal();
    const auto AngleBetween = FMath::Acos(FVector::DotProduct(GetActorForwardVector(), VelocityNormal));
    const auto CrossProduct = FVector::CrossProduct(GetActorForwardVector(), VelocityNormal);
    const auto Degrees = FMath::RadiansToDegrees(AngleBetween);
    return CrossProduct.IsZero() ? Degrees : Degrees * FMath::Sign(CrossProduct.Z);
}

void ASTUBaseCharacter::OnDeath()
{
    UE_LOG(BaseCharacterLog, Display, TEXT("Player %s is dead"), *GetName());

    //–ø—Ä–æ–∏–≥—Ä–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
    PlayAnimMontage(DeathAnimMontage);

    //–æ—Å—Ç–∞–Ω–∞–≤–∫–∞ –≤—Å–µ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    GetCharacterMovement()->DisableMovement();

    //—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, —á–µ—Ä–µ–∑ 5 —Å–µ–∫
    SetLifeSpan(5.0f);

    //–ø—Ä–∏ —Å–º–µ—Ä—Ç–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è
    //–µ—Å–ª–∏ –∑–∞–π—Ç–∏ –ø–æ –ø—É—Ç–∏ controller - ctrl +f ChangeState - f12 -BeginSpectatingState
    //–º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Ç–æ –∫–∞–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è UnPosses() –∏ —É–¥–∞–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π pawn
    if (Controller)
    {
        Controller->ChangeState(NAME_Spectating);
    }
}
```

## LandedDelegate, –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è

baseCharacter.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Character.h"
#include "STUBaseCharacter.generated.h"

//—É–∫–∞–∑—ã–≤–∞–µ–º –∑–∞—Ä–∞–Ω–µ–µ –∫–ª–∞—Å—Å—ã
class UCameraComponent;
class USpringArmComponent;
class USTUHealthComponent;
class UTextRenderComponent;

UCLASS()
class STU_API ASTUBaseCharacter : public ACharacter
{
    GENERATED_BODY()

public:
    // Sets default values for this character's properties
    ASTUBaseCharacter(const FObjectInitializer& ObjInit);

protected:
    //—Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USpringArmComponent* SpringArmComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UCameraComponent* CameraComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USTUHealthComponent* HealthComponent;

    //–ø–æ–∫–∞–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ö–ø —É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UTextRenderComponent* HealthTextComponent;

    UPROPERTY(EditDefaultsOnly, Category = "Animation")
    UAnimMontage* DeathAnimMontage;

    //–ø–∞–¥–µ–Ω–∏–µ
    //–º–µ–Ω—å—à–µ 900 —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–∞–¥–µ–Ω–∏—è = 0  —É—Ä–æ–Ω–∞
    //–ø—Ä–∏ 1200 = –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–Ω 
    UPROPERTY(EditDefaultsOnly, Category = "Movement")
    FVector2D LandedDamageVelocity = FVector2D(900.0f, 1200.0f);

    //–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–Ω 
    UPROPERTY(EditDefaultsOnly, Category = "Movement")
    FVector2D LandedDamage = FVector2D(10.0f, 100.0f);

    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;

    // Called to bind functionality to input
    virtual void SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent) override;

    UFUNCTION(BlueprintCallable, Category = "Movement")
    bool IsRunning() const;

    UFUNCTION(BlueprintCallable, Category = "Movement")
    float GetMovementDirection() const;

private:
    //–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    bool WantsToRun = false;
    bool IsMovingForward = false;

    //—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã
    void MoveForward(float Amount);
    void MoveRight(float Amount);

    //—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnStartRunning();
    void OnStopRunning();

    //—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ —Å–º–µ—Ä—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnDeath();
     
    //—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ö–ø –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnHealthChanged(float Health);

    UFUNCTION()
    void OnGroundLanded(const FHitResult& Hit);
};

```

.cpp

```cpp
void ASTUBaseCharacter::OnGroundLanded(const FHitResult& Hit)
{
    //–ª–æ–≥–∏—Ä—É–µ–º —Ç–µ–∫—É—â—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è
    //—Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è –±—É–¥–µ—Ç —Ç–æ—á–Ω–æ —Ç–∞–∫–∞—è –∂–µ –∫–∞–∫ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –ø–æ Z 
    //—Ç–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ Z –±—É–¥–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–µ, –¥–æ –º–Ω–æ–∂–∞–µ–º –Ω–∞ -1
    const auto FallVelocityZ = -GetCharacterMovement()->Velocity.Z;
    UE_LOG(BaseCharacterLog, Display, TEXT("On landed: %f"), FallVelocityZ);

    if (FallVelocityZ < LandedDamageVelocity.X) return;

    //–Ω–∞–Ω–µ—Å–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã—Å–æ—Ç—ã
    const auto FinalDamage = FMath::GetMappedRangeValueClamped(LandedDamageVelocity, LandedDamage, FallVelocityZ);
    UE_LOG(BaseCharacterLog, Display, TEXT("FinalDamage: %f"), FinalDamage);
    TakeDamage(FinalDamage, FDamageEvent{}, nullptr, nullptr);

}
```

## Class Weapon, Spawn Weapon in Hand 

character.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Character.h"
#include "STUBaseCharacter.generated.h"

//—É–∫–∞–∑—ã–≤–∞–µ–º –∑–∞—Ä–∞–Ω–µ–µ –∫–ª–∞—Å—Å—ã
class UCameraComponent;
class USpringArmComponent;
class USTUHealthComponent;
class UTextRenderComponent;
class ASTUBaseWeapon;

UCLASS()
class STU_API ASTUBaseCharacter : public ACharacter
{
    GENERATED_BODY()

public:
    // Sets default values for this character's properties
    ASTUBaseCharacter(const FObjectInitializer& ObjInit);

protected:
    //—Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USpringArmComponent* SpringArmComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UCameraComponent* CameraComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USTUHealthComponent* HealthComponent;

    //–ø–æ–∫–∞–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ö–ø —É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    UTextRenderComponent* HealthTextComponent;

    UPROPERTY(EditDefaultsOnly, Category = "Animation")
    UAnimMontage* DeathAnimMontage;

    //–ø–∞–¥–µ–Ω–∏–µ
    //–º–µ–Ω—å—à–µ 900 —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–∞–¥–µ–Ω–∏—è = 0  —É—Ä–æ–Ω–∞
    //–ø—Ä–∏ 1200 = –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–Ω
    UPROPERTY(EditDefaultsOnly, Category = "Damage")
    FVector2D LandedDamageVelocity = FVector2D(900.0f, 1200.0f);

    //–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–Ω
    UPROPERTY(EditDefaultsOnly, Category = "Damage")
    FVector2D LandedDamage = FVector2D(10.0f, 100.0f);

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    TSubclassOf<ASTUBaseWeapon> WeaponClass;

    // Called when the game starts or when spawned
    virtual void BeginPlay() override;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;

    // Called to bind functionality to input
    virtual void SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent) override;

    UFUNCTION(BlueprintCallable, Category = "Movement")
    bool IsRunning() const;

    UFUNCTION(BlueprintCallable, Category = "Movement")
    float GetMovementDirection() const;

private:
    //–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    bool WantsToRun = false;
    bool IsMovingForward = false;

    //—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã
    void MoveForward(float Amount);
    void MoveRight(float Amount);

    //—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnStartRunning();
    void OnStopRunning();

    //—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ —Å–º–µ—Ä—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnDeath();

    //—Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ö–ø –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    void OnHealthChanged(float Health);

    UFUNCTION()
    void OnGroundLanded(const FHitResult& Hit);

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –ø–µ—Ä—Å–æ–Ω–∞–∂—É
    void SpawnWeapon();
};

```

character.cpp

```cpp
#include "STU/Weapons/STUBaseWeapon.h"

// Called when the game starts or when spawned
void ASTUBaseCharacter::BeginPlay()
{
    Super::BeginPlay();

    //–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ 0 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ –¥–µ–≤–µ–ª–æ–ø –±–∏–ª–¥–∞–∫
    //–Ω–µ —Å–±–∏–ª–¥–∏—Ç—å—Å—è, –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
    check(HealthComponent);
    check(HealthTextComponent);
    check(GetCharacterMovement());

    OnHealthChanged(HealthComponent->GetHealth());

    //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –≤ –Ω–∞—á–∞–ª–µ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –¥–µ–ª–µ–≥–∞—Ç–æ–≤
    //–≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–º–µ—Ç—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –¥–µ–ª–µ–≥–∞—Ç–∞, –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ OnDeath
    //AddUObject —Ç–∞–∫–æ–π –≤—ã–∑–æ–≤ –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –¥–µ–ª–µ–≥–∞—Ç—É, —Ç–æ–ª—å–∫–æ –≤ C++
    HealthComponent->OnDeath.AddUObject(this, &ASTUBaseCharacter::OnDeath);

    //–¥–µ–ª–∞–≥–∞—Ç –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞
    HealthComponent->OnHealthChanged.AddUObject(this, &ASTUBaseCharacter::OnHealthChanged);

    //–ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è
    LandedDelegate.AddDynamic(this, &ASTUBaseCharacter::OnGroundLanded);

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏—è —É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –Ω–∞—á–∞–ª–µ –∏–≥—Ä—ã
    SpawnWeapon();
}

void ASTUBaseCharacter::SpawnWeapon()
{
    //–µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∏—Ä –∏–≥—Ä—ã –Ω–µ –Ω—É–ª–µ–≤–æ–π
    if (!GetWorld()) return;

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏—è
    const auto Weapon = GetWorld()->SpawnActor<ASTUBaseWeapon>(WeaponClass);

    if (Weapon)
    {
        //–∞—Ç—Ç–∞—á –∫ –º–µ—à—É, —Ä—É–∫–µ
        FAttachmentTransformRules AttachmentRules(EAttachmentRule::SnapToTarget, false);
        Weapon->AttachToComponent(GetMesh(), AttachmentRules, "WeaponSocket");
    }
}
```

weapon.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUBaseWeapon.h"
#include "Components/SkeletalMeshComponent.h"

ASTUBaseWeapon::ASTUBaseWeapon()
{
    PrimaryActorTick.bCanEverTick = false;

    WeaponMesh = CreateDefaultSubobject<USkeletalMeshComponent>("WeaponMesh");
    SetRootComponent(WeaponMesh);
}

void ASTUBaseWeapon::BeginPlay()
{
    Super::BeginPlay();
}

```

weapon.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUBaseWeapon.generated.h"

class USkeletalMeshComponent;

UCLASS()
class STU_API ASTUBaseWeapon : public AActor
{
    GENERATED_BODY()

public:
    ASTUBaseWeapon();

protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USkeletalMeshComponent* WeaponMesh;

    virtual void BeginPlay() override;
};

```

## class AHUD, –ø—Ä–∏—Ü–µ–ª, crosshair

Head Up Display 

.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/HUD.h"
#include "STUGameHUD.generated.h"

/**
 * 
 */
UCLASS()
class STU_API ASTUGameHUD : public AHUD
{
    GENERATED_BODY()

public:
    virtual void DrawHUD() override;

private:
    void DrawCrossHair();
};

```

.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.


#include "STUGameHUD.h"
#include "Engine/Canvas.h"

//–ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ 
void ASTUGameHUD::DrawHUD()
{
    //–≤—ã–∑–æ–≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    Super::DrawHUD();

    DrawCrossHair();
}

void ASTUGameHUD::DrawCrossHair()
{
    //—Ä–∏—Å–æ–≤–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ
    const TInterval<float> Center(Canvas->SizeX * 0.5f, Canvas->SizeY * 0.5f);

    //–ø–æ–ª–æ–≤–∏–Ω–∫–∏ –≤–ª–µ–≤–æ, –≤–ø—Ä–∞–≤–æ, –≤–≤–µ—Ä—Ö, –≤–Ω–∏–∑
    const float HalfLineSize = 10.0f;
    const float LineThickness = 2.0f;
    const FLinearColor LineColor = FLinearColor::Green;

    //—Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è —É–º–µ–µ—Ç —Ä–∏—Å–æ–≤–∞—Ç—å –ª–∏–Ω–∏–∏ 
    //–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è 
    DrawLine(Center.Min - HalfLineSize, Center.Max, Center.Min + HalfLineSize, Center.Max, LineColor, LineThickness);

    //–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
    DrawLine(Center.Min, Center.Max - HalfLineSize, Center.Min, Center.Max + HalfLineSize, LineColor, LineThickness);
}

```

gamemode.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUGameModeBase.h"
#include "STU/Character/STUBaseCharacter.h"
#include "STU/Player/STUPlayerController.h"
#include "STU/UI/STUGameHUD.h"

ASTUGameModeBase::ASTUGameModeBase()
{
    DefaultPawnClass = ASTUBaseCharacter::StaticClass();
    PlayerControllerClass = ASTUPlayerController::StaticClass();
    HUDClass = ASTUGameHUD::StaticClass();
}
```

## UWeaponComponent. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ä—É–∂–∏—è 

STUBaseCharacter.h

```cpp
class USTUWeaponComponent;

protected
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USTUWeaponComponent* WeaponComponent;


```

STUBaseCharacter.cpp

```cpp
#include "STU/Character/STUWeaponComponent.h"


// Sets default values
ASTUBaseCharacter::ASTUBaseCharacter(const FObjectInitializer& ObjInit)
    : Super(ObjInit.SetDefaultSubobjectClass<USTU_CharacterMovementComponent>(ACharacter::CharacterMovementComponentName))
{
    PrimaryActorTick.bCanEverTick = true;

    WeaponComponent = CreateDefaultSubobject<USTUWeaponComponent>("WeaponComponent");
}

// Called to bind functionality to input
void ASTUBaseCharacter::SetupPlayerInputComponent(UInputComponent* PlayerInputComponent)
{
    Super::SetupPlayerInputComponent(PlayerInputComponent);

    check(PlayerInputComponent);
    check(WeaponComponent);
    PlayerInputComponent->BindAction("Fire", IE_Pressed, WeaponComponent, &USTUWeaponComponent::Fire);

}
```

STUBaseWeapon.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUBaseWeapon.generated.h"

class USkeletalMeshComponent;

UCLASS()
class STU_API ASTUBaseWeapon : public AActor
{
    GENERATED_BODY()

public:
    ASTUBaseWeapon();

    virtual void Fire();

protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USkeletalMeshComponent* WeaponMesh;

    virtual void BeginPlay() override;
};

```

STUBaseWeapon.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUBaseWeapon.h"
#include "Components/SkeletalMeshComponent.h"

DEFINE_LOG_CATEGORY_STATIC(LogBaseWeapon, All, All);


ASTUBaseWeapon::ASTUBaseWeapon()
{
    PrimaryActorTick.bCanEverTick = false;

    WeaponMesh = CreateDefaultSubobject<USkeletalMeshComponent>("WeaponMesh");
    SetRootComponent(WeaponMesh);
}

void ASTUBaseWeapon::BeginPlay()
{
    Super::BeginPlay();
}

void ASTUBaseWeapon::Fire()
{
    UE_LOG(LogBaseWeapon, Display, TEXT("Fire!"))
}

```

weaponComponent.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUWeaponComponent.generated.h"

class ASTUBaseWeapon;

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUWeaponComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    // Sets default values for this component's properties
    USTUWeaponComponent();

    void Fire();

protected:
    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    TSubclassOf<ASTUBaseWeapon> WeaponClass;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponAttachPointName = "WeaponSocket";

    // Called when the game starts
    virtual void BeginPlay() override;

private:
    UPROPERTY()
    ASTUBaseWeapon* CurrentWeapon = nullptr;

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –ø–µ—Ä—Å–æ–Ω–∞–∂—É
    void SpawnWeapon();
};

```

weaponComponent.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUWeaponComponent.h"
#include "STU/Weapons/STUBaseWeapon.h"
#include "GameFramework/Character.h"

DEFINE_LOG_CATEGORY_STATIC(WeaponComponentLog, All, All);

USTUWeaponComponent::USTUWeaponComponent()
{

    PrimaryComponentTick.bCanEverTick = false;
}

void USTUWeaponComponent::BeginPlay()
{
    Super::BeginPlay();

    SpawnWeapon();
}

void USTUWeaponComponent::SpawnWeapon()
{
    //–µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∏—Ä –∏–≥—Ä—ã –Ω–µ –Ω—É–ª–µ–≤–æ–π
    if (!GetWorld()) return;
    UE_LOG(WeaponComponentLog, Display, TEXT("World is find!"));

    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;
    UE_LOG(WeaponComponentLog, Display, TEXT("Character is find!"));

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏—è
    CurrentWeapon = GetWorld()->SpawnActor<ASTUBaseWeapon>(WeaponClass);
    if (!CurrentWeapon) return;
    UE_LOG(WeaponComponentLog, Display, TEXT("CurrentWeapon is find!"));

    //–∞—Ç—Ç–∞—á –∫ –º–µ—à—É, —Ä—É–∫–µ
    FAttachmentTransformRules AttachmentRules(EAttachmentRule::SnapToTarget, false);
    CurrentWeapon->AttachToComponent(Character->GetMesh(), AttachmentRules, WeaponAttachPointName);
    UE_LOG(WeaponComponentLog, Display, TEXT("Weapon is attached!"));
}

void USTUWeaponComponent::Fire()
{
    if (!CurrentWeapon) return;

    //–µ—Å–ª–∏ –µ—Å—Ç—å –æ—Ä—É–∂–∏–µ, —Ç–æ –≤—ã–∑–æ–≤ –∏–∑ ASTUBaseWeapon Fire
    CurrentWeapon->Fire();
}
```

## Collision, Console Command 

### Console command collision

```
stat fps
stat none 

show collision 

```

### Collsion settings


![[Pasted image 20250517115401.png]]

### Camera collsion

–≠—Ç–æ –∏ —É camera collsion –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã—Å—Ç–∞–≤–∏—Ç—å 

![[Pasted image 20250517115338.png]]

### –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –∞–∫—Ç–æ—Ä–æ–≤, –∏—Ö –ø–æ–∫–∞–∑ 

![[Pasted image 20250517115510.png]]

![[Pasted image 20250517115438.png]]

![[Pasted image 20250517115457.png]]

### –°–æ–±—ã—Ç–∏—è –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–µ –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ 

![[Pasted image 20250517115611.png]]

![[Pasted image 20250517115651.png]]

### –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–∞ –∫–æ–ª–ª–∏–∑–∏–∏

![[Pasted image 20250517115853.png]]

obj channel 

setting chanel 

![[Pasted image 20250517115914.png]]

## Line trace 

### Line trace 

baseWeapon.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUBaseWeapon.generated.h"

class USkeletalMeshComponent;

UCLASS()
class STU_API ASTUBaseWeapon : public AActor
{
    GENERATED_BODY()

public:
    ASTUBaseWeapon();

    virtual void Fire();

protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USkeletalMeshComponent* WeaponMesh;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite)
    FName MuzzleSocketName = "MuzzleSocket";

    //–¥–∞–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–µ–ª—å–±—ã 
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite)
    float TraceMaxDistance = 1500.0f;

    virtual void BeginPlay() override;

    void MakeShot();
};

```

baseWeapon.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUBaseWeapon.h"
#include "Components/SkeletalMeshComponent.h"
#include "Engine/World.h"
#include "DrawDebugHelpers.h"
#include "GameFramework/Character.h"
#include "GameFramework/Controller.h"

DEFINE_LOG_CATEGORY_STATIC(LogBaseWeapon, All, All);

ASTUBaseWeapon::ASTUBaseWeapon()
{
    PrimaryActorTick.bCanEverTick = false;

    WeaponMesh = CreateDefaultSubobject<USkeletalMeshComponent>("WeaponMesh");
    SetRootComponent(WeaponMesh);
}

void ASTUBaseWeapon::BeginPlay()
{
    Super::BeginPlay();

    check(WeaponMesh);
}

void ASTUBaseWeapon::Fire()
{
    UE_LOG(LogBaseWeapon, Display, TEXT("Fire!"))

    MakeShot();
}

//–≤—ã—Å—Ç—Ä–µ–ª
void ASTUBaseWeapon::MakeShot()
{
    if (!GetWorld()) return;

    const auto Player = Cast<ACharacter>(GetOwner());

    //–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω—É–ª–µ–≤–æ–π —É–∫–∞–∑–∞—Ç–µ–ª—å
    //–æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω —Ä–∞–≤–Ω—è—Ç—å—Å—è nullptr
    if (!Player) return;

    const auto Controller = Player->GetController<APlayerController>();
    if (!Controller) return;

    FVector ViewLocation;
    FRotator ViewRotation;
    Controller->GetPlayerViewPoint(ViewLocation, ViewRotation);

    //—Ä–∏—Å–æ–≤–∞–Ω–∏–µ –ª—É—á–∞ –∏–∑ —Å–æ–∫–µ—Ç–∞ –≤–ø–µ—Ä–µ–¥

    //–±–µ—Ä–µ–º –ª–æ–∫–∞—Ü–∏—é —Å–æ–∫–µ—Ç–∞ –∏ –ø—Ä–∏—Å–≤–∞–µ–≤–∞–µ–º –≤ –Ω–∞—á–∞–ª–æ
    const FTransform SocketTransform = WeaponMesh->GetSocketTransform(MuzzleSocketName);
    //–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç—Ç–æ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    const FVector TraceStart = ViewLocation; //SocketTransform.GetLocation();

    //–±–µ—Ä–µ–º forward vector –∏–∑ —Å–æ–∫–µ—Ç–∞ –∏–ª–∏ –Ω–∞—á–∞–ª–∞
    //–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ –≤ –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É —Å—Ç—Ä–µ–ª—å–±–∞ –∏–¥–µ—Ç
    const FVector ShootDirection = ViewRotation.Vector(); // SocketTransform.GetRotation().GetForwardVector();

    //–¥–ª—è —Ç–æ—á–∫–∏ –∫–æ–Ω—Ü–∞ –±–µ—Ä–µ–º –Ω–∞—á–∞–ª–æ + –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ —Å –¥–æ–º–Ω–æ–∂–µ–Ω–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–µ–π (1500 –µ–¥)
    const FVector TraceEnd = TraceStart + ShootDirection * TraceMaxDistance;

    //–∞–∫—Ç–æ—Ä—ã –¥–ª—è –∏–≥–Ω–æ—Ä–∞
    FCollisionQueryParams CollisionParams;
    CollisionParams.AddIgnoredActor(GetOwner());

    //–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ
    //–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ HitResult
    //–±–ª–æ–∫–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    FHitResult HitResult;
    GetWorld()->LineTraceSingleByChannel(HitResult, TraceStart, TraceEnd, ECollisionChannel::ECC_Visibility, CollisionParams);

    if (HitResult.bBlockingHit)
    {
        //—Ä–∏—Å—É–µ–º –ª–∏–Ω–∏—é
        //persistance - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑
        DrawDebugLine(GetWorld(), SocketTransform.GetLocation(), HitResult.ImpactPoint, FColor::Red, false, 5.0f, 0, 3.0f);

        //—Ä–∏—Å–æ–≤–∞–Ω–∏–µ —Å—Ñ–µ—Ä—ã –≤ —Ç–æ—á–∫–∏ –ø–æ–ø–∞–¥–∞–Ω–∏—è
        DrawDebugSphere(GetWorld(), HitResult.ImpactPoint, 10.0f, 24, FColor::Red, false, 5.0f);

        //–≤—ã–≤–æ–¥ –∫–æ—Å—Ç–∏ –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ–ø–∞–ª–∏
        UE_LOG(LogBaseWeapon, Display, TEXT("Bone: %s"), *HitResult.BoneName.ToString());
    }
    else
    {
        //—Ä–∏—Å—É–µ–º –ª–∏–Ω–∏—é
        //persistance - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑
        DrawDebugLine(GetWorld(), SocketTransform.GetLocation(), TraceEnd, FColor::Red, false, 5.0f, 0, 3.0f);
    }
}
```
### —á—Ç–æ –±—ã —Ç—Ä–µ–π—Å –±–∏–ª —Ç–æ—á–Ω–æ –ø–æ –º–µ—à—É –æ–±—ä–µ–∫—Ç–∞, –∞ –Ω–µ –ø–æ –∫–∞–ø—Å—É–ª–µ

CapsuleTrace 

![[Pasted image 20250517160634.png]]

Mesh

visible - block

![[Pasted image 20250517160705.png]]

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ 

—ç—Ç–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —Å –∂–µ–ª–∞–Ω–∏–µ–º —Ä–∞–∑–±–∏—Ç—å –µ–≥–æ –Ω–∞ —á–∞—Å—Ç–∏ –∏ —Å–¥–µ–ª–∞—Ç—å –±–æ–ª–µ–µ —á–∏—Ç–∞–±–µ–ª—å–Ω—ã–º 

.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUBaseWeapon.generated.h"

class USkeletalMeshComponent;

UCLASS()
class STU_API ASTUBaseWeapon : public AActor
{
    GENERATED_BODY()

public:
    ASTUBaseWeapon();

    virtual void Fire();

protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USkeletalMeshComponent* WeaponMesh;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite)
    FName MuzzleSocketName = "MuzzleSocket";

    //–¥–∞–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–µ–ª—å–±—ã
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite)
    float TraceMaxDistance = 1500.0f;

    virtual void BeginPlay() override;

    void MakeShot();

    APlayerController* GetPlayerController() const;
    bool GetPlayerViewPoint(FVector& ViewLocation, FRotator& ViewRotation) const;
    FVector GetMuzzleWorldLocation() const;
    bool GetTraceData(FVector& TraceStart, FVector& TraceEnd) const;
    void MakeHit(FHitResult& HitResult, const FVector& TraceStart, const FVector& TraceEnd);
};

```

.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUBaseWeapon.h"
#include "Components/SkeletalMeshComponent.h"
#include "Engine/World.h"
#include "DrawDebugHelpers.h"
#include "GameFramework/Character.h"
#include "GameFramework/Controller.h"

DEFINE_LOG_CATEGORY_STATIC(LogBaseWeapon, All, All);

ASTUBaseWeapon::ASTUBaseWeapon()
{
    PrimaryActorTick.bCanEverTick = false;

    WeaponMesh = CreateDefaultSubobject<USkeletalMeshComponent>("WeaponMesh");
    SetRootComponent(WeaponMesh);
}

void ASTUBaseWeapon::BeginPlay()
{
    Super::BeginPlay();

    check(WeaponMesh);
}

void ASTUBaseWeapon::Fire()
{
    //UE_LOG(LogBaseWeapon, Display, TEXT("Fire!"))

    MakeShot();
}

//–≤—ã—Å—Ç—Ä–µ–ª
void ASTUBaseWeapon::MakeShot()
{
    if (!GetWorld()) return;

    FVector TraceStart, TraceEnd;
    if (!GetTraceData(TraceStart, TraceEnd)) return;

    FHitResult HitResult;
    MakeHit(HitResult, TraceStart, TraceEnd);

    if (HitResult.bBlockingHit)
    {
        //—Ä–∏—Å—É–µ–º –ª–∏–Ω–∏—é
        //persistance - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑
        DrawDebugLine(GetWorld(), GetMuzzleWorldLocation(), HitResult.ImpactPoint, FColor::Red, false, 5.0f, 0, 3.0f);

        //—Ä–∏—Å–æ–≤–∞–Ω–∏–µ —Å—Ñ–µ—Ä—ã –≤ —Ç–æ—á–∫–∏ –ø–æ–ø–∞–¥–∞–Ω–∏—è
        DrawDebugSphere(GetWorld(), HitResult.ImpactPoint, 10.0f, 24, FColor::Red, false, 5.0f);

        //–≤—ã–≤–æ–¥ –∫–æ—Å—Ç–∏ –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ–ø–∞–ª–∏
        UE_LOG(LogBaseWeapon, Display, TEXT("Bone: %s"), *HitResult.BoneName.ToString());
    }
    else
    {
        //—Ä–∏—Å—É–µ–º –ª–∏–Ω–∏—é
        //persistance - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑
        DrawDebugLine(GetWorld(), GetMuzzleWorldLocation(), TraceEnd, FColor::Red, false, 5.0f, 0, 3.0f);
    }
}

//—Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
APlayerController* ASTUBaseWeapon::GetPlayerController() const
{
    const auto Player = Cast<ACharacter>(GetOwner());
    if (!Player) return nullptr;

    return Player->GetController<APlayerController>();
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ ViewPoint player
bool ASTUBaseWeapon::GetPlayerViewPoint(FVector& ViewLocation, FRotator& ViewRotation) const
{
    const auto Controller = GetPlayerController();
    if (!Controller) return false;

    Controller->GetPlayerViewPoint(ViewLocation, ViewRotation);
    return true;
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–æ–∫–µ—Ç–∞
FVector ASTUBaseWeapon::GetMuzzleWorldLocation() const
{
    return WeaponMesh->GetSocketLocation(MuzzleSocketName);
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è trace
bool ASTUBaseWeapon::GetTraceData(FVector& TraceStart, FVector& TraceEnd) const
{
    FVector ViewLocation;
    FRotator ViewRotation;
    if (!GetPlayerViewPoint(ViewLocation, ViewRotation)) return false;

    //–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç—Ç–æ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    TraceStart = ViewLocation;

    //–±–µ—Ä–µ–º forward vector –∏–∑ —Å–æ–∫–µ—Ç–∞ –∏–ª–∏ –Ω–∞—á–∞–ª–∞
    //–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ –≤ –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É —Å—Ç—Ä–µ–ª—å–±–∞ –∏–¥–µ—Ç
    const FVector ShootDirection = ViewRotation.Vector();

    //–¥–ª—è —Ç–æ—á–∫–∏ –∫–æ–Ω—Ü–∞ –±–µ—Ä–µ–º –Ω–∞—á–∞–ª–æ + –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ —Å –¥–æ–º–Ω–æ–∂–µ–Ω–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–µ–π (1500 –µ–¥)
    TraceEnd = TraceStart + ShootDirection * TraceMaxDistance;
    return true;
}

//—Ñ—É–Ω–∫—Ü–∏—è —Ç—Ä–µ–π—Å–∞
void ASTUBaseWeapon::MakeHit(FHitResult& HitResult, const FVector& TraceStart, const FVector& TraceEnd)
{
    if (!GetWorld()) return;

    //–∞–∫—Ç–æ—Ä—ã –¥–ª—è –∏–≥–Ω–æ—Ä–∞
    FCollisionQueryParams CollisionParams;
    CollisionParams.AddIgnoredActor(GetOwner());

    //–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ
    //–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ HitResult
    //–±–ª–æ–∫–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    GetWorld()->LineTraceSingleByChannel(HitResult, TraceStart, TraceEnd, ECollisionChannel::ECC_Visibility, CollisionParams);
}
```

## –ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –≤—Ä–∞–≥–æ–≤ 

–ö–æ–≥–¥–∞ —Ç—Ä–µ–π—Å –ø–æ–ø–∞–¥–∞–µ—Ç –ø–æ –≤—Ä–∞–≥—É
–£ –≤—Ä–∞–≥–∞ –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ –¥–µ–ª–µ–≥–∞—Ç TakeDamage 
–í—Ä–∞–≥ –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∞—Ç—å —É—Ä–æ–Ω
–ò —Å–º–µ—Ä—Ç—å –≤—Ä–∞–≥–∞ 

.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUBaseWeapon.generated.h"

class USkeletalMeshComponent;

UCLASS()
class STU_API ASTUBaseWeapon : public AActor
{
    GENERATED_BODY()

public:
    ASTUBaseWeapon();

    virtual void Fire();

protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USkeletalMeshComponent* WeaponMesh;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite)
    FName MuzzleSocketName = "MuzzleSocket";

    //–¥–∞–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–µ–ª—å–±—ã
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite)
    float TraceMaxDistance = 1500.0f;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    TSubclassOf<UDamageType> DamageTypeClass;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    float DamageAmount = 10.0f;

    virtual void BeginPlay() override;

    void MakeShot();

    APlayerController* GetPlayerController() const;
    bool GetPlayerViewPoint(FVector& ViewLocation, FRotator& ViewRotation) const;
    FVector GetMuzzleWorldLocation() const;
    bool GetTraceData(FVector& TraceStart, FVector& TraceEnd) const;
    void MakeHit(FHitResult& HitResult, const FVector& TraceStart, const FVector& TraceEnd);
    void MakeDamage(FHitResult& HitResult);
};

```

.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUBaseWeapon.h"
#include "Components/SkeletalMeshComponent.h"
#include "Engine/World.h"
#include "DrawDebugHelpers.h"
#include "GameFramework/Character.h"
#include "GameFramework/Controller.h"
#include "STU/Character/STUBaseCharacter.h"
#include "Kismet/GameplayStatics.h"
#include "STU/Dev/STUFireDamageType.h"

DEFINE_LOG_CATEGORY_STATIC(LogBaseWeapon, All, All);

ASTUBaseWeapon::ASTUBaseWeapon()
{
    PrimaryActorTick.bCanEverTick = false;

    WeaponMesh = CreateDefaultSubobject<USkeletalMeshComponent>("WeaponMesh");
    SetRootComponent(WeaponMesh);
}

void ASTUBaseWeapon::BeginPlay()
{
    Super::BeginPlay();

    check(WeaponMesh);
}

void ASTUBaseWeapon::Fire()
{
    //UE_LOG(LogBaseWeapon, Display, TEXT("Fire!"))

    MakeShot();
}

//–≤—ã—Å—Ç—Ä–µ–ª
void ASTUBaseWeapon::MakeShot()
{
    if (!GetWorld()) return;

    FVector TraceStart, TraceEnd;
    if (!GetTraceData(TraceStart, TraceEnd)) return;

    FHitResult HitResult;
    MakeHit(HitResult, TraceStart, TraceEnd);

    if (HitResult.bBlockingHit)
    {
        //–≤—ã–∑–æ–≤ —Ñ—É–∫–Ω—Ü–∏–∏ –Ω–∞–Ω–µ—Å–µ–Ω–∏—è —É—Ä–æ–Ω–∞
        MakeDamage(HitResult);

        //—Ä–∏—Å—É–µ–º –ª–∏–Ω–∏—é
        //persistance - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑
        DrawDebugLine(GetWorld(), GetMuzzleWorldLocation(), HitResult.ImpactPoint, FColor::Red, false, 5.0f, 0, 3.0f);

        //—Ä–∏—Å–æ–≤–∞–Ω–∏–µ —Å—Ñ–µ—Ä—ã –≤ —Ç–æ—á–∫–∏ –ø–æ–ø–∞–¥–∞–Ω–∏—è
        DrawDebugSphere(GetWorld(), HitResult.ImpactPoint, 10.0f, 24, FColor::Red, false, 5.0f);

        //–≤—ã–≤–æ–¥ –∫–æ—Å—Ç–∏ –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ–ø–∞–ª–∏
        UE_LOG(LogBaseWeapon, Display, TEXT("Bone: %s"), *HitResult.BoneName.ToString());


        //----------
        //AActor* HitActor = HitResult.GetActor();

        //if (!HitActor) return;
        //UE_LOG(LogBaseWeapon, Display, TEXT("Actor: %s"), *HitActor->GetName());
        ////UE_LOG(LogBaseWeapon, Display, TEXT("Actor: %s"), *GetNameSafe(HitResult.GetActor()));

        //if (HitActor->IsA<ASTUBaseCharacter>())
        //{
        //    if (DamageTypeClass) return;


        //    UE_LOG(LogBaseWeapon, Display, TEXT("EnemyActor is find!"));
        //    UGameplayStatics::ApplyDamage(HitActor, 10.0f, nullptr, this, DamageTypeClass);
        //}
    }
    else
    {
        //—Ä–∏—Å—É–µ–º –ª–∏–Ω–∏—é
        //persistance - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑
        DrawDebugLine(GetWorld(), GetMuzzleWorldLocation(), TraceEnd, FColor::Red, false, 5.0f, 0, 3.0f);
    }
}

//—Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
APlayerController* ASTUBaseWeapon::GetPlayerController() const
{
    const auto Player = Cast<ACharacter>(GetOwner());
    if (!Player) return nullptr;

    return Player->GetController<APlayerController>();
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ ViewPoint player
bool ASTUBaseWeapon::GetPlayerViewPoint(FVector& ViewLocation, FRotator& ViewRotation) const
{
    const auto Controller = GetPlayerController();
    if (!Controller) return false;

    Controller->GetPlayerViewPoint(ViewLocation, ViewRotation);
    return true;
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–æ–∫–µ—Ç–∞
FVector ASTUBaseWeapon::GetMuzzleWorldLocation() const
{
    return WeaponMesh->GetSocketLocation(MuzzleSocketName);
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è trace
bool ASTUBaseWeapon::GetTraceData(FVector& TraceStart, FVector& TraceEnd) const
{
    FVector ViewLocation;
    FRotator ViewRotation;
    if (!GetPlayerViewPoint(ViewLocation, ViewRotation)) return false;

    //–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç—Ç–æ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    TraceStart = ViewLocation;

    //–±–µ—Ä–µ–º forward vector –∏–∑ —Å–æ–∫–µ—Ç–∞ –∏–ª–∏ –Ω–∞—á–∞–ª–∞
    //–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ –≤ –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É —Å—Ç—Ä–µ–ª—å–±–∞ –∏–¥–µ—Ç
    const FVector ShootDirection = ViewRotation.Vector();

    //–¥–ª—è —Ç–æ—á–∫–∏ –∫–æ–Ω—Ü–∞ –±–µ—Ä–µ–º –Ω–∞—á–∞–ª–æ + –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ —Å –¥–æ–º–Ω–æ–∂–µ–Ω–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–µ–π (1500 –µ–¥)
    TraceEnd = TraceStart + ShootDirection * TraceMaxDistance;
    return true;
}

//—Ñ—É–Ω–∫—Ü–∏—è —Ç—Ä–µ–π—Å–∞
void ASTUBaseWeapon::MakeHit(FHitResult& HitResult, const FVector& TraceStart, const FVector& TraceEnd)
{
    if (!GetWorld()) return;

    //–∞–∫—Ç–æ—Ä—ã –¥–ª—è –∏–≥–Ω–æ—Ä–∞
    FCollisionQueryParams CollisionParams;
    CollisionParams.AddIgnoredActor(GetOwner());

    //–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ
    //–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ HitResult
    //–±–ª–æ–∫–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    GetWorld()->LineTraceSingleByChannel(HitResult, TraceStart, TraceEnd, ECollisionChannel::ECC_Visibility, CollisionParams);
}

void ASTUBaseWeapon::MakeDamage(FHitResult& HitResult)
{
    const auto DamagedActor = HitResult.GetActor();
    if (!DamagedActor) return;

    DamagedActor->TakeDamage(DamageAmount, FDamageEvent(), GetPlayerController(), this);
}
```

## Animation offset, –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏–µ, –ø–æ–≤–æ—Ä–æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –ø—Ä–∏—Ü–µ–ª–æ–º

–≤–µ–∫—Ç–æ—Ä –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —É–≥–ª–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∏ –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏—è 

![[Pasted image 20250518080827.png]]

![[Pasted image 20250518080800.png]]

![[Pasted image 20250518082405.png]]
## F.A.B.R.I.K. –ó–∞–∫—Ä–µ–ø–∏—Ç—å –¥—Ä—É–≥—É—é –∫–æ—Å—Ç—å –≤ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫ –¥—Ä—É–≥–æ–π –∫–æ—Å—Ç–∏

–ú–æ–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å –∫–æ—Å—Ç—å –∫ –¥—Ä—É–≥–æ–π –∫–æ—Å—Ç–∏ 

![[Pasted image 20250518095750.png]]

![[Pasted image 20250518095725.png]]
![[Pasted image 20250518095717.png]]

![[Pasted image 20250518100330.png]]

![[Pasted image 20250518100322.png]]

## –°—Ç—Ä–µ–ª—å–±–∞ –ø–æ —Ç–∞–π–º–µ—Ä—É 

–ö–æ–≥–¥–∞ –∫–Ω–æ–ø–∫–∞ –∑–∞–∂–∞—Ç–∞, —Å—Ç—Ä–µ–ª—å–±–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏–¥—Ç–∏ 

```cpp
    PlayerInputComponent->BindAction("Fire", IE_Pressed, WeaponComponent, &USTUWeaponComponent::StartFire);
    PlayerInputComponent->BindAction("Fire", IE_Released, WeaponComponent, &USTUWeaponComponent::StopFire);

```


```cpp
void USTUWeaponComponent::StartFire()
{
    if (!CurrentWeapon) return;

    //–µ—Å–ª–∏ –µ—Å—Ç—å –æ—Ä—É–∂–∏–µ, —Ç–æ –≤—ã–∑–æ–≤ –∏–∑ ASTUBaseWeapon Fire
    CurrentWeapon->StartFire();
}

void USTUWeaponComponent::StopFire()
{
    if (!CurrentWeapon) return;
    CurrentWeapon->StopFire();
}
```


```cpp
void ASTUBaseWeapon::StartFire()
{
    MakeShot();
    GetWorldTimerManager().SetTimer(ShotTimerHandle, this, &ASTUBaseWeapon::MakeShot, TimeBetweenShot, true);
}

void ASTUBaseWeapon::StopFire()
{
    GetWorldTimerManager().ClearTimer(ShotTimerHandle);
}
```

## UProjectileMovementComponent

–≠—Ç–æ—Ç –º—É–≤–º–µ–Ω—Ç –∫–æ–º–ø–æ–Ω–µ—Ç —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç –∏—Å–∫–ª—é—á–µ—Ç–µ–ª—å–Ω–æ –¥–≤–∏–∂–µ–Ω–∏–µ projectile 

LauncherWeapon.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "STUBaseWeapon.h"
#include "STULauncherWeapon.generated.h"

class ASTUProjectile;

UCLASS()
class STU_API ASTULauncherWeapon : public ASTUBaseWeapon
{
    GENERATED_BODY()

public:
    virtual void StartFire() override;

protected:
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    TSubclassOf<ASTUProjectile> ProjectileClass;

    virtual void MakeShot() override;
};

```

LauncherWeapon.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STULauncherWeapon.h"
#include "STUProjectile.h"

void ASTULauncherWeapon::StartFire()
{
    MakeShot();
}

void ASTULauncherWeapon::MakeShot()
{
    if (!GetWorld()) return;

    FVector TraceStart, TraceEnd;
    if (!GetTraceData(TraceStart, TraceEnd)) return;

    FHitResult HitResult;
    MakeHit(HitResult, TraceStart, TraceEnd);

    //–≤ —Ç–æ—á–∫—É –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ
    //–ø–æ–ø–∞–ª–∏ –ª–∏ –º—ã –∫—É–¥–∞ —Ç–æ, –µ—Å–ª–∏ –¥–∞ –ø–æ–ø–∞–ª–∏, —Ç–æ –ø–∏—à–µ–º ImpactPoint, –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ TraceEnd
    const FVector EndPoint = HitResult.bBlockingHit ? HitResult.ImpactPoint : TraceEnd;

    //–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    const FVector Direction = (EndPoint - GetMuzzleWorldLocation()).GetSafeNormal();

    const FTransform SpawnTransform(FRotator::ZeroRotator, GetMuzzleWorldLocation());
    ASTUProjectile* Projectile = GetWorld()->SpawnActorDeferred<ASTUProjectile>(ProjectileClass, SpawnTransform);
    if (Projectile)
    {
        Projectile->SetShotDirection(Direction);
        Projectile->FinishSpawning(SpawnTransform);
    }
}

```

.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUProjectile.generated.h"

class USphereComponent;
class UProjectileMovementComponent;

UCLASS()
class STU_API ASTUProjectile : public AActor
{
    GENERATED_BODY()

public:
    ASTUProjectile();

    void SetShotDirection(const FVector& Direction) { ShotDirection = Direction; }

protected:
    UPROPERTY(VisibleDefaultsOnly, Category = "Weapon")
    USphereComponent* CollisionComponent;

    UPROPERTY(VisibleDefaultsOnly, Category = "Weapon")
    UProjectileMovementComponent* MovementComponent;

    virtual void BeginPlay() override;

private:
    FVector ShotDirection;
};

```

.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUProjectile.h"
#include "Components/SphereComponent.h"
#include "GameFramework/ProjectileMovementComponent.h"

ASTUProjectile::ASTUProjectile()
{
    PrimaryActorTick.bCanEverTick = false;

    CollisionComponent = CreateDefaultSubobject<USphereComponent>("SphereComponent");
    CollisionComponent->InitSphereRadius(5.0f);
    SetRootComponent(CollisionComponent);

    MovementComponent = CreateDefaultSubobject<UProjectileMovementComponent>("ProjectileMovementComponent");
    MovementComponent->InitialSpeed = 2000.0f;
    MovementComponent->ProjectileGravityScale = 0.0f;
}

void ASTUProjectile::BeginPlay()
{
    Super::BeginPlay();

    check(MovementComponent);
    MovementComponent->Velocity = ShotDirection * MovementComponent->InitialSpeed;
    //–ø–æ —Ç–∞–π–º–µ—Ä—É —É–¥–∞–ª–∏—Ç –∞–∫—Ç–æ—Ä
    SetLifeSpan(5.0f);
}
```

## Radial Apply Damage, –≥—Ä–∞–Ω–∞—Ç–æ–º–µ—Ç 

launcher.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "STUBaseWeapon.h"
#include "STULauncherWeapon.generated.h"

class ASTUProjectile;

UCLASS()
class STU_API ASTULauncherWeapon : public ASTUBaseWeapon
{
    GENERATED_BODY()

public:
    virtual void StartFire() override;

protected:
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    TSubclassOf<ASTUProjectile> ProjectileClass;

    virtual void MakeShot() override;
};

```

laucher.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STULauncherWeapon.h"
#include "STUProjectile.h"

void ASTULauncherWeapon::StartFire()
{
    MakeShot();
}

void ASTULauncherWeapon::MakeShot()
{
    if (!GetWorld()) return;

    FVector TraceStart, TraceEnd;
    if (!GetTraceData(TraceStart, TraceEnd)) return;

    FHitResult HitResult;
    MakeHit(HitResult, TraceStart, TraceEnd);

    //–≤ —Ç–æ—á–∫—É –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ
    //–ø–æ–ø–∞–ª–∏ –ª–∏ –º—ã –∫—É–¥–∞ —Ç–æ, –µ—Å–ª–∏ –¥–∞ –ø–æ–ø–∞–ª–∏, —Ç–æ –ø–∏—à–µ–º ImpactPoint, –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ TraceEnd
    const FVector EndPoint = HitResult.bBlockingHit ? HitResult.ImpactPoint : TraceEnd;

    //–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    const FVector Direction = (EndPoint - GetMuzzleWorldLocation()).GetSafeNormal();

    const FTransform SpawnTransform(FRotator::ZeroRotator, GetMuzzleWorldLocation());
    ASTUProjectile* Projectile = GetWorld()->SpawnActorDeferred<ASTUProjectile>(ProjectileClass, SpawnTransform);
    if (Projectile)
    {
        Projectile->SetShotDirection(Direction);
        Projectile->SetOwner(GetOwner());
        Projectile->FinishSpawning(SpawnTransform);
    }
}

```

Projectile.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUProjectile.generated.h"

class USphereComponent;
class UProjectileMovementComponent;

UCLASS()
class STU_API ASTUProjectile : public AActor
{
    GENERATED_BODY()

public:
    ASTUProjectile();

    void SetShotDirection(const FVector& Direction) { ShotDirection = Direction; }

protected:
    UPROPERTY(VisibleAnywhere, Category = "Weapon")
    USphereComponent* CollisionComponent;

    UPROPERTY(VisibleAnywhere, Category = "Weapon")
    UProjectileMovementComponent* MovementComponent;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    float DamageRadius = 200.0f;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    float DamageAmount = 50.0f;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    bool DoFullDamage = false;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    float LifeSeconds = 5.0;

    virtual void BeginPlay() override;

private:
    FVector ShotDirection;

    UFUNCTION()
    void OnProjectileHit(UPrimitiveComponent* HitComponent, AActor* OtherActor, 
        UPrimitiveComponent* OtherComp, FVector NormalImpulse, const FHitResult& Hit);

    AController* GetController() const;
};

```

Projectile.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUProjectile.h"
#include "Components/SphereComponent.h"
#include "GameFramework/ProjectileMovementComponent.h"
#include "DrawDebugHelpers.h"
#include "Kismet/GameplayStatics.h"

ASTUProjectile::ASTUProjectile()
{
    PrimaryActorTick.bCanEverTick = false;

    CollisionComponent = CreateDefaultSubobject<USphereComponent>("SphereComponent");
    CollisionComponent->InitSphereRadius(5.0f);
    CollisionComponent->SetCollisionEnabled(ECollisionEnabled::QueryOnly);
    //–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–ª–∏–∑–∏–∏ –¥–ª—è –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö, –ø—Ä–∏ —Å–æ–ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏–∏
    CollisionComponent->SetCollisionResponseToAllChannels(ECollisionResponse::ECR_Block);
    SetRootComponent(CollisionComponent);

    MovementComponent = CreateDefaultSubobject<UProjectileMovementComponent>("ProjectileMovementComponent");
    MovementComponent->InitialSpeed = 2000.0f;
    MovementComponent->ProjectileGravityScale = 0.0f;
}

void ASTUProjectile::BeginPlay()
{
    Super::BeginPlay();

    check(MovementComponent);
    check(CollisionComponent);

    MovementComponent->Velocity = ShotDirection * MovementComponent->InitialSpeed;
    CollisionComponent->IgnoreActorWhenMoving(GetOwner(), true);
    CollisionComponent->OnComponentHit.AddDynamic(this, &ASTUProjectile::OnProjectileHit);

    //–ø–æ —Ç–∞–π–º–µ—Ä—É —É–¥–∞–ª–∏—Ç –∞–∫—Ç–æ—Ä
    SetLifeSpan(LifeSeconds);
}

void ASTUProjectile::OnProjectileHit(UPrimitiveComponent* HitComponent, AActor* OtherActor,
    UPrimitiveComponent* OtherComp, FVector NormalImpulse, const FHitResult& Hit)
{
    if (!GetWorld()) return;

    //–ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ
    MovementComponent->StopMovementImmediately();

    //make damage
    UGameplayStatics::ApplyRadialDamage(GetWorld(), //
        DamageAmount,                               //
        GetActorLocation(),                         //
        DamageRadius,                               //
        UDamageType::StaticClass(),                 //
        {GetOwner()},                               //
        this,                                       //
        GetController(),                            //
        DoFullDamage);

    DrawDebugSphere(GetWorld(), GetActorLocation(), DamageRadius, 24, FColor::Red, false, 5.0f);

    //–∞–∫—Ç–æ—Ä —É–¥–∞–ª—è–µ—Ç—Å—è –ª–∏–±–æ –ø–æ —Ç–∞–π–º–µ—Ä—É, –ª–∏–±–æ –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏
    Destroy();
}

AController* ASTUProjectile::GetController() const
{
    const auto Pawn = Cast<APawn>(GetOwner());
    return Pawn ? Pawn->GetController() : nullptr;
}
```

## –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Å–µ–Ω–∞–ª–∞ –æ—Ä—É–∂–∏—è 

weaponComponent.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUWeaponComponent.generated.h"

class ASTUBaseWeapon;

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUWeaponComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    // Sets default values for this component's properties
    USTUWeaponComponent();

    void StartFire();
    void StopFire();
    void NextWeapon();

protected:
    //–º–∞—Å—Å–∏–≤ –∏–∑ —Å–∞–± –∫–ª–∞—Å—Å–æ–≤ –æ—Ä—É–∂–∏—è 
    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    TArray<TSubclassOf<ASTUBaseWeapon>> WeaponClasses;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponEquipSocketName = "WeaponSocket";

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponArmorySocketName = "ArmorySocket";

    // Called when the game starts
    virtual void BeginPlay() override;

    //–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏ 
    virtual void EndPlay(const EEndPlayReason::Type EndPlayReason) override;

private:
    UPROPERTY()
    ASTUBaseWeapon* CurrentWeapon = nullptr;

    UPROPERTY()
    TArray<ASTUBaseWeapon*> Weapons;

    int32 CurrentWeaponIndex = 0;

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –ø–µ—Ä—Å–æ–Ω–∞–∂—É
    void SpawnWeapons();
    void AttachWeaponToSocket(ASTUBaseWeapon* Weapon,
        USceneComponent* SceneComponent, const FName& SocketName);
    void EquipWeapon(int32 WeaponIndex);
};

```

weaponComponent.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUWeaponComponent.h"
#include "STU/Weapons/STUBaseWeapon.h"
#include "GameFramework/Character.h"

DEFINE_LOG_CATEGORY_STATIC(WeaponComponentLog, All, All);

USTUWeaponComponent::USTUWeaponComponent()
{

    PrimaryComponentTick.bCanEverTick = false;
}

void USTUWeaponComponent::BeginPlay()
{
    Super::BeginPlay();

    CurrentWeaponIndex = 0;
    SpawnWeapons();
    EquipWeapon(CurrentWeaponIndex);
}

//—Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏ 
void USTUWeaponComponent::EndPlay(const EEndPlayReason::Type EndPlayReason)
{
    CurrentWeapon = nullptr;
    for (auto Weapon : Weapons)
    {
        Weapon->DetachFromActor(FDetachmentTransformRules::KeepWorldTransform);
        Weapon->Destroy();
    }
    Weapons.Empty();

    Super::EndPlay(EndPlayReason);
}

void USTUWeaponComponent::SpawnWeapons()
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || !GetWorld()) return;
    //UE_LOG(WeaponComponentLog, Display, TEXT("Character is find!"));

    for (auto WeaponClass : WeaponClasses)
    {
        //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏—è
        auto Weapon = GetWorld()->SpawnActor<ASTUBaseWeapon>(WeaponClass);
        if (!Weapon) continue;

        Weapon->SetOwner(Character);
        Weapons.Add(Weapon);

        AttachWeaponToSocket(Weapon, Character->GetMesh(), WeaponArmorySocketName);
    }
}

//—ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä—É–∂–µ—è
void USTUWeaponComponent::EquipWeapon(int32 WeaponIndex)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;

    if (CurrentWeapon)
    {
        CurrentWeapon->StopFire();
        AttachWeaponToSocket(CurrentWeapon, Character->GetMesh(), WeaponArmorySocketName);
    }

    CurrentWeapon = Weapons[WeaponIndex];
    AttachWeaponToSocket(CurrentWeapon, Character->GetMesh(), WeaponEquipSocketName);
}

void USTUWeaponComponent::AttachWeaponToSocket(ASTUBaseWeapon* Weapon, USceneComponent* SceneComponent, const FName& SocketName)
{
    if (!Weapon || !SceneComponent) return;

    //–∞—Ç—Ç–∞—á –∫ –º–µ—à—É, —Ä—É–∫–µ
    FAttachmentTransformRules AttachmentRules(EAttachmentRule::SnapToTarget, false);
    Weapon->AttachToComponent(SceneComponent, AttachmentRules, SocketName);
}

void USTUWeaponComponent::StartFire()
{
    if (!CurrentWeapon) return;

    //–µ—Å–ª–∏ –µ—Å—Ç—å –æ—Ä—É–∂–∏–µ, —Ç–æ –≤—ã–∑–æ–≤ –∏–∑ ASTUBaseWeapon Fire
    CurrentWeapon->StartFire();
}

void USTUWeaponComponent::StopFire()
{
    if (!CurrentWeapon) return;
    CurrentWeapon->StopFire();
}

void USTUWeaponComponent::NextWeapon()
{
    //—á—Ç–æ –±—ã –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –≤—ã—à–ª–∞ –∑–∞ –ø—Ä–∏–¥–µ–ª—ã –º–∞—Å—Å–∏–≤–∞
    //–±–µ—Ä–µ–º –µ–µ –ø–æ –º–æ–¥—É–ª—é –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞, —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ –¥–ª–∏–Ω–µ –º–∞—Å—Å–∏–≤–∞
    //—Ç–æ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ 0
    CurrentWeaponIndex = (CurrentWeaponIndex + 1) % Weapons.Num();
    EquipWeapon(CurrentWeaponIndex);
}
```

## Anim Notify

equipNotify.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Animation/AnimNotifies/AnimNotify.h"
#include "STUEquipFinishAnimNotify.generated.h"

DECLARE_MULTICAST_DELEGATE_OneParam(FOnNotifiedSingature, USkeletalMeshComponent*);

UCLASS()
class STU_API USTUEquipFinishAnimNotify : public UAnimNotify
{
    GENERATED_BODY()

public:
    virtual void Notify(USkeletalMeshComponent* MeshComp, UAnimSequenceBase* Animation) override;

    FOnNotifiedSingature OnNotified;
};

```

equipNotify.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUEquipFinishAnimNotify.h"

void USTUEquipFinishAnimNotify::Notify(USkeletalMeshComponent* MeshComp, UAnimSequenceBase* Animation)
{
    OnNotified.Broadcast(MeshComp);
    Super::Notify(MeshComp, Animation);
}
```

weaponComponent.h

```cpp
    void InitAnimations();
    void OnEquipFinished(USkeletalMeshComponent* MeshComponent);
```

weaponComponent.cpp

```cpp
void USTUWeaponComponent::BeginPlay()
{
    Super::BeginPlay();

    CurrentWeaponIndex = 0;
    InitAnimations(); //start
    SpawnWeapons();
    EquipWeapon(CurrentWeaponIndex);
}

void USTUWeaponComponent::InitAnimations()
{
    if (!EquipAnimMontage) return;
    const auto NotifyEvents = EquipAnimMontage->Notifies;

    for (auto NotifyEvent : NotifyEvents)
    {
        auto EquipFinishNotify = Cast<USTUEquipFinishAnimNotify>(NotifyEvent.Notify);
        if (EquipFinishNotify)
        {
            EquipFinishNotify->OnNotified.AddUObject(this, &USTUWeaponComponent::OnEquipFinished);
            break;
        }
    }
}

void USTUWeaponComponent::OnEquipFinished(USkeletalMeshComponent* MeshComponent)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;

    if (Character->GetMesh() == MeshComponent)
    {
        UE_LOG(LogWeaponComponent, Display, TEXT("Equip finished!"));
    }
}
```

![[Pasted image 20250520122817.png]]

## Equip Animation / Equip flag

h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUWeaponComponent.generated.h"

class ASTUBaseWeapon;

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUWeaponComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    // Sets default values for this component's properties
    USTUWeaponComponent();

    void StartFire();
    void StopFire();
    void NextWeapon();

protected:
    //–º–∞—Å—Å–∏–≤ –∏–∑ —Å–∞–± –∫–ª–∞—Å—Å–æ–≤ –æ—Ä—É–∂–∏—è
    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    TArray<TSubclassOf<ASTUBaseWeapon>> WeaponClasses;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponEquipSocketName = "WeaponSocket";

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponArmorySocketName = "ArmorySocket";

    UPROPERTY(EditDefaultsOnly, Category = "Animation")
    UAnimMontage* EquipAnimMontage;

    // Called when the game starts
    virtual void
    BeginPlay() override;

    //–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
    virtual void EndPlay(const EEndPlayReason::Type EndPlayReason) override;

private:
    UPROPERTY()
    ASTUBaseWeapon* CurrentWeapon = nullptr;

    UPROPERTY()
    TArray<ASTUBaseWeapon*> Weapons;

    int32 CurrentWeaponIndex = 0;
    bool EquipAnimInProgress = false;

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –ø–µ—Ä—Å–æ–Ω–∞–∂—É
    void SpawnWeapons();
    void AttachWeaponToSocket(ASTUBaseWeapon* Weapon,
        USceneComponent* SceneComponent, const FName& SocketName);
    void EquipWeapon(int32 WeaponIndex);

    void PlayAnimMontage(UAnimMontage* Animation);
    void InitAnimations();
    void OnEquipFinished(USkeletalMeshComponent* MeshComponent);

    bool CanFire() const;
    bool CanEquip() const;
};

```

cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUWeaponComponent.h"
#include "STU/Weapons/STUBaseWeapon.h"
#include "GameFramework/Character.h"
#include "STU/Animations/STUEquipFinishAnimNotify.h"

DEFINE_LOG_CATEGORY_STATIC(LogWeaponComponent, All, All);

USTUWeaponComponent::USTUWeaponComponent()
{

    PrimaryComponentTick.bCanEverTick = false;
}

void USTUWeaponComponent::BeginPlay()
{
    Super::BeginPlay();

    CurrentWeaponIndex = 0;
    InitAnimations();
    SpawnWeapons();
    EquipWeapon(CurrentWeaponIndex);
}

//—Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
void USTUWeaponComponent::EndPlay(const EEndPlayReason::Type EndPlayReason)
{
    CurrentWeapon = nullptr;
    for (auto Weapon : Weapons)
    {
        Weapon->DetachFromActor(FDetachmentTransformRules::KeepWorldTransform);
        Weapon->Destroy();
    }
    Weapons.Empty();

    Super::EndPlay(EndPlayReason);
}

void USTUWeaponComponent::SpawnWeapons()
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || !GetWorld()) return;

    for (auto WeaponClass : WeaponClasses)
    {
        //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏—è
        auto Weapon = GetWorld()->SpawnActor<ASTUBaseWeapon>(WeaponClass);
        if (!Weapon) continue;

        Weapon->SetOwner(Character);
        Weapons.Add(Weapon);

        AttachWeaponToSocket(Weapon, Character->GetMesh(), WeaponArmorySocketName);
    }
}

//—ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä—É–∂–µ—è
void USTUWeaponComponent::EquipWeapon(int32 WeaponIndex)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;

    if (CurrentWeapon)
    {
        CurrentWeapon->StopFire();
        AttachWeaponToSocket(CurrentWeapon, Character->GetMesh(), WeaponArmorySocketName);
    }

    CurrentWeapon = Weapons[WeaponIndex];
    AttachWeaponToSocket(CurrentWeapon, Character->GetMesh(), WeaponEquipSocketName);
    EquipAnimInProgress = true;
    PlayAnimMontage(EquipAnimMontage);
}

void USTUWeaponComponent::AttachWeaponToSocket(ASTUBaseWeapon* Weapon, USceneComponent* SceneComponent, const FName& SocketName)
{
    if (!Weapon || !SceneComponent) return;

    //–∞—Ç—Ç–∞—á –∫ –º–µ—à—É, —Ä—É–∫–µ
    FAttachmentTransformRules AttachmentRules(EAttachmentRule::SnapToTarget, false);
    Weapon->AttachToComponent(SceneComponent, AttachmentRules, SocketName);
}

void USTUWeaponComponent::StartFire()
{
    if (!CanFire()) return;

    //–µ—Å–ª–∏ –µ—Å—Ç—å –æ—Ä—É–∂–∏–µ, —Ç–æ –≤—ã–∑–æ–≤ –∏–∑ ASTUBaseWeapon Fire
    CurrentWeapon->StartFire();
}

void USTUWeaponComponent::StopFire()
{
    if (!CurrentWeapon) return;
    CurrentWeapon->StopFire();
}

void USTUWeaponComponent::NextWeapon()
{
    if (!CanEquip()) return;

    //—á—Ç–æ –±—ã –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –≤—ã—à–ª–∞ –∑–∞ –ø—Ä–∏–¥–µ–ª—ã –º–∞—Å—Å–∏–≤–∞
    //–±–µ—Ä–µ–º –µ–µ –ø–æ –º–æ–¥—É–ª—é –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞, —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ –¥–ª–∏–Ω–µ –º–∞—Å—Å–∏–≤–∞
    //—Ç–æ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ 0
    CurrentWeaponIndex = (CurrentWeaponIndex + 1) % Weapons.Num();
    EquipWeapon(CurrentWeaponIndex);
}

void USTUWeaponComponent::PlayAnimMontage(UAnimMontage* Animation)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;

    Character->PlayAnimMontage(Animation);
}

void USTUWeaponComponent::InitAnimations()
{
    if (!EquipAnimMontage) return;
    const auto NotifyEvents = EquipAnimMontage->Notifies;

    for (auto NotifyEvent : NotifyEvents)
    {
        auto EquipFinishNotify = Cast<USTUEquipFinishAnimNotify>(NotifyEvent.Notify);
        if (EquipFinishNotify)
        {
            EquipFinishNotify->OnNotified.AddUObject(this, &USTUWeaponComponent::OnEquipFinished);
            break;
        }
    }
}

void USTUWeaponComponent::OnEquipFinished(USkeletalMeshComponent* MeshComponent)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || MeshComponent != Character->GetMesh()) return;

    EquipAnimInProgress = false;
}

bool USTUWeaponComponent::CanFire() const
{
    return CurrentWeapon && !EquipAnimInProgress;
}

bool USTUWeaponComponent::CanEquip() const
{
    return !EquipAnimInProgress;
}
```

## Slot upper body 


![[Pasted image 20250520145907.png]]

![[Pasted image 20250520145851.png]]

![[Pasted image 20250520150037.png]]

![[Pasted image 20250520145833.png]]


![[Pasted image 20250520145747.png]]

RootMotion –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É–ø–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, –±–µ—Ä—è –µ–≥–æ –∏–∑ AM –∏ –∞–Ω–∏–º–∞—Ü–∏–π 

![[Pasted image 20250520145938.png]]

## Ammo data

baseweapon.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUBaseWeapon.generated.h"

class USkeletalMeshComponent;

USTRUCT(BlueprintType)
struct FAmmoData
{
    GENERATED_USTRUCT_BODY()

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    int32 Bullets;

    //—Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –∫–æ–≥–¥–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Infinite
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon", meta = (EditCondition = "!Infinite"))
    int32 Clips;

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    bool Infinite;
};

UCLASS()
class STU_API ASTUBaseWeapon : public AActor
{
    GENERATED_BODY()

public:
    ASTUBaseWeapon();

    virtual void StartFire();
    virtual void StopFire();

protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Components")
    USkeletalMeshComponent* WeaponMesh;

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    FName MuzzleSocketName = "MuzzleSocket";

    //–¥–∞–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–µ–ª—å–±—ã
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    float TraceMaxDistance = 5000.0f;

    //15 –ø–∞—Ç—Ä–æ–Ω, 10 –æ–±–æ–π–º, –∞—Ä—Å–µ–Ω–∞–ª –∫–æ–Ω–µ—á–µ–Ω false
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    FAmmoData DefaultAmmo{15, 10, false};

    //UPROPERTY(EditAnywhere, BlueprintReadWrite)
    //TSubclassOf<UDamageType> DamageTypeClass;

    virtual void BeginPlay() override;

    virtual void MakeShot();

    virtual bool GetTraceData(FVector& TraceStart, FVector& TraceEnd) const;

    APlayerController* GetPlayerController() const;
    bool GetPlayerViewPoint(FVector& ViewLocation, FRotator& ViewRotation) const;
    FVector GetMuzzleWorldLocation() const;
    void MakeHit(FHitResult& HitResult, const FVector& TraceStart, const FVector& TraceEnd);

    void DecreaseAmmo();
    bool IsAmmoEmpty() const;
    bool IsClipEmpty() const;
    void ChangeClip();
    void LogAmmo();

private:
    FAmmoData CurrentAmmo;
};

```

baseweapon.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUBaseWeapon.h"
#include "Components/SkeletalMeshComponent.h"
#include "Engine/World.h"
#include "DrawDebugHelpers.h"
#include "GameFramework/Character.h"
#include "GameFramework/Controller.h"
#include "STU/Character/STUBaseCharacter.h"
#include "Kismet/GameplayStatics.h"
#include "STU/Dev/STUFireDamageType.h"

DEFINE_LOG_CATEGORY_STATIC(LogBaseWeapon, All, All);

ASTUBaseWeapon::ASTUBaseWeapon()
{
    PrimaryActorTick.bCanEverTick = false;

    WeaponMesh = CreateDefaultSubobject<USkeletalMeshComponent>("WeaponMesh");
    SetRootComponent(WeaponMesh);
}

void ASTUBaseWeapon::BeginPlay()
{
    Super::BeginPlay();

    check(WeaponMesh);
    CurrentAmmo = DefaultAmmo;
}

void ASTUBaseWeapon::StartFire()
{
}

void ASTUBaseWeapon::StopFire()
{
}

void ASTUBaseWeapon::MakeShot()
{
}

//—Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
APlayerController* ASTUBaseWeapon::GetPlayerController() const
{
    const auto Player = Cast<ACharacter>(GetOwner());
    if (!Player) return nullptr;

    return Player->GetController<APlayerController>();
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ ViewPoint player
bool ASTUBaseWeapon::GetPlayerViewPoint(FVector& ViewLocation, FRotator& ViewRotation) const
{
    const auto Controller = GetPlayerController();
    if (!Controller) return false;

    Controller->GetPlayerViewPoint(ViewLocation, ViewRotation);
    return true;
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–æ–∫–µ—Ç–∞
FVector ASTUBaseWeapon::GetMuzzleWorldLocation() const
{
    return WeaponMesh->GetSocketLocation(MuzzleSocketName);
}

//–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è trace
bool ASTUBaseWeapon::GetTraceData(FVector& TraceStart, FVector& TraceEnd) const
{
    FVector ViewLocation;
    FRotator ViewRotation;
    if (!GetPlayerViewPoint(ViewLocation, ViewRotation)) return false;

    //–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç—Ç–æ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
    TraceStart = ViewLocation;

    //–±–µ—Ä–µ–º forward vector –∏–∑ —Å–æ–∫–µ—Ç–∞ –∏–ª–∏ –Ω–∞—á–∞–ª–∞
    //–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ –≤ –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É —Å—Ç—Ä–µ–ª—å–±–∞ –∏–¥–µ—Ç
    const FVector ShootDirection = ViewRotation.Vector();

    //–¥–ª—è —Ç–æ—á–∫–∏ –∫–æ–Ω—Ü–∞ –±–µ—Ä–µ–º –Ω–∞—á–∞–ª–æ + –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ —Å –¥–æ–º–Ω–æ–∂–µ–Ω–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–µ–π (1500 –µ–¥)
    TraceEnd = TraceStart + ShootDirection * TraceMaxDistance;
    return true;
}

//—Ñ—É–Ω–∫—Ü–∏—è —Ç—Ä–µ–π—Å–∞
void ASTUBaseWeapon::MakeHit(FHitResult& HitResult, const FVector& TraceStart, const FVector& TraceEnd)
{
    if (!GetWorld()) return;

    //–∞–∫—Ç–æ—Ä—ã –¥–ª—è –∏–≥–Ω–æ—Ä–∞
    FCollisionQueryParams CollisionParams;
    CollisionParams.AddIgnoredActor(GetOwner());

    //–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ
    //–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ HitResult
    //–±–ª–æ–∫–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    GetWorld()->LineTraceSingleByChannel(HitResult, TraceStart, TraceEnd, ECollisionChannel::ECC_Visibility, CollisionParams);
}

//—É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–∞—Ç—Ä–æ–Ω–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
void ASTUBaseWeapon::DecreaseAmmo()
{
    CurrentAmmo.Bullets--;
    LogAmmo();

    if (IsClipEmpty() && !IsAmmoEmpty())
    {
        ChangeClip();
    }
}

//–µ—Å—Ç—å –ª–∏ –≤–æ–æ–±—â–µ –≤–µ–∑–¥–µ –ø–∞—Ç—Ä–æ–Ω—ã 
bool ASTUBaseWeapon::IsAmmoEmpty() const
{
    return !CurrentAmmo.Infinite && CurrentAmmo.Clips == 0 && IsClipEmpty();
}

//–ø—É—Å—Ç–æ–π –ª–∏ –º–∞–≥–∞–∑–∏–Ω
bool ASTUBaseWeapon::IsClipEmpty() const
{
    return CurrentAmmo.Bullets == 0;
}

//–ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞ –æ—Ä—É–∂–∏—è 
void ASTUBaseWeapon::ChangeClip()
{
    CurrentAmmo.Bullets = DefaultAmmo.Bullets;
    if (!CurrentAmmo.Infinite)
    {
        CurrentAmmo.Clips--;
    }
    UE_LOG(LogBaseWeapon, Display, TEXT("-----Change Clip -----"));
}

//–≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ–µ–ø—Ä–∏–ø–∞—Å–∞—Ö 
void ASTUBaseWeapon::LogAmmo()
{
    FString AmmoInfo = "Ammo: " + FString::FromInt(CurrentAmmo.Bullets) + " / ";
    AmmoInfo += CurrentAmmo.Infinite ? "Infinite" : FString::FromInt(CurrentAmmo.Clips);
    UE_LOG(LogBaseWeapon, Display, TEXT("%s"), *AmmoInfo)
}
```

## –†–∞–∑–ª–∏—á–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏, FindByPredicate

h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUWeaponComponent.generated.h"

class ASTUBaseWeapon;

USTRUCT(BlueprintType)
struct FWeaponData
{
    GENERATED_USTRUCT_BODY()

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    TSubclassOf<ASTUBaseWeapon> WeaponClass;

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    UAnimMontage* ReloadAnimMontage;
};

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUWeaponComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    // Sets default values for this component's properties
    USTUWeaponComponent();

    void StartFire();
    void StopFire();
    void NextWeapon();
    void Reload();

protected:
    //–º–∞—Å—Å–∏–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä
    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    TArray<FWeaponData> WeaponData;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponEquipSocketName = "WeaponSocket";

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponArmorySocketName = "ArmorySocket";

    UPROPERTY(EditDefaultsOnly, Category = "Animation")
    UAnimMontage* EquipAnimMontage;

    // Called when the game starts
    virtual void
    BeginPlay() override;

    //–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
    virtual void EndPlay(const EEndPlayReason::Type EndPlayReason) override;

private:
    UPROPERTY()
    ASTUBaseWeapon* CurrentWeapon = nullptr;

    UPROPERTY()
    TArray<ASTUBaseWeapon*> Weapons;

    UPROPERTY()
    UAnimMontage* CurrentReloadAnimMontage = nullptr;

    int32 CurrentWeaponIndex = 0;
    bool EquipAnimInProgress = false;
    bool ReloadAnimInProgress = false;

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –ø–µ—Ä—Å–æ–Ω–∞–∂—É
    void SpawnWeapons();
    void AttachWeaponToSocket(ASTUBaseWeapon* Weapon,
        USceneComponent* SceneComponent, const FName& SocketName);
    void EquipWeapon(int32 WeaponIndex);

    void PlayAnimMontage(UAnimMontage* Animation);
    void InitAnimations();

    void OnEquipFinished(USkeletalMeshComponent* MeshComponent);
    void OnReloadFinished(USkeletalMeshComponent* MeshComponent);

    bool CanFire() const;
    bool CanEquip() const;
    bool CanReload() const;

    //—à–∞–±–ª–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    template <typename T>
    T* FindNotifyByClass(UAnimSequenceBase* Animation)
    {
        if (!Animation) return nullptr;

        const auto NotifyEvents = Animation->Notifies;
        for (auto NotifyEvent : NotifyEvents)
        {
            auto AnimNotify = Cast<T>(NotifyEvent.Notify);
            if (AnimNotify)
            {
                return AnimNotify;
            }
        }
        return nullptr;
    }
};

```

cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUWeaponComponent.h"
#include "STU/Weapons/STUBaseWeapon.h"
#include "GameFramework/Character.h"
#include "STU/Animations/STUEquipFinishAnimNotify.h"
#include "STU/Animations/STUReloadFinishAnimNotify.h"

DEFINE_LOG_CATEGORY_STATIC(LogWeaponComponent, All, All);

USTUWeaponComponent::USTUWeaponComponent()
{

    PrimaryComponentTick.bCanEverTick = false;
}

void USTUWeaponComponent::BeginPlay()
{
    Super::BeginPlay();

    CurrentWeaponIndex = 0;
    InitAnimations();
    SpawnWeapons();
    EquipWeapon(CurrentWeaponIndex);
}

//—Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
void USTUWeaponComponent::EndPlay(const EEndPlayReason::Type EndPlayReason)
{
    CurrentWeapon = nullptr;
    for (auto Weapon : Weapons)
    {
        Weapon->DetachFromActor(FDetachmentTransformRules::KeepWorldTransform);
        Weapon->Destroy();
    }
    Weapons.Empty();

    Super::EndPlay(EndPlayReason);
}

void USTUWeaponComponent::SpawnWeapons()
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || !GetWorld()) return;

    for (auto OneWeaponData : WeaponData)
    {
        //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏—è
        auto Weapon = GetWorld()->SpawnActor<ASTUBaseWeapon>(OneWeaponData.WeaponClass);
        if (!Weapon) continue;

        Weapon->SetOwner(Character);
        Weapons.Add(Weapon);

        AttachWeaponToSocket(Weapon, Character->GetMesh(), WeaponArmorySocketName);
    }
}

//—ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä—É–∂–µ—è
void USTUWeaponComponent::EquipWeapon(int32 WeaponIndex)
{
    if (WeaponIndex < 0 || WeaponIndex >= Weapons.Num())
    {
        UE_LOG(LogWeaponComponent, Warning, TEXT("Invalid weapon index"));
        return;
    }

    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;

    if (CurrentWeapon)
    {
        CurrentWeapon->StopFire();
        AttachWeaponToSocket(CurrentWeapon, Character->GetMesh(), WeaponArmorySocketName);
    }

    CurrentWeapon = Weapons[WeaponIndex];
    //CurrentReloadAnimMontage = WeaponData[WeaponIndex].ReloadAnimMontage;
    //–∫–∞–∂–¥—ã–π —Ä–∞–∑ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å —Å —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –Ω—É–∂–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é, –ø–æ–¥—Ö–æ–¥—è—é—â—É—é –¥–ª—è –Ω–∞—Å
    //–≤ CurrentWeaponData –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    //FinDByPredicate —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç true/false
    //–≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —ç—Ç–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä []
    //–º—ã –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∞–Ω–æ–Ω–∏–º–Ω–æ–π –ª—è–º–±–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è
    //–∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –º–∞—Å—Å–∏–≤–∞
    //–∏ –≤ —Å–ª—É—á–∞–µ –∫–ª–∞—Å—Å–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–∞—Å—Å–∏–≤–∞
    // —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–ª–∞—Å—Å–æ–º CurrentWeapon
    // —Ç–æ –Ω–∞–º –≤–µ—Ä–Ω–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ nullptr
    //
    // [&] –æ–∑–Ω–∞—á–∞–µ—Ç –∑–∞—Ö–≤–∞—Ç –≤–Ω–µ—à–Ω–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Ç–æ –µ—Å—Ç—å –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —É–∫–∞–∑–∞—Ç–µ–ª—é
    // CurrentWeapon, –∞ –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ Data –∏–º–µ–µ—Ç —Ç–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞ WeaponData
    //
    // –ö –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –º–∞—Å—Å–∏–≤–∞ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–∏–Ω–∞ –¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏ –∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏,
    // –Ω–∞–º –≤–µ—Ä–Ω–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞
    //
    // —É—Å—Ç–∞–Ω–æ–≤–∏–º CurrentReloadAnimMontage –Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—é –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏ –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    // CurrentWeaponData –µ—Å–ª–∏ –Ω–µ –Ω—É–ª—å, —Ç–æ –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –ø–æ–ª—é, –µ—Å–ª–∏ –Ω—É–ª—å, —Ç–æ nullptr
    //
    const auto CurrentWeaponData = WeaponData.FindByPredicate([&](const FWeaponData& Data) //
        {                                                                                  //
            return Data.WeaponClass == CurrentWeapon->GetClass();
        });
    CurrentReloadAnimMontage = CurrentWeaponData ? CurrentWeaponData->ReloadAnimMontage : nullptr;

    AttachWeaponToSocket(CurrentWeapon, Character->GetMesh(), WeaponEquipSocketName);
    EquipAnimInProgress = true;
    PlayAnimMontage(EquipAnimMontage);
}

void USTUWeaponComponent::AttachWeaponToSocket(ASTUBaseWeapon* Weapon, USceneComponent* SceneComponent, const FName& SocketName)
{
    if (!Weapon || !SceneComponent) return;

    //–∞—Ç—Ç–∞—á –∫ –º–µ—à—É, —Ä—É–∫–µ
    FAttachmentTransformRules AttachmentRules(EAttachmentRule::SnapToTarget, false);
    Weapon->AttachToComponent(SceneComponent, AttachmentRules, SocketName);
}

void USTUWeaponComponent::StartFire()
{
    if (!CanFire()) return;

    //–µ—Å–ª–∏ –µ—Å—Ç—å –æ—Ä—É–∂–∏–µ, —Ç–æ –≤—ã–∑–æ–≤ –∏–∑ ASTUBaseWeapon Fire
    CurrentWeapon->StartFire();
}

void USTUWeaponComponent::StopFire()
{
    if (!CurrentWeapon) return;
    CurrentWeapon->StopFire();
}

void USTUWeaponComponent::NextWeapon()
{
    if (!CanEquip()) return;

    //—á—Ç–æ –±—ã –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –≤—ã—à–ª–∞ –∑–∞ –ø—Ä–∏–¥–µ–ª—ã –º–∞—Å—Å–∏–≤–∞
    //–±–µ—Ä–µ–º –µ–µ –ø–æ –º–æ–¥—É–ª—é –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞, —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ –¥–ª–∏–Ω–µ –º–∞—Å—Å–∏–≤–∞
    //—Ç–æ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ 0
    CurrentWeaponIndex = (CurrentWeaponIndex + 1) % Weapons.Num();
    EquipWeapon(CurrentWeaponIndex);
}

void USTUWeaponComponent::PlayAnimMontage(UAnimMontage* Animation)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;

    Character->PlayAnimMontage(Animation);
}

//–ø–æ–∏—Å–∫ –ø–æ
void USTUWeaponComponent::InitAnimations()
{
    //—Å–º–µ–Ω–∞ –æ—Ä—É–∂–∏—è
    //–ø–æ–∏—Å–∫ –ø–æ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–º–µ–Ω—ã –æ—Ä—É–∂–∏—è
    auto EquipFinishNotify = FindNotifyByClass<USTUEquipFinishAnimNotify>(EquipAnimMontage);
    if (EquipFinishNotify)
    {
        //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç notify, –ø—Ä–∏ –µ–≥–æ –ø—Ä–æ—Ö–æ–¥–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é OnEquipFinished
        EquipFinishNotify->OnNotified.AddUObject(this, &USTUWeaponComponent::OnEquipFinished);
    }

    //–ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞
    //–ø–æ–∏—Å–∫ –ø–æ –º–∞—Å—Å–∏–≤—É –∏–∑ –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏
    for (auto OneWeaponData : WeaponData)
    {
        auto ReloadFinishNotify = FindNotifyByClass<USTUReloadFinishAnimNotify>(OneWeaponData.ReloadAnimMontage);
        if (!ReloadFinishNotify) continue;

        //–µ—Å–ª–∏ –Ω–∞—à–ª–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç notify –∏ –ø—Ä–∏ –µ–≥–æ –ø—Ä–æ—Ö–æ–¥–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é OnReloadFinished
        ReloadFinishNotify->OnNotified.AddUObject(this, &USTUWeaponComponent::OnReloadFinished);
    }
}

void USTUWeaponComponent::OnEquipFinished(USkeletalMeshComponent* MeshComponent)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || MeshComponent != Character->GetMesh()) return;

    EquipAnimInProgress = false;
}

void USTUWeaponComponent::OnReloadFinished(USkeletalMeshComponent* MeshComponent)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || MeshComponent != Character->GetMesh()) return;

    ReloadAnimInProgress = false;
}

bool USTUWeaponComponent::CanFire() const
{
    return CurrentWeapon && !EquipAnimInProgress && !ReloadAnimInProgress;
}

//–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è EquipAnimInProgress, –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ–º –ª–∏ –º—ã —Å–µ–π—á–∞—Å –º–µ–Ω—è—Ç—å –æ—Ä—É–∂–∏–µ
//–º—ã –Ω–µ –º–æ–∂–µ–º –≤–æ –≤—Ä–µ–º—è —É–∂–µ —Å–º–µ–Ω—ã
bool USTUWeaponComponent::CanEquip() const
{
    return !EquipAnimInProgress && !ReloadAnimInProgress;
}

bool USTUWeaponComponent::CanReload() const
{
    return CurrentWeapon && !EquipAnimInProgress && !ReloadAnimInProgress;
}

//–ü–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞
void USTUWeaponComponent::Reload()
{
    if (!CanReload()) return;
    ReloadAnimInProgress = true;
    PlayAnimMontage(CurrentReloadAnimMontage);
}
```

![[Pasted image 20250520161858.png]]

## –®–∞–±–ª–æ–Ω –∫–ª–∞—Å—Å–∞ –¥–ª—è anim notify 

base.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Animation/AnimNotifies/AnimNotify.h"
#include "STUAnimNotify.generated.h"

DECLARE_MULTICAST_DELEGATE_OneParam(FOnNotifiedSingature, USkeletalMeshComponent*);

UCLASS()
class STU_API USTUAnimNotify : public UAnimNotify
{
	GENERATED_BODY()
	
		public:
      virtual void Notify(USkeletalMeshComponent* MeshComp, UAnimSequenceBase* Animation) override;

      FOnNotifiedSingature OnNotified;
};

```

child1.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "STUAnimNotify.h"
#include "STUReloadFinishAnimNotify.generated.h"

/**
 * 
 */
UCLASS()
class STU_API USTUReloadFinishAnimNotify : public USTUAnimNotify
{
	GENERATED_BODY()
	
};

```

child2.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "STUAnimNotify.h"
#include "STUEquipFinishAnimNotify.generated.h"



UCLASS()
class STU_API USTUEquipFinishAnimNotify : public USTUAnimNotify
{
    GENERATED_BODY()


};

```

weaponComponent.h 

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUWeaponComponent.generated.h"

class ASTUBaseWeapon;

USTRUCT(BlueprintType)
struct FWeaponData
{
    GENERATED_USTRUCT_BODY()

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    TSubclassOf<ASTUBaseWeapon> WeaponClass;

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    UAnimMontage* ReloadAnimMontage;
};

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUWeaponComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    // Sets default values for this component's properties
    USTUWeaponComponent();

    void StartFire();
    void StopFire();
    void NextWeapon();
    void Reload();

protected:
    //–º–∞—Å—Å–∏–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä
    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    TArray<FWeaponData> WeaponData;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponEquipSocketName = "WeaponSocket";

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponArmorySocketName = "ArmorySocket";

    UPROPERTY(EditDefaultsOnly, Category = "Animation")
    UAnimMontage* EquipAnimMontage;

    // Called when the game starts
    virtual void
    BeginPlay() override;

    //–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
    virtual void EndPlay(const EEndPlayReason::Type EndPlayReason) override;

private:
    UPROPERTY()
    ASTUBaseWeapon* CurrentWeapon = nullptr;

    UPROPERTY()
    TArray<ASTUBaseWeapon*> Weapons;

    UPROPERTY()
    UAnimMontage* CurrentReloadAnimMontage = nullptr;

    int32 CurrentWeaponIndex = 0;
    bool EquipAnimInProgress = false;
    bool ReloadAnimInProgress = false;

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –ø–µ—Ä—Å–æ–Ω–∞–∂—É
    void SpawnWeapons();
    void AttachWeaponToSocket(ASTUBaseWeapon* Weapon,
        USceneComponent* SceneComponent, const FName& SocketName);
    void EquipWeapon(int32 WeaponIndex);

    void PlayAnimMontage(UAnimMontage* Animation);
    void InitAnimations();

    void OnEquipFinished(USkeletalMeshComponent* MeshComponent);
    void OnReloadFinished(USkeletalMeshComponent* MeshComponent);

    bool CanFire() const;
    bool CanEquip() const;
    bool CanReload() const;

    //—à–∞–±–ª–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    template <typename T>
    T* FindNotifyByClass(UAnimSequenceBase* Animation)
    {
        if (!Animation) return nullptr;

        const auto NotifyEvents = Animation->Notifies;
        for (auto NotifyEvent : NotifyEvents)
        {
            auto AnimNotify = Cast<T>(NotifyEvent.Notify);
            if (AnimNotify)
            {
                return AnimNotify;
            }
        }
        return nullptr;
    }
};

```

weaponComponent.cpp

```cpp
//–ø–æ–∏—Å–∫ –ø–æ
void USTUWeaponComponent::InitAnimations()
{
    //—Å–º–µ–Ω–∞ –æ—Ä—É–∂–∏—è
    //–ø–æ–∏—Å–∫ –ø–æ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–º–µ–Ω—ã –æ—Ä—É–∂–∏—è
    auto EquipFinishNotify = FindNotifyByClass<USTUEquipFinishAnimNotify>(EquipAnimMontage);
    if (EquipFinishNotify)
    {
        //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç notify, –ø—Ä–∏ –µ–≥–æ –ø—Ä–æ—Ö–æ–¥–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é OnEquipFinished
        EquipFinishNotify->OnNotified.AddUObject(this, &USTUWeaponComponent::OnEquipFinished);
    }

    //–ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞
    //–ø–æ–∏—Å–∫ –ø–æ –º–∞—Å—Å–∏–≤—É –∏–∑ –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏
    for (auto OneWeaponData : WeaponData)
    {
        auto ReloadFinishNotify = FindNotifyByClass<USTUReloadFinishAnimNotify>(OneWeaponData.ReloadAnimMontage);
        if (!ReloadFinishNotify) continue;

        //–µ—Å–ª–∏ –Ω–∞—à–ª–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç notify –∏ –ø—Ä–∏ –µ–≥–æ –ø—Ä–æ—Ö–æ–¥–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é OnReloadFinished
        ReloadFinishNotify->OnNotified.AddUObject(this, &USTUWeaponComponent::OnReloadFinished);
    }
}
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞ 

.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Components/ActorComponent.h"
#include "STUWeaponComponent.generated.h"

class ASTUBaseWeapon;

USTRUCT(BlueprintType)
struct FWeaponData
{
    GENERATED_USTRUCT_BODY()

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    TSubclassOf<ASTUBaseWeapon> WeaponClass;

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    UAnimMontage* ReloadAnimMontage;
};

UCLASS(ClassGroup = (Custom), meta = (BlueprintSpawnableComponent))
class STU_API USTUWeaponComponent : public UActorComponent
{
    GENERATED_BODY()

public:
    // Sets default values for this component's properties
    USTUWeaponComponent();

    void StartFire();
    void StopFire();
    void NextWeapon();
    void Reload();

protected:
    //–º–∞—Å—Å–∏–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä
    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    TArray<FWeaponData> WeaponData;

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponEquipSocketName = "WeaponSocket";

    UPROPERTY(EditDefaultsOnly, Category = "Weapon")
    FName WeaponArmorySocketName = "ArmorySocket";

    UPROPERTY(EditDefaultsOnly, Category = "Animation")
    UAnimMontage* EquipAnimMontage;

    // Called when the game starts
    virtual void
    BeginPlay() override;

    //–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
    virtual void EndPlay(const EEndPlayReason::Type EndPlayReason) override;

private:
    UPROPERTY()
    ASTUBaseWeapon* CurrentWeapon = nullptr;

    UPROPERTY()
    TArray<ASTUBaseWeapon*> Weapons;

    UPROPERTY()
    UAnimMontage* CurrentReloadAnimMontage = nullptr;

    int32 CurrentWeaponIndex = 0;
    bool EquipAnimInProgress = false;
    bool ReloadAnimInProgress = false;

    //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏–µ –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –ø–µ—Ä—Å–æ–Ω–∞–∂—É
    void SpawnWeapons();
    void AttachWeaponToSocket(ASTUBaseWeapon* Weapon,
        USceneComponent* SceneComponent, const FName& SocketName);
    void EquipWeapon(int32 WeaponIndex);

    void PlayAnimMontage(UAnimMontage* Animation);
    void InitAnimations();

    void OnEquipFinished(USkeletalMeshComponent* MeshComponent);
    void OnReloadFinished(USkeletalMeshComponent* MeshComponent);

    bool CanFire() const;
    bool CanEquip() const;
    bool CanReload() const;

    void OnEmptyClip();
    void ChangeClip();

    //—à–∞–±–ª–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    template <typename T>
    T* FindNotifyByClass(UAnimSequenceBase* Animation)
    {
        if (!Animation) return nullptr;

        const auto NotifyEvents = Animation->Notifies;
        for (auto NotifyEvent : NotifyEvents)
        {
            auto AnimNotify = Cast<T>(NotifyEvent.Notify);
            if (AnimNotify)
            {
                return AnimNotify;
            }
        }
        return nullptr;
    }
};

```

.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUWeaponComponent.h"
#include "STU/Weapons/STUBaseWeapon.h"
#include "GameFramework/Character.h"
#include "STU/Animations/STUEquipFinishAnimNotify.h"
#include "STU/Animations/STUReloadFinishAnimNotify.h"

DEFINE_LOG_CATEGORY_STATIC(LogWeaponComponent, All, All);

USTUWeaponComponent::USTUWeaponComponent()
{

    PrimaryComponentTick.bCanEverTick = false;
}

void USTUWeaponComponent::BeginPlay()
{
    Super::BeginPlay();

    CurrentWeaponIndex = 0;
    InitAnimations();
    SpawnWeapons();
    EquipWeapon(CurrentWeaponIndex);
}

//—Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏
void USTUWeaponComponent::EndPlay(const EEndPlayReason::Type EndPlayReason)
{
    CurrentWeapon = nullptr;
    for (auto Weapon : Weapons)
    {
        Weapon->DetachFromActor(FDetachmentTransformRules::KeepWorldTransform);
        Weapon->Destroy();
    }
    Weapons.Empty();

    Super::EndPlay(EndPlayReason);
}

void USTUWeaponComponent::SpawnWeapons()
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || !GetWorld()) return;

    for (auto OneWeaponData : WeaponData)
    {
        //—Å–ø–∞–≤–Ω –æ—Ä—É–∂–∏—è
        auto Weapon = GetWorld()->SpawnActor<ASTUBaseWeapon>(OneWeaponData.WeaponClass);
        if (!Weapon) continue;

        Weapon->OnClipEmpty.AddUObject(this, &USTUWeaponComponent::OnEmptyClip);
        Weapon->SetOwner(Character);
        Weapons.Add(Weapon);

        AttachWeaponToSocket(Weapon, Character->GetMesh(), WeaponArmorySocketName);
    }
}

//—ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä—É–∂–µ—è
void USTUWeaponComponent::EquipWeapon(int32 WeaponIndex)
{
    if (WeaponIndex < 0 || WeaponIndex >= Weapons.Num())
    {
        UE_LOG(LogWeaponComponent, Warning, TEXT("Invalid weapon index"));
        return;
    }

    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;

    if (CurrentWeapon)
    {
        CurrentWeapon->StopFire();
        AttachWeaponToSocket(CurrentWeapon, Character->GetMesh(), WeaponArmorySocketName);
    }

    CurrentWeapon = Weapons[WeaponIndex];
    //CurrentReloadAnimMontage = WeaponData[WeaponIndex].ReloadAnimMontage;
    //–∫–∞–∂–¥—ã–π —Ä–∞–∑ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å —Å —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –Ω—É–∂–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é, –ø–æ–¥—Ö–æ–¥—è—é—â—É—é –¥–ª—è –Ω–∞—Å
    //–≤ CurrentWeaponData –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    //FinDByPredicate —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç true/false
    //–≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —ç—Ç–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä []
    //–º—ã –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∞–Ω–æ–Ω–∏–º–Ω–æ–π –ª—è–º–±–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è
    //–∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –º–∞—Å—Å–∏–≤–∞
    //–∏ –≤ —Å–ª—É—á–∞–µ –∫–ª–∞—Å—Å–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–∞—Å—Å–∏–≤–∞
    // —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–ª–∞—Å—Å–æ–º CurrentWeapon
    // —Ç–æ –Ω–∞–º –≤–µ—Ä–Ω–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ nullptr
    //
    // [&] –æ–∑–Ω–∞—á–∞–µ—Ç –∑–∞—Ö–≤–∞—Ç –≤–Ω–µ—à–Ω–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Ç–æ –µ—Å—Ç—å –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —É–∫–∞–∑–∞—Ç–µ–ª—é
    // CurrentWeapon, –∞ –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ Data –∏–º–µ–µ—Ç —Ç–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞ WeaponData
    //
    // –ö –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –º–∞—Å—Å–∏–≤–∞ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–∏–Ω–∞ –¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏ –∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏,
    // –Ω–∞–º –≤–µ—Ä–Ω–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞
    //
    // —É—Å—Ç–∞–Ω–æ–≤–∏–º CurrentReloadAnimMontage –Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—é –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏ –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    // CurrentWeaponData –µ—Å–ª–∏ –Ω–µ –Ω—É–ª—å, —Ç–æ –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –ø–æ–ª—é, –µ—Å–ª–∏ –Ω—É–ª—å, —Ç–æ nullptr
    //
    const auto CurrentWeaponData = WeaponData.FindByPredicate([&](const FWeaponData& Data) //
        {                                                                                  //
            return Data.WeaponClass == CurrentWeapon->GetClass();
        });
    CurrentReloadAnimMontage = CurrentWeaponData ? CurrentWeaponData->ReloadAnimMontage : nullptr;

    AttachWeaponToSocket(CurrentWeapon, Character->GetMesh(), WeaponEquipSocketName);
    EquipAnimInProgress = true;
    PlayAnimMontage(EquipAnimMontage);
}

void USTUWeaponComponent::AttachWeaponToSocket(ASTUBaseWeapon* Weapon, USceneComponent* SceneComponent, const FName& SocketName)
{
    if (!Weapon || !SceneComponent) return;

    //–∞—Ç—Ç–∞—á –∫ –º–µ—à—É, —Ä—É–∫–µ
    FAttachmentTransformRules AttachmentRules(EAttachmentRule::SnapToTarget, false);
    Weapon->AttachToComponent(SceneComponent, AttachmentRules, SocketName);
}

void USTUWeaponComponent::StartFire()
{
    if (!CanFire()) return;

    //–µ—Å–ª–∏ –µ—Å—Ç—å –æ—Ä—É–∂–∏–µ, —Ç–æ –≤—ã–∑–æ–≤ –∏–∑ ASTUBaseWeapon Fire
    CurrentWeapon->StartFire();
}

void USTUWeaponComponent::StopFire()
{
    if (!CurrentWeapon) return;
    CurrentWeapon->StopFire();
}

void USTUWeaponComponent::NextWeapon()
{
    if (!CanEquip()) return;

    //—á—Ç–æ –±—ã –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –≤—ã—à–ª–∞ –∑–∞ –ø—Ä–∏–¥–µ–ª—ã –º–∞—Å—Å–∏–≤–∞
    //–±–µ—Ä–µ–º –µ–µ –ø–æ –º–æ–¥—É–ª—é –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞, —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ –¥–ª–∏–Ω–µ –º–∞—Å—Å–∏–≤–∞
    //—Ç–æ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ 0
    CurrentWeaponIndex = (CurrentWeaponIndex + 1) % Weapons.Num();
    EquipWeapon(CurrentWeaponIndex);
}

void USTUWeaponComponent::PlayAnimMontage(UAnimMontage* Animation)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character) return;

    Character->PlayAnimMontage(Animation);
}

//–ø–æ–∏—Å–∫ –ø–æ
void USTUWeaponComponent::InitAnimations()
{
    //—Å–º–µ–Ω–∞ –æ—Ä—É–∂–∏—è
    //–ø–æ–∏—Å–∫ –ø–æ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–º–µ–Ω—ã –æ—Ä—É–∂–∏—è
    auto EquipFinishNotify = FindNotifyByClass<USTUEquipFinishAnimNotify>(EquipAnimMontage);
    if (EquipFinishNotify)
    {
        //–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç notify, –ø—Ä–∏ –µ–≥–æ –ø—Ä–æ—Ö–æ–¥–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é OnEquipFinished
        EquipFinishNotify->OnNotified.AddUObject(this, &USTUWeaponComponent::OnEquipFinished);
    }

    //–ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞
    //–ø–æ–∏—Å–∫ –ø–æ –º–∞—Å—Å–∏–≤—É –∏–∑ –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏
    for (auto OneWeaponData : WeaponData)
    {
        auto ReloadFinishNotify = FindNotifyByClass<USTUReloadFinishAnimNotify>(OneWeaponData.ReloadAnimMontage);
        if (!ReloadFinishNotify) continue;

        //–µ—Å–ª–∏ –Ω–∞—à–ª–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–µ–ª–µ–≥–∞—Ç notify –∏ –ø—Ä–∏ –µ–≥–æ –ø—Ä–æ—Ö–æ–¥–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é OnReloadFinished
        ReloadFinishNotify->OnNotified.AddUObject(this, &USTUWeaponComponent::OnReloadFinished);
    }
}

void USTUWeaponComponent::OnEquipFinished(USkeletalMeshComponent* MeshComponent)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || MeshComponent != Character->GetMesh()) return;

    EquipAnimInProgress = false;
}

void USTUWeaponComponent::OnReloadFinished(USkeletalMeshComponent* MeshComponent)
{
    ACharacter* Character = Cast<ACharacter>(GetOwner());
    if (!Character || MeshComponent != Character->GetMesh()) return;

    ReloadAnimInProgress = false;
}

bool USTUWeaponComponent::CanFire() const
{
    return CurrentWeapon && !EquipAnimInProgress && !ReloadAnimInProgress;
}

//–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è EquipAnimInProgress, –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ–º –ª–∏ –º—ã —Å–µ–π—á–∞—Å –º–µ–Ω—è—Ç—å –æ—Ä—É–∂–∏–µ
//–º—ã –Ω–µ –º–æ–∂–µ–º –≤–æ –≤—Ä–µ–º—è —É–∂–µ —Å–º–µ–Ω—ã
bool USTUWeaponComponent::CanEquip() const
{
    return !EquipAnimInProgress && !ReloadAnimInProgress;
}

bool USTUWeaponComponent::CanReload() const
{
    return CurrentWeapon            //
           && !EquipAnimInProgress  //
           && !ReloadAnimInProgress //
           && CurrentWeapon->CanReload();
}

//–ü–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞
void USTUWeaponComponent::Reload()
{
    ChangeClip();
}

void USTUWeaponComponent::OnEmptyClip()
{
    ChangeClip();
}

void USTUWeaponComponent::ChangeClip()
{
    if (!CanReload()) return;
    CurrentWeapon->StopFire();
    CurrentWeapon->ChangeClip();

    ReloadAnimInProgress = true;
    PlayAnimMontage(CurrentReloadAnimMontage);
}
```

## –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ 

coreTypes.h

```cpp
#pragma once

#include "CoreMinimal.h"
#include "UObject/ObjectMacros.h" 
#include "STUCoreTypes.generated.h" 

//Weapon 
class ASTUBaseWeapon;

DECLARE_MULTICAST_DELEGATE(FOnClipEmptySignature);

USTRUCT(BlueprintType)
struct FAmmoData
{
    GENERATED_USTRUCT_BODY()

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    int32 Bullets;

    //—Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –∫–æ–≥–¥–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Infinite
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon", meta = (EditCondition = "!Infinite"))
    int32 Clips;

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    bool Infinite;
};

USTRUCT(BlueprintType)
struct FWeaponData
{
    GENERATED_USTRUCT_BODY()

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    TSubclassOf<ASTUBaseWeapon> WeaponClass;

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "Weapon")
    UAnimMontage* ReloadAnimMontage;
};

//Health

//–¥–µ–ª–µ–≥–∞—Ç –Ω–∞ —Å–º–µ—Ä—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
DECLARE_MULTICAST_DELEGATE(FOnDeath);
//–¥–µ–ª–µ–≥–∞—Ç, –∫–æ–≥–¥–∞ –º–µ–Ω—è—é—Ç—Å—è –∂–∏–∑–Ω–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
//—Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –ª–æ–≥–∏–∫—É —Å —Ç–∏–∫–∞, –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∑–¥–æ—Ä–æ–≤—å—è
DECLARE_MULTICAST_DELEGATE_OneParam(FOnHealthChanged, float);

```

## Blueprint Widget 

–í –æ–±—â–µ–º –∫–ª–∞—Å—Å–µ HUD —Å–æ–∑–¥–∞–µ–º –∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º –≤ game mode

![[Pasted image 20250521204138.png]]

![[Pasted image 20250521204103.png]]

–≤ health component —Å–æ–∑–¥–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏ –≤—ã–≤–æ–¥–∏–º –µ–µ 

```cpp
    //–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    UFUNCTION(BlueprintCallable, Category = "Health")
    float GetHealthPercent() const { return Health / MaxHealth; }
```

–¥–µ–ª–∞–µ–º –±–∏–Ω–¥ –Ω–∞ –≤—ã–∑–æ–≤ 

![[Pasted image 20250521204259.png]]

![[Pasted image 20250521204155.png]]

## Widget in C++

HealthComponent.h

```cpp

    //–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    UFUNCTION(BlueprintCallable, Category = "Health")
    float GetHealthPercent() const { return Health / MaxHealth; }
```

PlayerHUDWidget.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Blueprint/UserWidget.h"
#include "STUPlayerHUDWidget.generated.h"

UCLASS()
class STU_API USTUPlayerHUDWidget : public UUserWidget
{
    GENERATED_BODY()

public:
    UFUNCTION(BlueprintCallable, Category = "UI")
    float GetHealthPercent() const;
};

```

PlayerHUDWidget.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUPlayerHUDWidget.h"
#include "STU/Character/STUHealthComponent.h"

float USTUPlayerHUDWidget::GetHealthPercent() const
{
    //—É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∏–≥—Ä–æ–∫–∞
    //–±–µ—Ä–µ—Ç –ø–∞–≤–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è 
    const auto Player = GetOwningPlayerPawn();
    if (!Player) return 0.0f;

    //—Ä–µ—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–¥—Ä–æ–≤—å—è 
    const auto Component = Player->GetComponentByClass(USTUHealthComponent::StaticClass());
    //—Ç–∞–∫ GetComponentByClass –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ UActorComponent, –ø–æ—ç—Ç–æ–º—É —Å –ø–æ–º–æ—â—å—é Cast –º—ã –ø—Ä–∏–≤–æ–¥–∏–º –∫ HealthComponent
    const auto HealthComponent = Cast<USTUHealthComponent>(Component);
    if (!HealthComponent) return 0.0f;

    return HealthComponent->GetHealthPercent();

}

```

gameHUD.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/HUD.h"
#include "STUGameHUD.generated.h"

/**
 * 
 */
UCLASS()
class STU_API ASTUGameHUD : public AHUD
{
    GENERATED_BODY()

public:
    virtual void DrawHUD() override;

protected:
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "UI")
    TSubclassOf<UUserWidget> PlayerHUDWidgetClass;

    virtual void BeginPlay() override;

private:
    void DrawCrossHair();
};

```

gameHUD.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUGameHUD.h"
#include "Engine/Canvas.h"
#include "Blueprint/UserWidget.h"

//–ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
void ASTUGameHUD::DrawHUD()
{
    //–≤—ã–∑–æ–≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    Super::DrawHUD();

    DrawCrossHair();
}

void ASTUGameHUD::BeginPlay()
{
    Super::BeginPlay();
    auto PlayerHUDWidget = CreateWidget<UUserWidget>(GetWorld(), PlayerHUDWidgetClass);
    if (PlayerHUDWidget)
    {
        PlayerHUDWidget->AddToViewport();
    }
}

void ASTUGameHUD::DrawCrossHair()
{
    //–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞
    const TInterval<float> Center(Canvas->SizeX * 0.5f, Canvas->SizeY * 0.5f);

    //—à–∏—Ä–∏–Ω–∏ –∏ –¥–ª–∏–Ω–∞, —Ü–≤–µ—Ç
    const float HalfLineSize = 10.0f;
    const float LineThickness = 2.0f;
    const FLinearColor LineColor = FLinearColor::Green;

    //—Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è —É–º–µ–µ—Ç —Ä–∏—Å–æ–≤–∞—Ç—å –ª–∏–Ω–∏–∏
    //–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
    DrawLine(Center.Min - HalfLineSize, Center.Max, Center.Min + HalfLineSize, Center.Max, LineColor, LineThickness);

    //–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
    DrawLine(Center.Min, Center.Max - HalfLineSize, Center.Min, Center.Max + HalfLineSize, LineColor, LineThickness);
}

```

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è –≤ HUD

WeaponComponent.h

```

    bool GetWeaponUIData(FWeaponUIData& UIData) const;
    bool GetWeaponAmmoData(FAmmoData& AmmoData) const;

```

WeaponComponent.cpp

```cpp
bool USTUWeaponComponent::GetWeaponUIData(FWeaponUIData& UIData) const
{
    if (CurrentWeapon)
    {
        UIData = CurrentWeapon->GetUIData();
        return true;
    }
    return false;
}

bool USTUWeaponComponent::GetWeaponAmmoData(FAmmoData& AmmoData) const
{
    if (CurrentWeapon)
    {
        AmmoData = CurrentWeapon->GetAmmoData();
        return true;
    }
    return false;
}
```

CoreTypes.h

```cpp

USTRUCT(BlueprintType)
struct FWeaponUIData
{
    GENERATED_USTRUCT_BODY()

    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "UI")
    UTexture2D* MainIcon;

    
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category = "UI")
    UTexture2D* CrosshairIcon;
};
```

STUPlayerHUDWidget.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "Blueprint/UserWidget.h"
#include "STU/Core/STUCoreTypes.h"
#include "STU/Character/STUWeaponComponent.h"
#include "STUPlayerHUDWidget.generated.h"

UCLASS()
class STU_API USTUPlayerHUDWidget : public UUserWidget
{
    GENERATED_BODY()

public:
    UFUNCTION(BlueprintCallable, Category = "UI")
    float GetHealthPercent() const;

    UFUNCTION(BlueprintCallable, Category = "UI")
    bool GetCurrentWeaponUIData(FWeaponUIData& UIData) const;

    UFUNCTION(BlueprintCallable, Category = "UI")
    bool GetCurrentWeaponAmmoData(FAmmoData& AmmoData) const;

private:
    USTUWeaponComponent* GetWeaponComponent() const;
};

```

STUPlayerHUDWidget.cpp

```cpp
bool USTUPlayerHUDWidget::GetCurrentWeaponUIData(FWeaponUIData& UIData) const
{
    const auto WeaponComponent = GetWeaponComponent();
    if (!WeaponComponent) return false;

    return WeaponComponent->GetWeaponUIData(UIData);
}

bool USTUPlayerHUDWidget::GetCurrentWeaponAmmoData(FAmmoData& AmmoData) const
{
    const auto WeaponComponent = GetWeaponComponent();
    if (!WeaponComponent) return false;

    return WeaponComponent->GetWeaponAmmoData(AmmoData);
}

```

![[Pasted image 20250522200801.png]]

![[Pasted image 20250522200753.png]]

![[Pasted image 20250522200746.png]]

![[Pasted image 20250522200735.png]]

–ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏ –≤ HUD, –∏–Ω–æ–≥–¥–∞ –Ω–∞–¥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç 

![[Pasted image 20250522224440.png]]

![[Pasted image 20250522224520.png]]

## –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥. —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç 

```cpp
#pragma once

//—à–∞–±–ª–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ç–∏–ø –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ pawn 
class STUUtils
{
public:
    template <typename T>
    static T* GetSTUPlayerComponent(APawn* PlayerPawn)
    {
        if (!PlayerPawn) return nullptr;

        //—Ä–µ—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ä—É–∂–∏—è
        const auto Component = PlayerPawn->GetComponentByClass(T::StaticClass());
        return Cast<T>(Component);
    }
};
```

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUPlayerHUDWidget.h"
#include "STU/Character/STUHealthComponent.h"
#include "STU/Character/STUWeaponComponent.h"
#include "STU/Weapons/STUBaseWeapon.h"
#include "STU/Core/STUUtils.h"

float USTUPlayerHUDWidget::GetHealthPercent() const
{
    const auto HealthComponent = STUUtils::GetSTUPlayerComponent<USTUHealthComponent>(GetOwningPlayerPawn());
    if (!HealthComponent) return 0.0f;

    return HealthComponent->GetHealthPercent();
}

bool USTUPlayerHUDWidget::GetCurrentWeaponUIData(FWeaponUIData& UIData) const
{
    const auto WeaponComponent = STUUtils::GetSTUPlayerComponent<USTUWeaponComponent>(GetOwningPlayerPawn());
    if (!WeaponComponent) return false;

    return WeaponComponent->GetWeaponUIData(UIData);
}

bool USTUPlayerHUDWidget::GetCurrentWeaponAmmoData(FAmmoData& AmmoData) const
{
    const auto WeaponComponent = STUUtils::GetSTUPlayerComponent<USTUWeaponComponent>(GetOwningPlayerPawn());
    if (!WeaponComponent) return false;

    return WeaponComponent->GetWeaponAmmoData(AmmoData);
}

bool USTUPlayerHUDWidget::IsPlayerAlive() const
{
    const auto HealthComponent = STUUtils::GetSTUPlayerComponent<USTUHealthComponent>(GetOwningPlayerPawn());
    return HealthComponent && !HealthComponent->IsDead();
}

bool USTUPlayerHUDWidget::IsPlayerSpectating() const
{
    const auto Controller = GetOwningPlayer();
    return Controller && Controller->GetStateName() == NAME_Spectating;
}
```

## Pickups

base.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUBasePickup.generated.h"

class USphereComponent;

UCLASS()
class STU_API ASTUBasePickup : public AActor
{
    GENERATED_BODY()

public:
    ASTUBasePickup();

protected:
    UPROPERTY(VisibleAnywhere, Category = "Pickup")
    USphereComponent* CollisionComponent;

    virtual void BeginPlay() override;
    virtual void NotifyActorBeginOverlap(AActor* OtherActor) override;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;
};

```

base.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STU/Pickups/STUBasePickup.h"
#include "Components/SphereComponent.h"

DEFINE_LOG_CATEGORY_STATIC(LogBasePickup, All, All);

// Sets default values
ASTUBasePickup::ASTUBasePickup()
{
    // Set this actor to call Tick() every frame.  You can turn this off to improve performance if you don't need it.
    PrimaryActorTick.bCanEverTick = true;

    CollisionComponent = CreateDefaultSubobject<USphereComponent>("SphereComponent");
    CollisionComponent->InitSphereRadius(50.0f);
    CollisionComponent->SetCollisionEnabled(ECollisionEnabled::QueryOnly);
    CollisionComponent->SetCollisionResponseToAllChannels(ECollisionResponse::ECR_Overlap);
    SetRootComponent(CollisionComponent);
}

// Called when the game starts or when spawned
void ASTUBasePickup::BeginPlay()
{
    Super::BeginPlay();
}

// Called every frame
void ASTUBasePickup::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);
}

void ASTUBasePickup::NotifyActorBeginOverlap(AActor* OtherActor)
{
    Super::NotifyActorBeginOverlap(OtherActor);

    UE_LOG(LogBasePickup, Display, TEXT("Pickup was taken"));
    Destroy();
}
```

## Respawn PickUp, virtual pickup function, health pick up 

basepick.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Actor.h"
#include "STUBasePickup.generated.h"

class USphereComponent;

UCLASS()
class STU_API ASTUBasePickup : public AActor
{
    GENERATED_BODY()

public:
    ASTUBasePickup();

protected:
    UPROPERTY(VisibleAnywhere, Category = "Pickup")
    USphereComponent* CollisionComponent;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, Category = "Pickup")
    float RespawnTime = 5.0f;

    virtual void BeginPlay() override;
    virtual void NotifyActorBeginOverlap(AActor* OtherActor) override;

public:
    // Called every frame
    virtual void Tick(float DeltaTime) override;

private:
    float RotationYaw = 0.0f;

    virtual bool GivePickupTo(APawn* PlayerPawn);

    void PickupWasTaken();
    void Respawn();
    void GenerateRotationYaw();

};

```

basepick.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STU/Pickups/STUBasePickup.h"
#include "Components/SphereComponent.h"

DEFINE_LOG_CATEGORY_STATIC(LogBasePickup, All, All);

// Sets default values
ASTUBasePickup::ASTUBasePickup()
{
    // Set this actor to call Tick() every frame.  You can turn this off to improve performance if you don't need it.
    PrimaryActorTick.bCanEverTick = true;

    CollisionComponent = CreateDefaultSubobject<USphereComponent>("SphereComponent");
    CollisionComponent->InitSphereRadius(50.0f);
    CollisionComponent->SetCollisionEnabled(ECollisionEnabled::QueryOnly);
    CollisionComponent->SetCollisionResponseToAllChannels(ECollisionResponse::ECR_Overlap);
    SetRootComponent(CollisionComponent);
}

// Called when the game starts or when spawned
void ASTUBasePickup::BeginPlay()
{
    Super::BeginPlay();

    check(CollisionComponent);

    GenerateRotationYaw();
}

// Called every frame
void ASTUBasePickup::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);

    AddActorLocalRotation(FRotator(0.0f, RotationYaw, 0.0f));
}

bool ASTUBasePickup::GivePickupTo(APawn* PlayerPawn)
{
    return false;
}

void ASTUBasePickup::PickupWasTaken()
{
    //–∫–æ–ª–ª–∏–∑–∏—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –æ–∫—Ä—É–∂–∞—é—â–∏–º –º–∏—Ä–æ–º
    CollisionComponent->SetCollisionResponseToAllChannels(ECollisionResponse::ECR_Ignore);
    if (GetRootComponent())
    {
        GetRootComponent()->SetVisibility(false, true);
    }

    FTimerHandle RespawnTimerHandle;
    GetWorldTimerManager().SetTimer(RespawnTimerHandle, this, &ASTUBasePickup::Respawn, RespawnTime);
}

void ASTUBasePickup::Respawn()
{
    GenerateRotationYaw();
    CollisionComponent->SetCollisionResponseToAllChannels(ECollisionResponse::ECR_Overlap);
    if (GetRootComponent())
    {
        GetRootComponent()->SetVisibility(true, true);
    }
}

void ASTUBasePickup::GenerateRotationYaw()
{
    const auto Direction = FMath::RandBool() ? 1.0f : -1.0f;
    RotationYaw = FMath::RandRange(1.0f, 2.0f) * Direction;
}

void ASTUBasePickup::NotifyActorBeginOverlap(AActor* OtherActor)
{
    Super::NotifyActorBeginOverlap(OtherActor);

    const auto Pawn = Cast<APawn>(OtherActor);

    if (GivePickupTo(Pawn))
    {
        PickupWasTaken();
    }

    //UE_LOG(LogBasePickup, Display, TEXT("Pickup was taken"));
}
```

ammpickup.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "STUBasePickup.h"
#include "STUAmmoPickup.generated.h"

class ASTUBaseWeapon;

UCLASS()
class STU_API ASTUAmmoPickup : public ASTUBasePickup
{
    GENERATED_BODY()

protected:
    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Pickup", meta = (ClampMin = "1.0", ClampMax = "10.0"))
    int32 ClipsAmount = 10;

    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Pickup")
    TSubclassOf<ASTUBaseWeapon> WeaponType;

private:
    virtual bool GivePickupTo(APawn* PlayerPawn) override;
};

```

ammpickup.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUAmmoPickup.h"
#include "STU/Character/STUHealthComponent.h"
#include "STU/Character/STUWeaponComponent.h"
#include "STU/Core/STUUtils.h"

DEFINE_LOG_CATEGORY_STATIC(LogAmmoPickup, All, All);

bool ASTUAmmoPickup::GivePickupTo(APawn* PlayerPawn)
{
    const auto HealthComponent = STUUtils::GetSTUPlayerComponent<USTUHealthComponent>(PlayerPawn);
    if (!HealthComponent || HealthComponent->IsDead()) return false;

    const auto WeaponComponent = STUUtils::GetSTUPlayerComponent<USTUWeaponComponent>(PlayerPawn);
    if (!WeaponComponent) return false;

    //UE_LOG(LogAmmoPickup, Display, TEXT("Ammo was taken"));
    return WeaponComponent->TryToAddAmmo(WeaponType, ClipsAmount);
}
```

weapon.h

```cpp
public:
    bool TryToAddAmmo(int32 ClipsAmount);
    
protected:
    bool IsAmmoFull() const;
```

weapon.cpp

```cpp
//–ø–æ–ø–æ–ª–µ–Ω–µ–Ω–∏–µ –ø–∞—Ç—Ä–æ–Ω –ø—Ä–∏ –ø–æ–¥–±–∏—Ä–∞–Ω–∏–∏ 
bool ASTUBaseWeapon::TryToAddAmmo(int32 ClipsAmount)
{
    if (CurrentAmmo.Infinite || IsAmmoFull() || ClipsAmount <= 0) return false;

    if (IsAmmoEmpty())
    {
        UE_LOG(LogBaseWeapon, Display, TEXT("Ammo was empty!"))
        //CurrentAmmo.Clips = 0
        CurrentAmmo.Clips = FMath::Clamp(ClipsAmount, 0, DefaultAmmo.Clips + 1);
        OnClipEmpty.Broadcast(this);
    }
    else if (CurrentAmmo.Clips < DefaultAmmo.Clips)
    {
        const auto NextClipsAmount = CurrentAmmo.Clips + ClipsAmount;
        if (DefaultAmmo.Clips - NextClipsAmount >= 0)
        {
            CurrentAmmo.Clips = NextClipsAmount;
            UE_LOG(LogBaseWeapon, Display, TEXT("Clips was added!"))
        }
        else
        {
            CurrentAmmo.Clips = DefaultAmmo.Clips;
            CurrentAmmo.Bullets = DefaultAmmo.Bullets;
            UE_LOG(LogBaseWeapon, Display, TEXT("Ammo was full now!"))
        }
    }
    else
    {
        CurrentAmmo.Bullets = DefaultAmmo.Bullets;
        UE_LOG(LogBaseWeapon, Display, TEXT("Bullets ware added!"))
    }

    return true;
}

bool ASTUBaseWeapon::IsAmmoFull() const
{
    return CurrentAmmo.Clips == DefaultAmmo.Clips && //
           CurrentAmmo.Bullets == DefaultAmmo.Bullets;
}

```

healthpickup.h

```cpp
// Shoot Them Up Game, All Right Reserved.

#pragma once

#include "CoreMinimal.h"
#include "STUBasePickup.h"
#include "STUHealthPickup.generated.h"

UCLASS()
class STU_API ASTUHealthPickup : public ASTUBasePickup
{
    GENERATED_BODY()

protected:
    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Health", meta = (ClampMin = "1.0", ClampMax = "100"))
    float HealthAmount = 100.0f;

private:
    virtual bool GivePickupTo(APawn* PlayerPawn) override;
};

```

healthpickup.cpp

```cpp
// Shoot Them Up Game, All Right Reserved.

#include "STUHealthPickup.h"
#include "STU/Character/STUHealthComponent.h"
#include "STU/Core/STUUtils.h"

DEFINE_LOG_CATEGORY_STATIC(LogHealthPickup, All, All);

bool ASTUHealthPickup::GivePickupTo(APawn* PlayerPawn)
{
    const auto HealthComponent = STUUtils::GetSTUPlayerComponent<USTUHealthComponent>(PlayerPawn);
    if (!HealthComponent) return false;

    //UE_LOG(LogHealthPickup, Display, TEXT("Health was taken"));

    return HealthComponent->TryToAddHealth(HealthAmount);
}
```

healthcomponent.h

```cpp
public:
    bool TryToAddHealth(float HealthAmount);
    bool IsHealthFull() const;
```

healthcomponent.cpp

```cpp
//—Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ø–æ–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è 
bool USTUHealthComponent::TryToAddHealth(float HealthAmount)
{
    if (IsDead() || IsHealthFull()) return false;
    //UE_LOG(LogHealthComponent, Display, TEXT("Health is valid"));

    SetHealth(Health + HealthAmount);

    return true;
}


bool USTUHealthComponent::IsHealthFull() const
{
    return FMath::IsNearlyEqual(Health, MaxHealth);
}
```

